student,1.a,comment,grade,1.b,comment,grade,1.c,comment,grade,1.d,comment,grade,1.e,comment,grade,1.f,comment,grade,1.g,comment,grade,1.h,comment,grade
A0041688X,"SELECT DISTINCT cc.ssn
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
AND date(t.datetime)='2017-12-25'
AND cc.type='visa';",,,"SELECT c.first_name,c.last_name
FROM customers c, credit_cards cc
WHERE c.ssn=cc.ssn
AND c.country='Singapore'
AND cc.type = 'visa' 
INTERSECT
SELECT c1.first_name,c1.last_name
FROM customers c1, credit_cards cc1
WHERE c1.ssn = cc1.ssn
AND c1.country='Singapore'
AND cc1.type='jcb';",,,"SELECT c.ssn, COUNT(cc.number) AS no_credit_card
FROM customers c
LEFT OUTER JOIN credit_cards cc ON c.ssn=cc.ssn
GROUP BY c.ssn
ORDER BY COUNT(cc.number) ASC;",,,"SELECT DISTINCT c.ssn, cc.type, COUNT(cc1.type) AS num_cc
FROM customers c
CROSS JOIN credit_cards cc
LEFT OUTER JOIN credit_cards cc1 
ON cc1.ssn=cc.ssn
AND cc1.ssn=c.ssn
AND cc1.number=cc.number
GROUP BY cc.type,c.ssn
ORDER BY c.ssn;",,,"SELECT c.country, COUNT(DISTINCT c.ssn) AS no_of_customers
FROM customers c, merchants m, transactions t, credit_cards cc
WHERE cc.number=t.number
AND cc.ssn=c.ssn
AND t.code=m.code
AND c.country<>m.country
GROUP BY c.country
ORDER BY COUNT(c.ssn) ASC;",,,"SELECT t.identifier, cc.type, t.amount
FROM credit_cards cc
INNER JOIN transactions t ON cc.number=t.number
INNER JOIN (SELECT cc1.type,
			MAX(t1.amount) AS max_value
			FROM transactions t1,credit_cards cc1 
			WHERE t1.number=cc1.number
			GROUP BY cc1.type) combo
			ON cc.type=combo.type 
			AND t.amount=combo.max_value
GROUP BY cc.type,t.identifier
ORDER BY cc.type;",,,"DROP VIEW IF EXISTS combot;
CREATE VIEW combot AS 
(SELECT t.identifier, cc.type, t.amount 
FROM credit_cards cc, transactions t
LEFT OUTER JOIN transactions t1
ON t1.number=t.number
AND t1.amount >t.amount
WHERE t1.amount ISNULL
AND cc.number=t.number);
SELECT ct.identifier,ct.type,ct.amount
FROM combot ct
LEFT OUTER JOIN combot ct1
ON ct1.type=ct.type
AND ct1.amount > ct.amount
WHERE ct1 ISNULL
ORDER BY ct.type;",,,"SELECT DISTINCT m.code,m.name
FROM merchants m, transactions t, credit_cards cc
WHERE m.code = t.code
AND t.number=cc.number
AND (cc.type LIKE 'visa%' OR cc.type LIKE 'diners-club%')
AND m.code NOT IN (SELECT DISTINCT m1.code 
				   FROM merchants m1,transactions t1,credit_cards cc1
				   WHERE m1.code=t1.code
				   AND t1.number=cc1.number
				   AND t1.amount>=888
				   AND(cc1.type like 'visa%' or cc1.type like 'diners-club%'))
ORDER BY m.code;",,
A0047158B,"SELECT DISTINCT cc.ssn 
FROM credit_cards cc
WHERE cc.type = 'visa'
AND cc.number IN (
	SELECT DISTINCT t.number
	FROM transactions t
	WHERE t.datetime >= '2017-12-25'
	AND t.datetime < '2017-12-26');",,,"SELECT c.first_name, c.last_name
FROM customers c
WHERE c.country = 'Singapore'
AND c.ssn IN (
	SELECT DISTINCT cc1.ssn
	FROM credit_cards cc1
	WHERE cc1.type = 'jcb')
AND c.ssn IN (
	SELECT DISTINCT cc2.ssn
	FROM credit_cards cc2
	WHERE cc2.type = 'visa');",,,"SELECT cc.ssn, COUNT(DISTINCT cc.number) AS count
FROM credit_cards cc
GROUP BY cc.ssn
UNION
SELECT DISTINCT c.ssn, 0 AS count
FROM customers c
WHERE c.ssn NOT IN (
	SELECT DISTINCT cc1.ssn
	FROM credit_cards cc1);",,,"SELECT a.ssn, a.type, CASE WHEN cc3.count IS NULL THEN 0 ELSE cc3.count END as count
FROM 
	(SELECT DISTINCT c.ssn, cc.type
	FROM customers c, (
		SELECT DISTINCT cc1.type
		FROM credit_cards cc1) AS cc) AS a
LEFT JOIN (
	SELECT cc2.ssn, cc2.type, COUNT(DISTINCT cc2.number) AS count
	FROM credit_cards cc2
	GROUP BY cc2.ssn, cc2.type) AS cc3
ON cc3.ssn = a.ssn 
AND cc3.type = a.type;",,,"SELECT  c.country, COUNT(DISTINCT c.ssn) AS count
FROM transactions t, merchants m, credit_cards cc, customers c
WHERE t.code = m.code
AND t.number = cc.number
AND cc.ssn = c.ssn
AND m.country <> c.country
GROUP BY c.country;",,,"SELECT cc.type, t.identifier
FROM transactions t, credit_cards cc, (
	SELECT cc1.type, MAX(t1.amount) AS max
	FROM transactions t1, credit_cards cc1
	WHERE t1.number = cc1.number
	GROUP BY cc1.type) AS d
WHERE t.number = cc.number
AND cc.type = d.type
AND t.amount >= d.max;",,,"SELECT cc.type, t.identifier
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
AND t.amount >= ALL (
	SELECT t1.amount
	FROM transactions t1, credit_cards cc1
	WHERE t1.number = cc1.number
	AND cc1.type = cc.type);",,,"SELECT DISTINCT m.code, m.name
FROM merchants m
WHERE m.code NOT IN (
	SELECT m1.code
	FROM merchants m1, transactions t, credit_cards cc
	WHERE m1.code = t.code
	AND cc.number = t.number
	AND (cc.type LIKE '%visa%' OR cc.type LIKE '%diners-club%')
	AND t.amount >= 888);",,
A0057228A,"SELECT DISTINCT cu.ssn, cc.type
FROM customers cu, credit_cards cc, transactions t
WHERE cu.ssn = cc.ssn
AND cc.number = t.number
AND cc.type = 'visa'
AND cast(t.datetime as date) = '2017-12-25';",,,"SELECT cu.ssn, cu.first_name, cu.last_name
FROM customers cu, credit_cards cc
WHERE cu.ssn = cc.ssn
AND cc.type = 'visa' 
AND cu.country = 'Singapore'
INTERSECT
SELECT cu.ssn, cu.first_name, cu.last_name
FROM customers cu, credit_cards cc
WHERE cu.ssn = cc.ssn
AND cc.type = 'jcb' 
AND cu.country = 'Singapore';",,,"SELECT cu.ssn, (CASE WHEN COUNT (cc.ssn) IS NULL THEN 0 ELSE COUNT (cc.ssn) END) as no_of_credit_cards
FROM customers cu LEFT OUTER JOIN credit_cards cc ON cu.ssn = cc.ssn
GROUP BY cu.ssn
ORDER BY no_of_credit_cards ASC;",,,"SELECT cu.ssn,
SUM(CASE WHEN cc.type = 'diners-club-us-ca' THEN 1 ELSE 0 END) AS diners_club_us_ca, 
SUM(CASE WHEN cc.type = 'instapayment' THEN 1 ELSE 0 END) AS instapayment,
SUM(CASE WHEN cc.type = 'bankcard' THEN 1 ELSE 0 END) AS bankcard,
SUM(CASE WHEN cc.type = 'diners-club-carte-blanche' THEN 1 ELSE 0 END) AS diners_club_carte_blanche,
SUM(CASE WHEN cc.type = 'visa' THEN 1 ELSE 0 END) AS visa,
SUM(CASE WHEN cc.type = 'diners-clubs-international' THEN 1 ELSE 0 END) AS diners_club_international,
SUM(CASE WHEN cc.type = 'laser' THEN 1 ELSE 0 END) AS laser,
SUM(CASE WHEN cc.type = 'americanexpress' THEN 1 ELSE 0 END) AS americanexpress,
SUM(CASE WHEN cc.type = 'maestro' THEN 1 ELSE 0 END) AS maestro,
SUM(CASE WHEN cc.type = 'solo' THEN 1 ELSE 0 END) AS solo,
SUM(CASE WHEN cc.type = 'switch' THEN 1 ELSE 0 END) AS switch,
SUM(CASE WHEN cc.type = 'jcb' THEN 1 ELSE 0 END) AS jcb,
SUM(CASE WHEN cc.type = 'visa-electron' THEN 1 ELSE 0 END) AS visa_electron,
SUM(CASE WHEN cc.type = 'china-unionpay' THEN 1 ELSE 0 END) AS china_unionpay,
SUM(CASE WHEN cc.type = 'diners-club-enroute' THEN 1 ELSE 0 END) AS diners_club_enroute,
SUM(CASE WHEN cc.type = 'mastercard' THEN 1 ELSE 0 END) AS mastercard
FROM customers cu LEFT OUTER JOIN credit_cards cc ON cu.ssn = cc.ssn
GROUP BY cu.ssn, cc.type;",,,"SELECT cu.country, COUNT (DISTINCT t.code)
FROM transactions t, customers cu, merchants m
WHERE t.code = m.code
AND cu.country <> m.country
GROUP BY cu.country;",,,"SELECT t.identifier, t.amount as largestamount, cc.type
FROM transactions t, credit_cards cc 
WHERE t.number = cc.number
AND (t.amount, cc.type) IN (
	SELECT MAX (t.amount), cc.type
	FROM transactions t LEFT OUTER JOIN credit_cards cc ON t.number = cc.number
	GROUP BY cc.type )
ORDER BY largestamount DESC;",,,"SELECT t1.identifier, t1.amount as largestamount, c1.type
FROM transactions t1, credit_cards c1 
WHERE t1.number = c1.number
AND NOT EXISTS (SELECT * 
		FROM transactions t2, credit_cards c2 
		WHERE t2.number = c2.number AND t2.amount > t1.amount AND c1.type = c2.type)
ORDER BY largestamount DESC;",,,"SELECT DISTINCT m1.code, m1.name
FROM transactions t1 LEFT OUTER JOIN merchants m1 ON m1.code = t1.code LEFT OUTER JOIN credit_cards c1 ON t1.number = c1.number
WHERE NOT EXISTS (SELECT * 
		FROM transactions t2 LEFT OUTER JOIN merchants m2 ON m2.code = t2.code LEFT OUTER JOIN credit_cards c2 ON t2.number = c2.number
		WHERE (t2.amount >= 888 AND (c2.type LIKE '%visa%' or c2.type LIKE '%diners-club%' ) AND m1.name = m2.name));",,
A0060127U,"SELECT distinct c.ssn
FROM transactions as t, credit_cards as cc, customers as c
WHERE cc.ssn=c.ssn
AND cc.number = t.number
AND datetime <'2017-12-26'
AND datetime >= '2017-12-25'
AND type= 'visa';",,,"SELECT DISTINCT c.ssn, c.first_name, c.last_name
FROM customers as c, credit_cards as cc1, credit_cards as cc2
WHERE c.ssn=cc1.ssn
AND c.ssn=cc2.ssn
AND c.country= 'Singapore'
AND cc1.type = 'visa'
AND cc2.type= 'jcb';",,,"SELECT c.ssn,count(cc.number)
FROM customers AS c LEFT OUTER JOIN credit_cards AS cc ON c.ssn=cc.ssn
GROUP BY c.ssn;",,,"SELECT cus1.ssn, cus2.type, COUNT(credit_cards.number)
FROM (SELECT DISTINCT customers.ssn
	  FROM customers) AS cus1
	  CROSS JOIN
	  (SELECT DISTINCT credit_cards.type
	  FROM credit_cards) AS cus2
LEFT JOIN credit_cards 
ON cus1.ssn = credit_cards.ssn AND cus2.type = credit_cards.type
GROUP BY cus1.ssn, cus2.type
ORDER BY cus1.ssn, cus2.type;",,,"SELECT c.country, count (distinct c.ssn)
FROM merchants as m , transactions as t, credit_cards as cc, customers as c
WHERE m.code= t.code
AND t.number = cc.number
AND c.ssn = cc.ssn
AND m.country <> c.country
GROUP BY c.country;",,,"SELECT t1.identifier
FROM transactions as t1, credit_cards as cc1
WHERE cc1.number = t1.number
GROUP BY cc1.type,t1.identifier
HAVING t1.amount >= All (SELECT max(t2.amount)
	from transactions as t2, credit_cards as cc2
	WHERE t2.number = cc2.number
	AND cc1.type=cc2.type
	GROUP BY cc2.type, t2.amount);",,,"SELECT t1.identifier
FROM transactions as t1, credit_cards as cc1
WHERE t1.amount >= All (SELECT t2.amount
	from transactions as t2, credit_cards as cc2
	WHERE t2.number = cc2.number
	AND cc1.type=cc2.type
	GROUP BY cc2.type, t2.amount)
AND cc1.number = t1.number
GROUP BY cc1.type,t1.identifier;",,,"SELECT m1.code, m1.name
FROM merchants as m1
WHERE m1.code NOT IN (SELECT m2.code
	FROM merchants as m2, transactions as t, credit_cards as cc
	WHERE m2.code=t.code
	AND cc.number=t.number
	AND t.amount >= 888
	AND (cc.type LIKE 'visa%' OR cc.type LIKE 'diners-club%'));",,
A0080400B,"SELECT DISTINCT cc.ssn
FROM transactions t, credit_cards cc
WHERE DATE(t.datetime) = '2017-12-25'
	AND t.number=cc.number
	AND cc.type='visa'
;",,,"SELECT c.first_name, c.last_name
FROM customers c
WHERE c.country ='Singapore'
	AND c.ssn IN (
		SELECT cc1.ssn
		FROM credit_cards cc1, credit_cards cc2
		WHERE cc1.ssn = cc2.ssn
			AND cc1.type = 'visa' 
			AND cc2.type = 'jcb'
	)
;",,,"SELECT cc.ssn, COUNT(number) AS no_of_cards 
FROM credit_cards cc
GROUP BY cc.ssn 
UNION 
  ( SELECT c.ssn, 0 
    FROM customers c
    EXCEPT 
    SELECT cc.ssn, 0 
    FROM credit_cards cc
  );",,,"SELECT ssn, cc.type, COUNT(number) AS no_of_cards 
FROM credit_cards cc 
GROUP BY ssn, cc.type 
UNION 
SELECT ssn, type, 0 
FROM 
  (SELECT c.ssn, ty.type 
    FROM customers c, 
      (SELECT DISTINCT type 
       FROM credit_cards
      )AS ty 
    EXCEPT 
    SELECT cc.ssn, cc.type 
    FROM credit_cards cc
  ) AS no_cards;",,,"SELECT c.country, COUNT(c.ssn)
FROM customers c
WHERE EXISTS (
	SELECT cc.ssn
	FROM merchants m, transactions t, credit_cards cc
	WHERE t.number = cc.number
		AND m.code = t.code
		AND m.country <> c.country
		AND c.ssn = cc.ssn
	)
GROUP BY c.country;",,,"SELECT 
  tr.identifier
FROM 
  transactions tr
  LEFT JOIN credit_cards cc ON cc.number=tr.number
  INNER JOIN (
  				SELECT cc1.type, MAX(t.amount) AS max_amt
	  			FROM transactions t, credit_cards cc1
	  			WHERE t.number = cc1.number
	  			GROUP BY cc1.type) AS max_tab
	ON tr.amount = max_tab.max_amt AND cc.type=max_tab.type;",,,"SELECT t1.identifier
FROM 
	transactions t1 
    LEFT JOIN credit_cards cc1 
		ON cc1.number=t1.number
	LEFT JOIN (
    		SELECT t2.amount, cc2.type 
    		FROM transactions t2, credit_cards cc2
			WHERE cc2.number=t2.number) AS tc2 
		ON cc1.type = tc2.type AND t1.amount < tc2.amount 
WHERE 
  tc2.amount IS NULL;",,,"SELECT code, name 
FROM merchants 
WHERE 
  code NOT IN (
    SELECT t.code 
    FROM transactions t 
      LEFT JOIN credit_cards cc USING(number) 
    WHERE 
      (cc.type LIKE 'visa%' OR cc.type LIKE 'diners-club%') 
      AND (t.amount >= 888)
  );",,
A0086956J,"SELECT DISTINCT cc.ssn, cc.type
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
	AND cc.type='visa'
	AND (t.datetime BETWEEN '2017-12-25 00:00:00' AND '2017-12-25 23:59:59');",,,"SELECT c.ssn, c.first_name, c.last_name
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn
	AND c.country='Singapore'
	AND cc.type='jcb'
INTERSECT
SELECT c.ssn, c.first_name, c.last_name
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn
	AND c.country='Singapore'
	AND cc.type='visa';",,,"SELECT cc.ssn, COUNT(*) AS count
FROM credit_cards cc
GROUP BY cc.ssn
UNION
SELECT c.ssn, 0
FROM customers c
WHERE c.ssn NOT IN (
	SELECT cc.ssn
	FROM credit_cards cc)
ORDER BY count;",,,"SELECT t1.ssn,t1.type,SUM(t1.count)
FROM(
	SELECT cc.ssn AS ssn, cc.type AS type, COUNT(*) AS count
	FROM credit_cards cc
	GROUP BY cc.ssn, cc.type
	UNION
	SELECT DISTINCT c.ssn AS ssn, cc.type AS type, 0 as count
	FROM customers c
	CROSS JOIN credit_cards cc) t1
GROUP BY t1.ssn, t1.type
ORDER BY t1.ssn, t1.type;",,,"SELECT c.country, COUNT(DISTINCT c.ssn)
FROM customers c, credit_cards cc, transactions t, merchants m
WHERE c.ssn = cc.ssn
	AND t.number = cc.number
	AND m.code = t.code
	AND m.country <> c.country
GROUP BY c.country;",,,"SELECT t.identifier, MAX(t.amount) AS amount
FROM transactions t, credit_cards cc
WHERE t.number=cc.number
GROUP BY cc.type, t.identifier
HAVING amount >= ALL
	(SELECT MAX(t1.amount)
	 FROM transactions t1, credit_cards cc1
	 WHERE t1.number=cc1.number
	 AND cc.type=cc1.type
	 GROUP BY cc1.type)
ORDER BY amount;",,,"SELECT t.identifier, t.amount
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
	AND t.amount >= ALL(
		SELECT t2.amount
		FROM transactions t2, credit_cards cc2
		WHERE t2.number = cc2.number
			AND cc2.type = cc.type)
ORDER BY t.amount;",,,"SELECT m.code, m.name
FROM merchants m, transactions t, credit_cards cc
WHERE m.code = t.code
	AND t.number = cc.number
	AND (cc.type LIKE 'visa%' OR cc.type LIKE 'diners-club%')
GROUP BY m.code, m.name
HAVING  MAX(t.amount)<888;",,
A0090966R,"SELECT DISTINCT cc.ssn
FROM transactions t,
	credit_cards cc
WHERE cc.number = t.number
	AND cc.type = 'visa'
	AND t.datetime BETWEEN '2017-12-25 00:00:00' AND '2017-12-26 00:00:00';",,,"SELECT x.first_name,
	x.last_name
FROM
	(SELECT DISTINCT c.ssn,
			c.first_name,
			c.last_name
		FROM customers c,
			credit_cards cc1,
			credit_cards cc2
		WHERE c.ssn = cc1.ssn
		    AND c.ssn = cc2.ssn
			AND cc1.type = 'visa'
			AND cc2.type = 'jcb'
			AND c.country = 'Singapore') x;",,,"SELECT x.ssn,
	CASE
		WHEN x.cc_own IS NOT NULL THEN x.cc_own
		ELSE 0
	END AS number_of_cc_own
FROM
	(SELECT DISTINCT c.ssn,
			COUNT(DISTINCT cc.number) AS cc_own
		FROM customers c
		LEFT OUTER JOIN credit_cards cc ON c.ssn = cc.ssn
		GROUP BY c.ssn) x;",,,"SELECT y.ssn,
	y.type,
	CASE
		WHEN COUNT(number) IS NOT NULL THEN COUNT(number)
		ELSE 0
	END AS number_of_cc_own
FROM
	(SELECT x.*,
			cc2.number
		FROM
			(SELECT c.ssn,
					cc.type
				FROM
					(SELECT DISTINCT ssn
						FROM customers) c
				CROSS JOIN
					(SELECT DISTINCT type
						FROM credit_cards) cc) x
		LEFT JOIN
			(SELECT *
				FROM credit_cards) cc2 ON x.ssn = cc2.ssn
		AND x.type = cc2.type) y
GROUP BY 1,2
ORDER BY 1,2;",,,"SELECT c.country,
	COUNT(DISTINCT c.ssn)
FROM
	(SELECT ssn,
			country
		FROM customers) c
INNER JOIN
	(SELECT number, ssn
		FROM credit_cards) cc ON c.ssn = cc.ssn
INNER JOIN
	(SELECT DISTINCT number, code
		FROM transactions) T ON cc.number = t.number
INNER JOIN
	(SELECT code,
			country
		FROM merchants) m ON t.code = m.code
WHERE c.country <> m.country
GROUP BY 1;",,,"SELECT t2.identifier
FROM
	(SELECT identifier,
			amount, 
			number
		FROM transactions) t2
INNER JOIN
	(SELECT type, 
			number
		FROM credit_cards) cc2 ON t2.number = cc2.number 
WHERE (cc2.type,
	   t2.amount) in
		(SELECT cc1.type,
				MAX(t1.amount)
			FROM
				(SELECT type, 
						number
					FROM credit_cards) cc1
			INNER JOIN
				(SELECT identifier, 
						number, 
						amount
					FROM transactions) t1 ON cc1.number = t1.number
			GROUP BY 1);",,,"SELECT t2.identifier
FROM transactions t2,
	credit_cards cc2
WHERE t2.number = cc2.number
	AND t2.amount >= ALL
		(SELECT t1.amount
			FROM credit_cards cc1,
 				 transactions t1
			WHERE cc1.number = t1.number
				AND cc1.type = cc2.type);",,,"SELECT code,
	name
FROM merchants m
WHERE m.code not in
		(SELECT DISTINCT code
			FROM transactions
			WHERE amount >= '888'
				AND number in
					(SELECT DISTINCT number
						FROM credit_cards
						WHERE type like ANY (array['%visa%', '%diners-club%'])));",,
A0093740E,"SELECT * FROM customers;
SELECT * FROM credit_cards;
SELECT * FROM merchants;
SELECT * FROM transactions;
SELECT DISTINCT cc.ssn
FROM transactions t, credit_cards cc
WHERE cc.number = t.number
AND cc.type='visa'
AND t.datetime BETWEEN '2017-12-25 00:00:00' AND '2017-12-26 00:00:00';",,,"SELECT a.first_name, a.last_name
FROM (
 	(SELECT c.first_name, c.last_name, c.ssn
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn
AND cc.type = 'visa'
AND c.country = 'Singapore') a
	INNER JOIN
	(SELECT c.first_name, c.last_name, c.ssn
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn
AND cc.type = 'jcb'
AND c.country = 'Singapore') b
	on a.ssn = b.ssn
)
	GROUP BY a.ssn, a.first_name, a.last_name;",,,"SELECT c.ssn, COUNT(cc.number)
FROM customers c LEFT OUTER JOIN credit_cards cc ON c.ssn = cc.ssn
GROUP BY c.ssn;",,,"SELECT a.ssn, a.type, 
   CASE WHEN b.nocc ISNULL THEN 0
	ELSE b.nocc END
	FROM (
		SELECT c.ssn, cc.type
			FROM customers c, credit_cards cc
			GROUP BY c.ssn, cc.type) a
		LEFT OUTER JOIN
		(SELECT c.ssn, cc.type,COUNT(cc.number) as nocc
			FROM customers c, credit_cards cc
			WHERE c.ssn=cc.ssn
			GROUP BY c.ssn, cc.type) b
		ON a.ssn=b.ssn AND a.type = b.type;",,,"SELECT
country, COUNT (DISTINCT ssn)
	FROM
	(
	SELECT DISTINCT c.ssn, c.country
	FROM customers c, merchants m, transactions t, credit_cards cc
	WHERE c.ssn = cc.ssn
	AND cc.number = t.number
	AND m.code = t.code
	AND c.country <> m.country
		) b
GROUP BY country ;",,,"SELECT 
t2.identifier
FROM transactions t2, credit_cards cc2
WHERE t2.number = cc2.number 
AND(cc2.type, t2.amount) IN
	(SELECT cc1.type, MAX(t1.amount)
     FROM transactions t1, credit_cards cc1
     WHERE t1.number=cc1.number
	 GROUP BY cc1.type);",,,"SELECT t1.identifier 
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number AND t1.amount >= ALL
	(SELECT t2.amount
	 FROM transactions t2, credit_cards cc2
	 WHERE t2.number = cc2.number AND cc2.type = cc1.type);",,,"SELECT DISTINCT m1.code, m1.name
FROM merchants m1
WHERE m1.code NOT IN (
    SELECT m.code
    FROM merchants m, transactions t, credit_cards cc
    WHERE m.code = t.code
    AND t.number = cc.number
    AND t.amount >= 888
    AND cc.type IN 
	( SELECT DISTINCT cc2.type FROM credit_cards cc2
	WHERE cc2.type LIKE 'visa%'
	OR cc2.type LIKE 'diners-club%' )
	);",,
A0105567A,"SELECT DISTINCT cc.ssn 
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
AND cc.type = 'visa'
AND t.datetime Between '2017-12-25' AND '2017-12-26'",,,"SELECT first_name, last_name 
FROM(
	SELECT DISTINCT c.first_name, c.last_name, c.ssn
	FROM customers c, credit_cards cc
	WHERE c.ssn = cc.ssn
	AND c.country = 'Singapore'
	AND cc.type = 'jcb'
INTERSECT 
	SELECT DISTINCT c2.first_name, c2.last_name, c2.ssn
	FROM credit_cards cc2, customers c2
	WHERE c2.country = 'Singapore'
	AND c2.ssn = cc2.ssn
	AND cc2.type = 'visa') AS temp",,,"SELECT c.ssn, count(number) 
FROM customers c LEFT OUTER JOIN credit_cards cc 
ON c.ssn = cc.ssn
GROUP by c.ssn",,,"DROP VIEW IF EXISTS all_cards;
CREATE VIEW all_cards AS
SELECT *
FROM customers c CROSS JOIN (SELECT DISTINCT cc.type 
							FROM credit_cards cc) AS c_type;
SELECT ac.ssn, ac.type, count(number)
FROM all_cards ac LEFT OUTER JOIN credit_cards cc
ON (ac.ssn, ac.type) = (cc.ssn, cc.type)
GROUP BY ac.ssn, ac.type",,,"SELECT c.country, count(DISTINCT c.ssn)
FROM customers c, credit_cards cc, merchants m, transactions t
WHERE m.code = t.code
AND c.ssn = cc.ssn
AND cc.number = t.number
AND c.country <> m.country
GROUP by c.country",,,"SELECT cc.type, t.identifier
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
AND (cc.type, t.amount) in (
	SELECT cc2.type, MAX(t2.amount)
	FROM credit_cards cc2, transactions t2
	WHERE cc2.number = t2.number
	GROUP BY cc2.type)",,,"SELECT cc.type, t.identifier
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
AND (cc.type, t.amount) >=ALL(
	SELECT cc2.type, t2.amount
	FROM credit_cards cc2, transactions t2
	WHERE cc2.number = t2.number
	AND cc.type = cc2.type)",,,"SELECT m.name
FROM merchants m
WHERE m.name NOT IN (
	SELECT m2.name
	FROM merchants m2, transactions t2, credit_cards cc2
	WHERE m2.code = t2.code
	AND t2.number = cc2.number
    AND (cc2.type like '%visa%' OR cc2.type like '%diners-club%')
	AND t2.amount >=888)","Missing semicolon, CHECK CODE.","Missing semicolon, CHECK CODE."
A0111496H,"SELECT DISTINCT c.ssn
FROM customers c, credit_cards d, transactions t
WHERE d.ssn = c.ssn
AND t.number = d.number
AND d.type = 'visa'
AND t.datetime BETWEEN '2017-12-25 00:00:00.00000'AND '2017-12-25 23:59:59.99999';",,,"SELECT first_name, last_name
FROM customers
WHERE country = 'Singapore'
AND ssn IN(
	SELECT ssn
	FROM credit_cards
	WHERE type = 'jcb'
	INTERSECT 
	SELECT ssn
	FROM credit_cards
	WHERE type = 'visa');",,,"SELECT c.ssn, COUNT(d.ssn) AS no_of_cards
FROM customers c LEFT JOIN credit_cards d ON c.ssn = d.ssn
GROUP BY c.ssn
ORDER BY no_of_cards, c.ssn;",,,"SELECT c.ssn, cs.type, count(d1.type)
FROM (customers c CROSS JOIN (SELECT DISTINCT d.type FROM credit_cards d) AS cs)
	LEFT JOIN credit_cards d1 ON cs.type = d1.type AND c.ssn = d1.ssn
GROUP BY c.ssn, cs.type
ORDER BY c.ssn;",,,"SELECT c.country, COUNT(DISTINCT c.ssn)
FROM transactions t, merchants m, credit_cards d, customers c
WHERE c.ssn = d.ssn
AND t.code = m.code
AND t.number = d.number
AND c.country != m.country
GROUP BY c.country;",,,"SELECT bb.identifier 
FROM (
	SELECT d.type, MAX(t.amount)
	FROM credit_cards d, transactions t
	WHERE t.number = d.number
	GROUP BY d.type) AS aa
INNER JOIN (
	SELECT d1.type, t1.amount, t1.identifier
	FROM credit_cards d1, transactions t1
	WHERE t1.number = d1.number) AS bb
ON aa.max = bb.amount AND aa.type = bb.type;",,,"SELECT t1.identifier
FROM credit_cards d1, transactions t1
WHERE d1.number = t1.number
AND t1.amount >= ALL (
	SELECT t2.amount
	FROM credit_cards d2, transactions t2
	WHERE d2.number = t2.number
	AND d1.type = d2.type);",,,"SELECT m.code, m.name
FROM merchants m
EXCEPT
SELECT DISTINCT m.code, m.name
FROM merchants m, transactions t, credit_cards d
WHERE m.code = t.code
AND t.number = d.number
AND t.amount >=888
AND (d.type LIKE '%visa%' OR d.type LIKE '%diners-club%');",,
A0113028W,"SELECT DISTINCT cr.ssn
FROM credit_cards cr, transactions t
WHERE cr.number = t.number
AND (SELECT date(t.datetime)) = '2017-12-25'
AND cr.type = 'visa';",,,"SELECT DISTINCT cu.first_name, cu.last_name
FROM customers cu, credit_cards cr1, credit_cards cr2
WHERE cu.ssn = cr1.ssn
AND cu.ssn = cr2.ssn
AND cu.country = 'Singapore'
AND cr1.type = 'jcb'
AND cr2.type = 'visa';",,,"SELECT cu.ssn, COUNT(cr.number) AS no_of_cc_owned
FROM customers cu LEFT JOIN credit_cards cr ON cu.ssn = cr.ssn
GROUP BY cu.ssn;",,,"SELECT cu.ssn, (CASE WHEN cr.type IS NULL THEN '0' ELSE cr.type END), COUNT(cr.type) AS no_of_cctype_owned
FROM customers cu LEFT JOIN credit_cards cr ON cu.ssn = cr.ssn
GROUP BY cu.ssn, cr.type;",,,"SELECT cu.country, count(DISTINCT cu.ssn) AS no_of_customer
FROM customers cu, credit_cards cr, transactions t, merchants m
WHERE cu.ssn = cr.ssn
AND cr.number = t.number
AND t.code = m.code
AND m.country <> cu.country
GROUP BY cu.country;",,,"SELECT t1.identifier
FROM transactions t1, credit_cards cr1
WHERE t1.number = cr1.number
AND (cr1.type, t1.amount) IN (
		SELECT cr2.type, MAX(t2.amount)
		FROM transactions t2, credit_cards cr2
		WHERE cr2.number = t2.number
		GROUP BY cr2.type);",,,"SELECT t1.identifier
FROM transactions t1, credit_cards cr1
WHERE t1.number = cr1.number
AND t1.amount >= ALL (
		SELECT t2.amount
		FROM transactions t2, credit_cards cr2
		WHERE cr2.number = t2.number
		AND cr1.type = cr2.type);",,,"SELECT DISTINCT m1.code, m1.name
FROM merchants m1
WHERE m1.name IN (
	SELECT m2.name
	FROM merchants m2, transactions t, credit_cards cr
	WHERE t.code = m2.code
	AND cr.number = t.number
	AND cr.type LIKE '%diners-club%'
	GROUP BY m2.name
	HAVING MAX(t.amount) < 888
	UNION
	SELECT m3.name
	FROM merchants m3, transactions t, credit_cards cr
	WHERE t.code = m3.code
	AND cr.number = t.number
	AND cr.type LIKE '%visa%'
	GROUP BY m3.name
	HAVING MAX(t.amount) < 888)","Missing semicolon, CHECK CODE.","Missing semicolon, CHECK CODE."
A0113951L,"select c.ssn
from customers c, credit_cards cc, transactions t
where c.ssn = cc.ssn
and t.number = cc.number
and cc.type = 'visa'
and date(t.datetime::date) = '2017-12-25'",,,"select c.first_name, c.last_name
from customers c, credit_cards cc, credit_cards cc1
where c.ssn = cc.ssn
and c.ssn = cc1.ssn
and (cc.type = 'visa' and cc1.type = 'jcb')
order by c.ssn",,,"select c.ssn, count(*)
from customers c left join credit_cards cc
on c.ssn = cc.ssn
group by c.ssn",,,"select c.ssn, cc.type, sum(
	case
	when c.ssn = cc.ssn then 1
	else 0
	end)
from customers c, credit_cards cc
group by c.ssn, cc.type
order by c.ssn",,,"select c.country, count(*)
from customers c, credit_cards cc, merchants m, transactions t
where c.ssn = cc.ssn
and cc.number = t.number
and m.code = t.code
and c.country <> m.country
group by c.country",,,"create view all_transactions as 
select cc.type, t.identifier, t.amount
from credit_cards cc, transactions t
where cc.number = t.number
select at.type, at.identifier
from all_transactions as at
inner join (
	select type, max(amount)
	from all_transactions 
	group by type) as b
on at.type = b.type and 
at.amount = b.max",,,"select cc.type, t.identifier
from transactions t, credit_cards cc
where t.number = cc.number
and t.amount >= all (
		select t2.amount
		from transactions t2, credit_cards cc2
		where t2.number = cc2.number 
		and cc.type = cc2.type)",,,"select m.code
from merchants m
where not exists(
	select * 
	from transactions t
	where m.code = t.code and t.amount >= 888
	and exists(
		select * 
		from credit_cards cc
		where t.number = cc.number
		and (cc.type like 'visa%' or
			 cc.type like 'diners-club%')))","Missing semicolon, CHECK CODE.","Missing semicolon, CHECK CODE."
A0119430N,"SELECT DISTINCT cc.ssn FROM credit_cards cc, transactions t
WHERE cc.number = t.number
AND cc.type = 'visa'
AND t.datetime >= '2017-12-25'
AND t.datetime < '2017-12-26';",,,"SELECT c.first_name, c.last_name
FROM customers c, credit_cards cc1, credit_cards cc2
WHERE c.ssn = cc1.ssn AND cc1.type = 'visa'
AND c.ssn = cc2.ssn AND cc2.type = 'jcb'
GROUP BY c.ssn, c.first_name, c.last_name;",,,"SELECT c.ssn, COUNT(cc.number) AS card_count
FROM customers c LEFT JOIN credit_cards cc
ON c.ssn = cc.ssn
GROUP BY c.ssn
ORDER BY card_count;",,,"SELECT c.ssn, ct.type, COUNT(cc.number) AS card_count
FROM customers c
CROSS JOIN (SELECT DISTINCT cc.type FROM credit_cards cc) AS ct
LEFT JOIN credit_cards cc
ON  ct.type = cc.type AND c.ssn = cc.ssn
GROUP BY c.ssn, ct.type
ORDER BY c.ssn;",,,"SELECT c.country, COUNT(DISTINCT c.ssn)
FROM customers c, credit_cards cc, transactions t, merchants m
WHERE c.ssn = cc.ssn
AND cc.number = t.number
AND t.code = m.code
AND NOT c.country = m.country
GROUP BY c.country;",,,"SELECT t1.identifier
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number
AND t1.amount = ALL(
	SELECT MAX(t2.amount)
	FROM transactions t2, credit_cards cc2
	WHERE t2.number = cc2.number
	AND cc2.type = cc1.type);",,,"SELECT t1.identifier
FROM transactions t1, credit_cards cc1
WHERE t1.amount >= ALL(
	SELECT t2.amount
	FROM transactions t2, credit_cards cc2
	WHERE t2.number = cc2.number
	AND cc2.type = cc1.type)
AND t1.number = cc1.number;",,,"SELECT m.code, m.name
FROM merchants m
EXCEPT(
SELECT m2.code, m2.name
FROM credit_cards cc, transactions t, merchants m2
WHERE cc.number = t.number
AND t.code = m2.code
AND t.amount >= 888
AND (cc.type LIKE 'visa%' OR cc.type LIKE 'diners-club%')
GROUP BY m2.code, m2.name);",,
A0119542H,"SELECT DISTINCT c.ssn
FROM customers c, credit_cards cc, transactions t
WHERE cc.ssn = c.ssn
AND t.number = cc.number
AND date_trunc('day',t.datetime) = '2017-12-25 00:00:00'
AND cc.type = 'visa';",,,"DROP VIEW IF EXISTS distinct_customer_jcb_visa;
CREATE VIEW distinct_customer_jcb_visa AS
		SELECT DISTINCT c.first_name, c.last_name, c.ssn
		FROM customers c, credit_cards cc
		WHERE cc.ssn = c.ssn
		AND c.country = 'Singapore'
		AND cc.type = 'visa' 
	INTERSECT
		SELECT DISTINCT  c2.first_name, c2.last_name, c2.ssn 
		FROM customers c2, credit_cards cc2
		WHERE cc2.ssn = c2.ssn
		AND c2.country = 'Singapore'
		AND cc2.type = 'jcb' ;
SELECT first_name, last_name
FROM distinct_customer_jcb_visa;",,,"SELECT c.ssn, COUNT(cc.number) AS ""number_of_credit_cards""
FROM customers c
	LEFT JOIN credit_cards cc ON c.ssn = cc.ssn
GROUP BY c.ssn;",,,"DROP VIEW IF EXISTS customer_card_type;
CREATE VIEW customer_card_type AS
SELECT *
FROM customers c CROSS JOIN (SELECT DISTINCT cc.type 
							 FROM credit_cards cc) AS c_type;
SELECT cct.ssn, cct.type, count(number)
FROM customer_card_type cct LEFT OUTER JOIN credit_cards cc
ON (cct.ssn, cct.type) = (cc.ssn, cc.type)
GROUP BY cct.ssn, cct.type;",,,"SELECT c.country, COUNT(DISTINCT c.ssn)
FROM customers c NATURAL JOIN credit_cards cc NATURAL JOIN  transactions t LEFT JOIN merchants m ON t.code=m.code
WHERE c.country <>  m.country
GROUP BY c.country;",,,"SELECT cc.type, t.identifier, t.amount
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
AND (cc.type, t.amount) IN(
	SELECT cc2.type, MAX(t2.amount)
	FROM credit_cards cc2, transactions t2
	WHERE cc2.number = t2.number
	GROUP BY cc2.type);",,,"DROP VIEW IF EXISTS type_identifier_amt;
CREATE VIEW type_identifier_amt AS 
SELECT cc.type, t1.identifier, t1.amount
FROM transactions t1, credit_cards cc
WHERE t1.number = cc.number;
SELECT tia1.type, tia1.identifier, tia1.amount
FROM type_identifier_amt tia1
WHERE tia1.amount>= ALL(
	SELECT tia2.amount 
	FROM type_identifier_amt tia2
	WHERE tia1.type = tia2.type);",,,"SELECT m.code, m.name
FROM credit_cards cc LEFT OUTER JOIN transactions t ON cc.number = t.number 
LEFT OUTER JOIN merchants m on m.code = t.code
WHERE cc.type LIKE 'visa%' OR cc.type LIKE 'diners-club%'
GROUP BY m.code, m.name
HAVING MAX(t.amount)<888;",,
A0124216U,"select distinct cc.ssn
from transactions t, credit_cards cc
where t.number = cc.number
and cc.type='visa'
and t.datetime between '2017-12-25' and '2017-12-26';",,,"select a.first_name, a.last_name 
from (
select distinct c.ssn, c.first_name, c.last_name
from credit_cards cc, customers c
where cc.ssn = c.ssn
and cc.type in ('jcb','visa') and c.country = 'Singapore')a;",,,"select c.ssn,
sum(case when c.ssn=cc.ssn then 1 else 0 end) as ""count""
from credit_cards cc, customers c
group by c.ssn;",,,"select c.ssn, cc.type,
sum(case when c.ssn=cc.ssn then 1 else 0 end) as ""count""
from credit_cards cc, customers c
group by c.ssn, cc.type;",,,"select m.country, count(c.ssn)
from merchants m, transactions t, credit_cards cc, customers c
where cc.number=t.number and m.code=t.code and c.ssn=cc.ssn
and m.country<>c.country
group by m.country;",,,"select t2.identifier
from transactions t2, credit_cards cc2
where t2.number = cc2.number and
(cc2.type, t2.amount) in
(select cc.type, MAX(t.amount) as ""amount""
from transactions t, credit_cards cc
where t.number=cc.number
group by cc.type);",,,"select t.identifier
from transactions t, credit_cards cc
where t.number=cc.number
and t.amount >= ALL(
select t2.amount
from transactions t2, credit_cards cc2
where t2.number=cc2.number and cc.type=cc2.type);",,,"select m.code, m.name
FROM transactions t, credit_cards cc, merchants m
WHERE t.number=cc.number and m.code=t.code
and (cc.type like '%visa%' or cc.type like '%diners-club%')
group by m.code, m.name
having max(t.amount)<888;",,
A0124294H,"select distinct ssn from credit_cards cc where cc.number in 
(select distinct number from transactions trans where CAST(trans.datetime AS DATE) = '2017-12-25') and cc.type = 'visa' order by ssn;",,,"select first_name,last_name from customers cust where cust.ssn in 
((select cc.ssn from credit_cards cc where ""type"" = 'jcb') intersect (select cc.ssn from credit_cards cc where ""type"" = 'visa'))
and country ='Singapore';",,,"select ssn,
	CASE when counter is null
	then 0 
	else counter end	
from 
(select cust.ssn, tem.counter from customers cust left outer join 
(select ssn, count(*) as counter FROM credit_cards group by ssn) tem ON tem.ssn = cust.ssn) as tempo;",,,"select ssn,cardtype,
	CASE when counter is null
	then 0 
	else counter end	
from 
(select tempo.ssn,tempo.cardtype,tem.counter from 
(select cust.ssn,cc.cardtype from (select distinct ""type"" as cardtype from credit_cards) cc, customers cust) tempo
left outer join 
(select ssn, ""type"", count(*) as counter FROM credit_cards
 group by ""type"",ssn) tem on tem.ssn = tempo.ssn and tem.type = tempo.cardtype) as tt;",,,"select cust_ctry,count(distinct cust_ssn) from 
(select cc.ssn as cust_ssn, tran.number as cust_card,mer.country as merchant_ctry, cust.country as cust_ctry 
from transactions tran,merchants mer,credit_cards cc, customers cust
where tran.code = mer.code and cc.number = tran.number  and cust.ssn = cc.ssn) tempctry 
where not merchant_ctry = cust_ctry group by cust_ctry order by cust_ctry;",,,"SELECT tablethree.identifier
FROM (select trans.identifier,trans.amount,cc.type from transactions trans,credit_cards cc
where trans.number = cc.number) tablethree 
INNER JOIN
(select tableone.type,max(tableone.amount) as largest_amt from
(select trans.identifier,trans.amount,cc.type from transactions trans,credit_cards cc
where trans.number = cc.number) tableone group by tableone.type) tabletwo 
ON tabletwo.type = tablethree.type and tabletwo.largest_amt = tablethree.amount;",,,"SELECT t1.identifier FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number AND t1.amount >= ALL
(SELECT t2.amount
FROM transactions t2, credit_cards cc2
WHERE t2.number = cc2.number AND cc2.type = cc1.type);",,,"select mer.code, mer.name from merchants mer, 
(select code from merchants
except
select distinct code from transactions trans,credit_cards cc where 
cc.number = trans.number and amount >= 888 and (type like '%visa%' or type like '%diners-club%')) codes
where mer.code=codes.code;",,
A0125002E,"SELECT 
  DISTINCT cu.ssn as Social_Security_Number 
FROM 
  customers cu, 
  credit_cards cc, 
  transactions t 
WHERE 
  t.number = cc.number 
  AND cc.type = 'visa' 
  AND cu.ssn = cc.ssn 
  AND DATE(t.datetime) = '2017-12-25';",,,"SELECT 
  foo.first_name, 
  foo.last_name 
FROM 
  (
    SELECT 
      cu.first_name, 
      cu.last_name, 
      cu.SSN 
    FROM 
      customers cu, 
      credit_cards cc 
    WHERE 
      cu.country = 'Singapore' 
      AND cc.type = 'jcb' 
      AND cc.SSN = cu.SSN 
    INTERSECT 
    SELECT 
      cu.first_name, 
      cu.last_name, 
      cu.SSN 
    FROM 
      customers cu, 
      credit_cards cc 
    WHERE 
      cu.country = 'Singapore' 
      AND cc.type = 'visa' 
      AND cc.SSN = cu.SSN
  ) AS foo;",,,"SELECT 
  cu.SSN, 
  (
    CASE WHEN COUNT(cc.SSN) ISNULL THEN '0' ELSE COUNT(cc.SSN) END
  ) as Number_of_CreditCard_owned 
FROM 
  customers cu 
  LEFT OUTER JOIN credit_cards cc ON cu.SSN = cc.SSN 
GROUP BY 
  cu.SSN 
ORDER BY 
  number_of_CreditCard_owned ASC;",,,"SELECT 
  _cartesian_16cards_with_cu.ssn, 
  _cartesian_16cards_with_cu.type, 
  (
    CASE WHEN COUNT(numb_cards_owned.SSN) ISNULL THEN '0' ELSE COUNT(numb_cards_owned.SSN) END
  ) as Number_of_CreditCard_owned 
FROM 
  (
    SELECT 
      cc_types.type, 
      cu.ssn 
    FROM 
      (
        SELECT 
          DISTINCT (cc.type) 
        FROM 
          credit_cards cc
      ) AS cc_types, 
      customers cu
  ) AS _cartesian_16cards_with_cu 
  LEFT OUTER JOIN (
    SELECT 
      cc.ssn, 
      cc.type, 
      COUNT(cc.ssn) 
    FROM 
      credit_cards cc 
    GROUP BY 
      cc.ssn, 
      cc.type
  ) AS numb_cards_owned ON numb_cards_owned.ssn = _cartesian_16cards_with_cu.ssn 
  AND numb_cards_owned.type = _cartesian_16cards_with_cu.type 
GROUP BY 
  _cartesian_16cards_with_cu.ssn, 
  _cartesian_16cards_with_cu.type 
ORDER BY 
  _cartesian_16cards_with_cu.SSN ASC;",,,"SELECT 
  cu.country, 
  count(DISTINCT cu.SSN) 
FROM 
  customers cu, 
  credit_cards cc, 
  merchants m, 
  transactions t 
WHERE 
  cu.ssn = cc.ssn 
  AND cc.number = t.number 
  AND t.code = m.code 
  AND m.country <> cu.country 
GROUP BY 
  cu.country;",,,"SELECT 
  t.identifier
FROM 
  credit_cards cc, 
  transactions t 
WHERE 
  (t.amount, cc.type) IN (
    SELECT 
      MAX(t.amount), 
      cc.type 
    FROM 
      credit_cards cc, 
      transactions t 
    WHERE 
      cc.number = t.number 
    GROUP BY 
      cc.type
  ) 
  AND cc.number = t.number;",,,"SELECT 
  t.identifier 
FROM 
  credit_cards cc, 
  transactions t 
WHERE 
  cc.number = t.number 
  AND (
    t.amount >= ALL (
      SELECT 
        t2.amount 
      FROM 
        transactions t2, 
        credit_cards cc2 
      WHERE 
        cc2.number = t2.number 
        AND cc.type = cc2.type
    )
  );",,,"SELECT 
  DISTINCT m1.code, 
  m1.name 
FROM 
  merchants m1, 
  transactions t1, 
  credit_cards cc1 
WHERE 
  m1.code = t1.code 
  AND cc1.number = t1.number 
  AND NOT EXISTS (
    SELECT 
      m.code, 
      m.name, 
      t.amount, 
      cc.type 
    FROM 
      merchants m, 
      transactions t, 
      credit_cards cc 
    WHERE 
      m.code = t.code 
      AND t.number = cc.number 
      AND t.amount >= 888 
      AND (
        cc.type LIKE 'visa%' 
        OR cc.type LIKE 'diners%'
      ) 
      AND m1.code = m.code
  );",,
A0142279B,"SELECT DISTINCT cc.ssn
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
AND cc.type='visa'
AND t.datetime::date = '2017-12-25';",,,"SELECT c.first_name, c.last_name
FROM customers c
WHERE c.country = 'Singapore'
AND c.ssn IN (
	SELECT DISTINCT c.ssn
	FROM customers c, credit_cards cc
	WHERE c.ssn=cc.ssn 
	AND cc.type='visa'
	INTERSECT 
	SELECT DISTINCT c.ssn
	FROM customers c, credit_cards cc
	WHERE c.ssn=cc.ssn 
	AND cc.type='jcb');",,,"SELECT c.ssn, COUNT(cc.number) AS number_of_card
FROM customers c LEFT OUTER JOIN credit_cards cc ON c.ssn = cc.ssn
GROUP BY c.ssn;",,,"SELECT to_fill.ssn, to_fill.type, COUNT(number) AS number_of_card
FROM (SELECT c.ssn, cc_type.type
	  FROM customers c, (SELECT DISTINCT cc.type FROM credit_cards cc) AS cc_type) AS to_fill
	  LEFT JOIN credit_cards cc1 ON cc1.ssn = to_fill.ssn AND cc1.type = to_fill.type
GROUP BY to_fill.ssn, to_fill.type;",,,"SELECT diff_cty.country, COUNT(DISTINCT diff_cty.ssn)
FROM (SELECT c.country, c.ssn
	  FROM customers c, credit_cards cc, transactions t, merchants m
	  WHERE c.ssn = cc.ssn
	  AND cc.number = t.number
	  AND t.code = m.code
	  AND c.country <> m.country) AS diff_cty
GROUP BY diff_cty.country;",,,"SELECT DISTINCT t.identifier
FROM transactions t, credit_cards cc,
	(SELECT cc1.type, MAX(t1.amount)
	  FROM credit_cards cc1, transactions t1
	  WHERE cc1.number = t1.number
	  GROUP BY cc1.type) AS max_trans  
WHERE t.amount = max_trans.max
AND cc.number = t.number
AND cc.type = max_trans.type;",,,"SELECT DISTINCT t.identifier
FROM credit_cards cc, transactions t 
WHERE cc.number = t.number
AND t.amount >= ALL(SELECT t1.amount 
				   FROM credit_cards cc1, transactions t1
				   WHERE cc1.number = t1.number
				   AND cc.type = cc1.type);",,,"SELECT m1.code, m1.name
FROM merchants m1
WHERE m1.code NOT IN (
	SELECT m.code
	FROM merchants m, credit_cards cc, transactions t
	WHERE cc.number = t.number
	AND t.code = m.code
	AND t.amount >= 888
	AND (cc.type LIKE 'visa%' OR cc.type LIKE 'diners-club%'))","Missing semicolon, CHECK CODE.","Missing semicolon, CHECK CODE."
A0150032A,"SELECT DISTINCT c.ssn
FROM transactions t
JOIN 
credit_cards cc 
ON t.number = cc.number
JOIN 
customers c
ON cc.ssn = c.ssn
WHERE 
cc.type = 'visa'
AND date(t.datetime) = '2017-12-25';",,,"SELECT DISTINCT first_name, last_name
FROM
credit_cards cc
JOIN 
customers c
ON cc.ssn = c.ssn
WHERE 
cc.type = 'jcb' AND c.country = 'Singapore' 
INTERSECT
SELECT DISTINCT first_name, last_name
FROM 
credit_cards cc
JOIN
customers c
ON cc.ssn = c.ssn
WHERE 
cc.type = 'visa' AND c.country = 'Singapore';",,,"SELECT c.ssn as ssn, COALESCE(COUNT(cc.number),0) as num_cc
FROM
customers c
LEFT JOIN credit_cards cc
ON c.ssn = cc.ssn
GROUP BY c.ssn
ORDER BY num_cc DESC;",,,"SELECT ccc.ssn, ccc.type, COALESCE(count_cc.num_cc, 0) as number_credit_card
FROM
(
SELECT DISTINCT ssn as ssn, type as type
FROM(
(SELECT ssn FROM customers) c
CROSS JOIN
(SELECT type FROM credit_cards) cc)
ORDER BY ssn, type
) ccc
LEFT JOIN 
(
SELECT ssn, type, COUNT(*) as num_cc
FROM credit_cards
GROUP BY ssn, type
) count_cc
ON ccc.ssn = count_cc.ssn
AND ccc.type = count_cc.type;",,,"SELECT a.c_country, COUNT(ssn)
FROM
(SELECT DISTINCT c.ssn, c.country as c_country
FROM customers c
JOIN credit_cards cc
ON c.ssn = cc.ssn
JOIN transactions t
ON t.number = cc.number
JOIN merchants m
ON t.code = m.code
WHERE
c.country <> m.country) a
GROUP BY c_country;",,,"SELECT x2.identifier, x1.type, x1.amount
FROM
(SELECT cc1.type, MAX(t1.amount) amount
FROM transactions t1
JOIN credit_cards cc1
ON t1.number = cc1.number
GROUP BY cc1.type
ORDER BY cc1.type) x1
JOIN 
(SELECT t1.identifier, cc1.type, t1.amount
FROM
transactions t1
JOIN credit_cards cc1
ON t1.number = cc1.number
) x2
ON x1.type = x2.type 
AND x1.amount = x2.amount 
ORDER BY x1.type;",,,"SELECT t1.identifier, cc1.type , t1.amount
FROM transactions t1
JOIN credit_cards cc1
ON t1.number = cc1.number
WHERE t1.amount >= ALL
(
SELECT t2.amount
FROM transactions t2
JOIN credit_cards cc2
ON t2.number = cc2.number
WHERE cc1.type = cc2.type
) 
ORDER BY cc1.type;",,,"SELECT m.code, m.name
FROM merchants m
WHERE m.code
NOT IN
(
SELECT DISTINCT m.code
FROM transactions t
JOIN credit_cards cc
ON t.number = cc.number
JOIN merchants m
ON t.code = m.code
WHERE t.amount >= 888
AND (cc.type LIKE 'visa%' OR cc.type LIKE 'diners-club%')
);",,
A0150639A,"SELECT DISTINCT cc.ssn
FROM 
	customers c, 
	transactions t, 
	credit_cards cc
WHERE c.ssn = cc.ssn
	  AND cc.number = t.number
	  AND t.datetime BETWEEN '2017-12-25 00:00:00.000000' AND '2017-12-25 23:59:59.999999'
	  AND cc.type = 'visa';",,,"SELECT c.ssn
FROM customers c LEFT JOIN credit_cards cc
	 on c.ssn = cc.ssn
WHERE c.country = 'Singapore'
	  AND cc.type IN ('jcb','visa')
GROUP BY c.ssn
HAVING COUNT(DISTINCT cc.type) = 2;",,,"SELECT 
	c.ssn, 
	count(cc.number)
FROM customers c 
	 LEFT JOIN credit_cards cc 
	 ON c.ssn = cc.ssn
GROUP BY c.ssn;",,,"SELECT
	c.ssn, 
	cc.type, 
	count(cc.number)
FROM customers c 
	 LEFT JOIN credit_cards cc 
	 ON c.ssn = cc.ssn
GROUP BY c.ssn,cc.type;",,,"SELECT 
	c.country, 
	count(distinct c.ssn)
FROM 
	 customers c,
	 credit_cards cc, 
	 transactions t,
	 merchants m
WHERE 
	 c.ssn = cc.ssn
	 AND cc.number = t.number
	 AND t.code = m.code 
	 AND c.country <> m.country
GROUP BY c.country;",,,"SELECT
	t1.identifier
FROM(
	SELECT 
		cc2.type card_type,
		max(t2.amount) largest_amount
	FROM 
		transactions t2,
		credit_cards cc2
	WHERE
		cc2.number = t2.number
	GROUP BY
		cc2.type) as tb,
	transactions t1,
	credit_cards cc1
WHERE
	t1.number = cc1.number
	AND cc1.type = tb.card_type
	AND t1.amount = tb.largest_amount;",,,"SELECT
	t1.identifier
FROM
	transactions t1,
	credit_cards cc1
WHERE
	t1.number = cc1.number
	AND t1.amount >= ALL(
		SELECT t2.amount
		FROM 
			transactions t2,
			credit_cards cc2
		WHERE
			t2.number = cc2.number
			AND cc1.type = cc2.type);",,,"SELECT
	m2.code,
	m2.name
FROM
	merchants m2
WHERE
	(m2.code, m2.name) NOT IN(
	SELECT
		m1.code,
		m1.name
	FROM
		merchants m1,
		transactions t1,
		credit_cards cc1
	WHERE
		m1.code = t1.code
		AND t1.number = cc1.number
		AND t1.amount >= 888
		AND (cc1.type LIKE 'visa%' OR cc1.type LIKE 'diners-club%'));",,
A0154734A,"select 
  distinct cc.ssn 
from 
  credit_cards cc, 
  transactions t 
where 
  cc.number = t.number 
  and cc.type = 'visa' 
  and extract(
    year 
    from 
      t.datetime
  ) = 2017 
  and extract(
    month 
    from 
      t.datetime
  ) = 12 
  and extract(
    day 
    from 
      t.datetime
  ) = 25 
order by 
  cc.ssn",,,"select 
  list.first_name, 
  list.last_name 
from 
  (
    select 
      distinct visa.ssn, 
      visa.first_name, 
      visa.last_name 
    from 
      (
        select 
          c.ssn, 
          c.first_name, 
          c.last_name 
        from 
          customers c, 
          credit_cards cc 
        where 
          c.country = 'Singapore' 
          and cc.type = 'visa' 
          and c.ssn = cc.ssn
      ) as visa, 
      (
        select 
          c.ssn, 
          c.first_name, 
          c.last_name 
        from 
          customers c, 
          credit_cards cc 
        where 
          c.country = 'Singapore' 
          and cc.type = 'jcb' 
          and c.ssn = cc.ssn
      ) as jcb 
    where 
      visa.ssn = jcb.ssn
  ) as list 
order by 
  list.first_name",,,"select 
  distinct (c.ssn), 
  Coalesce(
    count(cc.ssn), 
    0
  ) 
from 
  customers c 
  left outer join credit_cards cc on c.ssn = cc.ssn 
group by 
  c.ssn, 
  cc.ssn 
order by 
  c.ssn",,,"select 
  z.ssn, 
  z.type, 
  sum(z.count_label) as count 
from 
  (
    select 
      c.ssn, 
      cc.type, 
      cc.ssn as label, 
      (
        case when c.ssn = cc.ssn then 1 else 0 end
      ) as count_label 
    from 
      customers c, 
      credit_cards cc 
    group by 
      c.ssn, 
      cc.type, 
      cc.ssn 
    order by 
      c.ssn, 
      cc.type
  ) as z 
group by 
  z.ssn, 
  z.type 
order by 
  z.ssn, 
  z.type",,,"select 
  c.country, 
  count(c.country) 
from 
  customers c, 
  credit_cards cc, 
  merchants m, 
  transactions t 
where 
  c.ssn = cc.ssn 
  and cc.number = t.number 
  and t.code = m.code 
  and c.country != m.country 
group by 
  c.country 
order by 
  c.country",,,"select 
  final.identifier 
from 
  (
    select 
      t.identifier, 
      max_amt.max as amt, 
      max_amt.type 
    from 
      (
        select 
          cc.type, 
          max(t.amount) 
        from 
          credit_cards cc, 
          transactions t 
        where 
          cc.number = t.number 
        group by 
          cc.type
      ) as max_amt, 
      transactions t 
    where 
      t.amount = max_amt.max 
    order by 
      max_amt.type
  ) as final",,,"select 
  final.identifier 
from 
  (
    select 
      distinct m2.identifier, 
      m2.amount, 
      m2.type 
    from 
      (
        SELECT 
          z.identifier, 
          z.amount, 
          z.type 
        FROM 
          (
            SELECT 
              cc.type, 
              t.identifier, 
              t.amount, 
              ROW_NUMBER() OVER(
                PARTITION BY cc.type 
                ORDER BY 
                  t.amount DESC
              ) rowNumber 
            FROM 
              transactions t, 
              credit_cards cc 
            where 
              t.number = cc.number
          ) as z 
        WHERE 
          z.rowNumber = 1 
        order by 
          z.type
      ) as m1, 
      (
        select 
          t.identifier, 
          t.amount, 
          cc.type 
        from 
          transactions t, 
          credit_cards cc
      ) as m2 
    where 
      m1.amount = m2.amount 
      and m1.type = m2.type 
    order by 
      m2.identifier
  ) as final",,,"select 
  m.code, 
  m.name 
from 
  merchants m, 
  credit_cards cc, 
  transactions t 
where 
  m.code = t.code 
  and cc.number = t.number 
except 
select 
  m.code, 
  m.name 
from 
  merchants m, 
  credit_cards cc, 
  transactions t 
where 
  m.code = t.code 
  and cc.number = t.number 
  and t.amount >= 888 
  and (
    cc.type like '%visa%' 
    or cc.type like '%diners-club%'
  )","Missing semicolon, CHECK CODE.","Missing semicolon, CHECK CODE."
A0165086Y,"SELECT DISTINCT customers.ssn
FROM customers, credit_cards, transactions
WHERE customers.ssn = credit_cards.ssn AND credit_cards.number = transactions.number AND credit_cards.type = 'visa' 
AND transactions.datetime BETWEEN '2017-12-25' AND '2017-12-26';",,,"SELECT final.first_name, final.last_name
FROM (SELECT customers.ssn, customers.first_name, customers.last_name FROM customers, credit_cards
		WHERE customers.ssn = credit_cards.ssn
		AND customers.country = 'Singapore' AND credit_cards.type = ('visa')
		INTERSECT
		SELECT c2.ssn, c2.first_name, c2.last_name
		FROM customers AS c2, credit_cards AS cards2
		WHERE c2.ssn = cards2.ssn
		AND c2.country = 'Singapore' AND cards2.type = ('jcb')) AS final
ORDER BY final.first_name;",,,"SELECT customers.ssn, COUNT(credit_cards.number)
FROM customers
LEFT JOIN credit_cards ON customers.ssn = credit_cards.ssn
GROUP BY customers.ssn
ORDER BY COUNT(credit_cards.number);",,,"SELECT cus1.ssn, cus2.type, COUNT(credit_cards.number)
FROM (SELECT DISTINCT customers.ssn
	  FROM customers) AS cus1
	  CROSS JOIN
	  (SELECT DISTINCT credit_cards.type
	  FROM credit_cards) AS cus2
LEFT JOIN credit_cards 
ON cus1.ssn = credit_cards.ssn AND cus2.type = credit_cards.type
GROUP BY cus1.ssn, cus2.type
ORDER BY cus1.ssn, cus2.type;",,,"SELECT customers.country, COUNT (DISTINCT customers.ssn) FROM customers, credit_cards, merchants, transactions
WHERE customers.ssn = credit_cards.ssn AND credit_cards.number = transactions.number 
AND transactions.code = merchants.code AND customers.country <> merchants.country
GROUP BY customers.country;",,,"SELECT transactions.identifier
FROM transactions, credit_cards, 
     (SELECT credit_cards.type, MAX(amount) as maximum
		FROM transactions, credit_cards
		WHERE transactions.number = credit_cards.number
		GROUP BY credit_cards.type) AS variable
WHERE transactions.number = credit_cards.number
AND   transactions.amount = maximum 
AND   credit_cards.type = variable.type;",,,"SELECT transactions.identifier FROM transactions, credit_cards 
WHERE transactions.number = credit_cards.number
AND transactions.amount >= ALL(
		SELECT transact2.amount
		FROM transactions AS transact2, credit_cards AS credit_cards2
		WHERE transact2.number = credit_cards2.number
		AND   credit_cards.type = credit_cards2.type);",,,"SELECT merchants.code, merchants.name
FROM merchants, transactions, credit_cards
WHERE merchants.code = transactions.code AND transactions.number = credit_cards.number
EXCEPT
SELECT merchants.code, merchants.name
FROM merchants, transactions, credit_cards
WHERE merchants.code = transactions.code AND transactions.number = credit_cards.number
AND (credit_cards.type LIKE '%visa%' OR credit_cards.type LIKE '%diners-club%') AND transactions.amount >= 888
ORDER BY code;",,
A0177964J,"SELECT DISTINCT c.ssn
FROM credit_cards c, transactions t
WHERE c.type = 'visa'
AND c.number = t.number
AND t.datetime >= '2017-12-25' AND t.datetime < '2017-12-26';",,,"SELECT c1.first_name, c1.last_name 
FROM (
	SELECT DISTINCT c.first_name, c.last_name, c.ssn
	FROM customers c, credit_cards cc
	WHERE c.country = 'Singapore'
	AND c.ssn = cc.ssn
	AND cc.type = 'visa' 
	INTERSECT 
	SELECT DISTINCT c.first_name, c.last_name, c.ssn
	FROM customers c, credit_cards cc
	WHERE c.country = 'Singapore'
	AND c.ssn = cc.ssn
	AND cc.type = 'jcb') AS c1;",,,"SELECT c.ssn, COUNT(cc.number)
FROM customers c LEFT JOIN credit_cards cc ON c.ssn = cc.ssn
GROUP BY c.ssn
ORDER BY COUNT(cc.number);",,,"SELECT c1.ssn, cc1.type, COUNT(cc.number)
FROM (
	SELECT DISTINCT c.ssn
	FROM customers c) AS c1
	CROSS JOIN 
	(SELECT DISTINCT cc.type
	FROM credit_cards cc) AS cc1
	LEFT JOIN
	credit_cards cc 
	ON c1.ssn = cc.ssn 
	AND cc1.type = cc.type
GROUP BY c1.ssn, cc1.type
ORDER BY c1.ssn, cc1.type;",,,"SELECT c.country, COUNT(c.ssn)
FROM customers c 
WHERE EXISTS (
	SELECT *
	FROM merchants m, transactions t, credit_cards cc
	WHERE m.code = t.code
	AND t.number = cc.number
	AND cc.ssn = c.ssn
	AND m.country <> c.country)
GROUP BY c.country;",,,"SELECT t.identifier
FROM credit_cards cc 
	JOIN transactions t ON cc.number = t.number,
	(SELECT cc1.type, MAX(t1.amount)
	 FROM transactions t1 JOIN credit_cards cc1 
	 ON t1.number = cc1.number
	 GROUP BY cc1.type) AS a
WHERE cc.type = a.type
AND t.amount = a.max;",,,"SELECT t.identifier
FROM transactions t
JOIN credit_cards cc ON t.number = cc.number 
WHERE  t.amount >= ALL 
	(SELECT t1.amount
	FROM transactions t1 
	JOIN credit_cards cc1 ON t1.number = cc1.number
	WHERE cc.type = cc1.type);",,,"SELECT m.code, m.name
FROM merchants m 
WHERE m.code NOT IN (
	SELECT m.code
	FROM merchants m 
	JOIN transactions t ON m.code = t.code
	JOIN credit_cards cc ON cc.number = t.number 
	WHERE (cc.type LIKE '%visa%' OR cc.type LIKE '%diners-club%')
	AND t.amount >= 888)
ORDER BY m.code;",,
A0179033E,"SELECT DISTINCT c.ssn
FROM credit_cards c, transactions t
WHERE c.number = t.number
	AND t.datetime::date = '2017-12-25'
	AND c.type = 'visa';",,,"SELECT cus.first_name, cus.last_name
FROM customers cus, credit_cards c
WHERE c.ssn = cus.ssn
	AND cus.country = 'Singapore'
	AND (c.type = 'jcb' OR c.type = 'visa')
GROUP BY c.ssn, cus.first_name, cus.last_name
ORDER BY cus.first_name;",,,"SELECT cus.ssn,COUNT(c.ssn)
FROM customers cus
LEFT OUTER JOIN credit_cards c ON c.ssn=cus.ssn
GROUP BY cus.ssn, c.ssn
ORDER BY c.ssn;",,,"SELECT cus.ssn, c.type, COUNT(*)
FROM customers cus, credit_cards c
WHERE c.ssn=cus.ssn
GROUP BY cus.ssn, c.type
UNION
SELECT cus.ssn, c.type,0
FROM credit_cards c, customers cus
WHERE (cus.ssn,c.type) NOT IN (
	SELECT cus.ssn, c.type
	FROM customers cus, credit_cards c
	WHERE c.ssn=cus.ssn
	GROUP BY cus.ssn, c.type)
GROUP BY cus.ssn, c.type
ORDER BY ssn;",,,"SELECT cus.country, COUNT(*)
FROM customers cus
WHERE cus.ssn IN(
	SELECT cus.ssn
	FROM customers cus, transactions t, merchants m, credit_cards c
	WHERE cus.ssn = c.ssn
		AND c.number = t.number
		AND t.code = m.code
		AND cus.country <> m.country
	GROUP BY cus.ssn,cus.country, m.country)
GROUP BY cus.country;",,,"SELECT t.identifier
FROM transactions t, credit_cards c
WHERE t.number = c.number
	AND (c.type, t.amount) IN(
	SELECT c.type, MAX(t.amount)
	FROM transactions t, credit_cards c
	WHERE t.number = c.number
	GROUP BY c.type)
GROUP BY t.identifier, c.type
ORDER BY t.amount;",,,"SELECT t1.identifier
FROM transactions t1, credit_cards cc1
WHERE t1.number=cc1.number
	AND t1.amount >=ALL(
		SELECT t2.amount
		FROM transactions t2, credit_cards cc2
		WHERE t2.number=cc2.number
			AND cc1.type=cc2.type)
ORDER BY cc1.type;",,,"SELECT DISTINCT m.code, m.name
FROM merchants m
WHERE m.code NOT IN(
	SELECT DISTINCT m.code
	FROM merchants m, transactions t, credit_cards c
	WHERE m.code = t.code
		AND t.number = c.number
		AND (c.type LIKE 'visa%'OR c.type LIKE 'diners-club%')
		AND t.amount >= 888);",,
A0212524U,"SELECT DISTINCT c.ssn 
FROM customers c, transactions t, credit_cards cc
WHERE c.ssn = cc.ssn
  AND cc.number = t.number
  AND date(t.datetime) = '2017-12-25'
  AND cc.type = 'visa';",,,"SELECT c.first_name, c.last_name
FROM customers c
INNER JOIN credit_cards cc1
ON cc1.ssn = c.ssn
INNER JOIN credit_cards cc2
ON cc2.ssn = c.ssn
WHERE cc1.type = 'visa'
  AND cc2.type = 'jcb'
  AND c.country = 'Singapore'
GROUP BY c.ssn;",,,"SELECT c.ssn, count(cc.ssn) AS number_owned
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn
GROUP BY c.ssn
UNION
(SELECT c.ssn, 0 AS number_owned
FROM customers c
EXCEPT
SELECT distinct cc.ssn, 0 AS number_owned
FROM credit_cards cc)
ORDER BY number_owned ASC;",,,"SELECT t2.ssn, t2.type, COALESCE(t3.number_type, 0) AS number_type FROM (
	(SELECT c.ssn, t1.type 
		FROM customers c
		CROSS JOIN (
			SELECT type 
			FROM credit_cards
			GROUP BY type
			) t1) t2
	LEFT JOIN (
		SELECT c2.ssn, cc.type, count(cc.type) AS number_type
		FROM customers c2
		INNER JOIN credit_cards cc
		ON c2.ssn = cc.ssn
		GROUP BY c2.ssn, cc.type
		) t3
	ON t2.ssn = t3.ssn
	AND t2.type = t3.type
  )
ORDER BY t2.ssn, t2.type;",,,"SELECT c.country, count(distinct c.ssn)
FROM customers c
RIGHT JOIN credit_cards cc
ON c.ssn = cc.ssn
RIGHT JOIN transactions t
ON t.number = cc.number
INNER JOIN merchants m
ON m.code = t.code
WHERE c.country != m.country
GROUP BY c.country;",,,"SELECT B.identifier, A.type, A.max_amount
FROM
(SELECT cc.type, MAX(t.amount) as max_amount
FROM transactions t
INNER JOIN credit_cards cc
ON cc.number = t.number
GROUP BY  cc.type) A
LEFT JOIN
(SELECT t.identifier, t.amount, cc.type
FROM transactions t
INNER JOIN credit_cards cc
ON cc.number = t.number) B
ON
A.max_amount = B.amount
WHERE
A.type = B.type
ORDER BY identifier;",,,"SELECT t.identifier,cc.type, t.amount
FROM transactions t
INNER JOIN credit_cards cc
ON cc.number = t.number
WHERE t.amount >= ALL(
	SELECT t2.amount
	FROM transactions t2
	INNER JOIN credit_cards cc2
	ON cc2.number = t2.number
	WHERE cc2.type = cc.type);",,,"SELECT code, name FROM merchants
EXCEPT
SELECT DISTINCT m.code, m.name
FROM merchants m
INNER JOIN transactions t
ON m.code = t.code
INNER JOIN credit_cards cc
ON cc.number = t.number
WHERE t.amount >= 888
  AND (cc.type like '%visa%' OR cc.type like '%diners-club%');",,
A0218816Y,"SELECT DISTINCT cc.ssn
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
AND t.datetime BETWEEN '2017-12-25 00:00:00' AND '2017-12-25 23:59:59'
AND cc.type = 'visa';",,,"SELECT c.first_name, c.last_name
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn
AND c.country = 'Singapore'
AND cc.type = 'visa'
INTERSECT
SELECT c.first_name, c.last_name
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn
AND c.country = 'Singapore'
AND cc.type = 'jcb';",,,"SELECT c.ssn, COUNT(DISTINCT cc.number) AS no_of_cc
FROM customers c
LEFT JOIN credit_cards cc ON cc.ssn = c.ssn
GROUP BY c.ssn;",,,"SELECT c1.ssn, c1.type, COALESCE(c2.count, 0) AS count
FROM (SELECT c.ssn, cc.type
	  FROM customers c, (SELECT DISTINCT cc.type
						 FROM credit_cards cc) AS cc) AS c1 LEFT OUTER JOIN (
							 SELECT c2.ssn, cc2.type, COUNT(DISTINCT cc2.number) AS count
							 FROM customers c2, credit_cards cc2
							 WHERE c2.ssn = cc2.ssn
							 GROUP BY c2.ssn, cc2.type
							 ORDER BY c2.ssn, cc2.type) AS c2
							 ON c1.ssn = c2.ssn
							 AND c1.type = c2.type
ORDER BY ssn, type;",,,"SELECT c.country, COUNT(DISTINCT c.ssn)
FROM customers c, credit_cards cc, transactions t, merchants m
WHERE c.ssn = cc.ssn
AND cc.number = t.number
AND t.code = m.code
AND c.country <> m.country
GROUP BY c.country;",,,"SELECT t.identifier
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
GROUP BY t.identifier, cc.type
HAVING t.amount >= ALL(
	SELECT t.amount
	FROM transactions t, credit_cards cc1
	WHERE cc1.number = t.number
	AND cc1.type = cc.type);",,,"SELECT t.identifier
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
AND t.amount >= ALL(
	SELECT t.amount
	FROM transactions t, credit_cards cc1
	WHERE t.number = cc1.number
	AND cc1.type = cc.type);",,,"SELECT m1.code, m1.name
FROM merchants m1
WHERE m1.code NOT IN (
	SELECT m.code
	FROM merchants m, transactions t, credit_cards cc
	WHERE m.code = t.code
	AND t.number = cc.number
	AND t.amount >= 888
	AND cc.type LIKE '%visa%'
	UNION
	SELECT m.code
	FROM merchants m, transactions t, credit_cards cc
	WHERE m.code = t.code
	AND t.number = cc.number
	AND t.amount >= 888
	AND cc.type LIKE '%diners-club%');",,
A0218820J,"SELECT DISTINCT c.ssn
FROM customers c,credit_cards cc,transactions t
WHERE c.ssn=cc.ssn
AND t.number=cc.number
AND Date(t.datetime)='2017-12-25'
And cc.type='visa'
ORDER BY c.ssn;",,,"SELECT n.first_name, n.last_name
FROM (SELECT DISTINCT c.ssn, c.first_name, c.last_name
FROM customers c,credit_cards cc
WHERE c.ssn=cc.ssn
AND cc.type='jcb'
AND c.country='Singapore'
INTERSECT
SELECT DISTINCT c.ssn, c.first_name, c.last_name
FROM customers c,credit_cards cc
WHERE c.ssn=cc.ssn
AND cc.type='visa'
AND c.country='Singapore') AS n
ORDER BY first_name,last_name;",,,"SELECT c.ssn, COUNT(cc.number)
FROM customers c LEFT JOIN credit_cards cc ON c.ssn=cc.ssn
GROUP BY c.ssn
ORDER BY c.ssn;",,,"SELECT cr_ty.ssn,cr_ty.type, COUNT(cc.number)
FROM (SELECT DISTINCT credit_cards.type,customers.ssn
FROM credit_cards, customers) AS cr_ty LEFT JOIN credit_cards cc
ON (cr_ty.ssn=cc.ssn AND cr_ty.type= cc.type)
GROUP BY cr_ty.ssn,cr_ty.type
ORDER BY cr_ty.ssn,cr_ty.type;",,,"SELECT c.country,COUNT(c.ssn)
FROM customers c, merchants m,transactions t,credit_cards cc
WHERE m.code=t.code
AND t.number=cc.number
AND cc.ssn=c.ssn
AND c.country !=m.country
GROUP BY c.country;",,,"SELECT t.identifier
FROM credit_cards c,transactions t
WHERE c.number=t.number
AND (c.type,t.amount) IN (SELECT c.type,MAX(t.amount) FROM credit_cards c,transactions t
WHERE c.number=t.number GROUP BY c.type);",,,"SELECT t1.identifier
FROM credit_cards c1,transactions t1
WHERE c1.number=t1.number
AND NOT EXISTS(
SELECT *
FROM transactions t2, credit_cards c2
WHERE t2.number = c2.number
AND c1.type = c2.type
AND t1.amount < t2.amount);",,,"SELECT DISTINCT m.code, m.name
FROM merchants m,transactions t,credit_cards cc
WHERE m.code=t.code
AND t.number=cc.number
EXCEPT
SELECT DISTINCT m.code, m.name
FROM merchants m,transactions t,credit_cards cc
WHERE m.code=t.code
AND t.number=cc.number
AND t.amount>=888
AND (cc.type LIKE 'visa%' OR cc.type LIKE 'diners-club%')","Missing semicolon, CHECK CODE.","Missing semicolon, CHECK CODE."
A0218840E,"SELECT DISTINCT cc.ssn
FROM transactions t, credit_cards cc
WHERE cc.type = 'visa'
AND DATE_TRUNC('day', t.datetime) = '2017-12-25';",,,"SELECT c.first_name, c.last_name
FROM customers c
INNER JOIN credit_cards ccv
ON c.ssn = ccv.ssn
INNER JOIN credit_cards ccj
ON c.ssn = ccj.ssn
WHERE c.country = 'Singapore'
AND ccv.type = 'visa'
AND ccj.type = 'jcb'
GROUP BY c.ssn;",,,"SELECT DISTINCT c.ssn, COALESCE(COUNT(cc.number),0) num
FROM customers c
LEFT JOIN credit_cards cc
ON cc.ssn = c.ssn
GROUP BY c.ssn;",,,"SELECT c.ssn, cc.type, SUM(CASE WHEN c.ssn = cc.ssn THEN 1 ELSE 0 END)
FROM credit_cards cc, customers c
GROUP BY c.ssn, cc.type
ORDER BY c.ssn;",,,"SELECT c.country, COUNT(c.ssn)
FROM customers c, merchants m
WHERE c.country <> m.country
GROUP BY c.country;",,,"SELECT cc.type, n.identifier, n.cardmax
FROM credit_cards cc
INNER JOIN (SELECT t.number, t.identifier, MAX(t.amount) cardmax
		   FROM transactions t
		   GROUP BY t.identifier) AS n
ON cc.number = n.number
INNER JOIN (SELECT cc.type, MAX(t.amount) AS maximum
			FROM credit_cards cc
			INNER JOIN transactions t
			ON t.number = cc.number
		   GROUP BY cc.type) AS m
ON m.type = cc.type
AND m.maximum = n.cardmax
GROUP BY cc.type, n.identifier, n.cardmax;",,,"SELECT t1.identifier, t1.amount, cc1.type
FROM transactions t1, credit_cards cc1
WHERE t1.amount >= ALL (SELECT t2.amount
					  FROM transactions t2, credit_cards cc2
					  WHERE t2.number = cc2.number
					   AND cc1.type = cc2.type)
AND t1.number = cc1.number;",,,"SELECT m.code, m.name
FROM merchants m
WHERE m.code NOT IN (
SELECT m.code
FROM transactions t
INNER JOIN merchants m
ON m.code = t.code 
INNER JOIN credit_cards cc
on cc.number = t.number 
WHERE t.amount >= 888
AND (cc.type LIKE 'visa%' OR cc.type LIKE 'diners%'));",,
A0218849M,"SELECT DISTINCT cust.ssn
FROM customers cust, credit_cards cc, transactions t
WHERE cust.ssn = cc.ssn
AND cc.number = t.number
AND cc.type = 'visa'
AND DATE(t.datetime) = '2017-12-25';",,,"SELECT cust.first_name, cust.last_name, cust.ssn
FROM customers cust, credit_cards cc
WHERE cust.ssn = cc.ssn
AND cust.country = 'Singapore'
AND cc.type = 'jcb' 
INTERSECT
SELECT cust.first_name, cust.last_name, cust.ssn
FROM customers cust, credit_cards cc
WHERE cust.ssn = cc.ssn
AND cust.country = 'Singapore'
AND cc.type = 'visa'   
ORDER BY first_name;",,,"SELECT cust.ssn, COALESCE(cc.cc, 0) AS no_of_credit_cards
FROM customers cust LEFT JOIN (
	SELECT DISTINCT ssn, COUNT(*) AS cc
	FROM credit_cards
	GROUP BY ssn) cc
ON cust.ssn = cc.ssn
ORDER BY no_of_credit_cards;",,,"SELECT cu_cc_cj.ssn, cu_cc_cj.type, COALESCE(cust_cc.cc, 0) AS no_of_credit_cards 
FROM
(
	SELECT cu.ssn, cc_cj.type FROM customers cu
	CROSS JOIN
		(SELECT DISTINCT type FROM credit_cards) cc_cj
		) cu_cc_cj
	LEFT JOIN
	(
	SELECT cust.ssn, cc.type, cc.cc
	FROM customers cust LEFT JOIN (
		SELECT DISTINCT ssn, type, COUNT (*) AS cc
		FROM credit_cards
		GROUP BY ssn, type) cc
	ON cust.ssn = cc.ssn
	ORDER BY ssn, type
	) cust_cc
ON cu_cc_cj.ssn = cust_cc.ssn AND cu_cc_cj.type = cust_cc.type
ORDER BY ssn, type;",,,"SELECT cust.country AS country, COUNT(*) AS no_of_country_cust_who_purchased_overseas
FROM customers cust, credit_cards cc, transactions t, merchants m
WHERE cust.ssn = cc.ssn
AND cc.number = t.number
AND t.code = m.code
AND cust.country != m.country
GROUP BY cust.country;",,,"SELECT identifier FROM 
(
	SELECT t.*, cc.type, t_cc_max.type AS t_cc_max_type, t_cc_max.max AS t_cc_max_max FROM transactions t
	INNER JOIN
	credit_cards cc on t.number = cc.number
		LEFT JOIN (
			SELECT type, MAX(amount) AS max from
			(
			SELECT t.*, cc.type
			FROM transactions t INNER JOIN credit_cards cc
			ON t.number = cc.number
			) t_cc
		GROUP BY type
		) t_cc_max
		ON
		t.amount = t_cc_max.max AND
		cc.type = t_cc_max.type
	) final_max
WHERE t_cc_max_max IS NOT NULL AND t_cc_max_type IS NOT NULL
ORDER BY identifier;",,,"(SELECT t.identifier, cc.type, t.amount AS max_amount
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
AND cc.type = 'americanexpress'
ORDER BY amount DESC
LIMIT 1)
UNION
(SELECT t.identifier, cc.type, t.amount
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
AND cc.type = 'bankcard'
ORDER BY amount DESC
LIMIT 1)
UNION
(SELECT t.identifier, cc.type, t.amount
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
AND cc.type = 'china-unionpay'
ORDER BY amount DESC
LIMIT 1)
UNION
(SELECT t.identifier, cc.type, t.amount
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
AND cc.type = 'diners-club-carte-blanche'
ORDER BY amount DESC
LIMIT 1)
UNION
(SELECT t.identifier, cc.type, t.amount
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
AND cc.type = 'diners-club-enroute'
ORDER BY amount DESC
LIMIT 1)
UNION
(SELECT t.identifier, cc.type, t.amount
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
AND cc.type = 'diners-club-international'
ORDER BY amount DESC
LIMIT 1)
UNION
(SELECT t.identifier, cc.type, t.amount
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
AND cc.type = 'diners-club-us-ca'
ORDER BY amount DESC
LIMIT 1)
UNION
(SELECT t.identifier, cc.type, t.amount
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
AND cc.type = 'instapayment'
ORDER BY amount DESC
LIMIT 1)
UNION
(SELECT t.identifier, cc.type, t.amount
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
AND cc.type = 'jcb'
ORDER BY amount DESC
LIMIT 1)
UNION
(SELECT t.identifier, cc.type, t.amount
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
AND cc.type = 'laser'
ORDER BY amount DESC
LIMIT 1)
UNION
(SELECT t.identifier, cc.type, t.amount
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
AND cc.type = 'maestro'
ORDER BY amount DESC
LIMIT 1)
UNION
(SELECT t.identifier, cc.type, t.amount
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
AND cc.type = 'mastercard'
ORDER BY amount DESC
LIMIT 1)
UNION
(SELECT t.identifier, cc.type, t.amount
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
AND cc.type = 'solo'
ORDER BY amount DESC
LIMIT 1)
UNION
(SELECT t.identifier, cc.type, t.amount
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
AND cc.type = 'switch'
ORDER BY amount DESC
LIMIT 1)
UNION
(SELECT t.identifier, cc.type, t.amount
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
AND cc.type = 'diners-club-us-ca'
ORDER BY amount DESC
LIMIT 1)
UNION
(SELECT t.identifier, cc.type, t.amount
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
AND cc.type = 'visa'
ORDER BY amount DESC
LIMIT 1)
UNION
(SELECT t.identifier, cc.type, t.amount
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
AND cc.type = 'visa-electron'
ORDER BY amount DESC
LIMIT 1)
ORDER BY identifier;",,,"SELECT m.code, m.name
FROM merchants m
EXCEPT 
SELECT DISTINCT m.code, m.name
FROM transactions t, credit_cards cc, merchants m
WHERE t.number = cc.number
AND m.code = t.code
AND (cc.type LIKE 'diners-club%'
OR cc.type LIKE 'visa%')
AND t.amount >888;",,
A0218855U,"SELECT DISTINCT card.ssn
FROM customers c, credit_cards card, transactions t
WHERE c.ssn = card.ssn
  AND card.number = t.number
  AND t.datetime BETWEEN '2017-12-25 00:00:00' AND '2017-12-25 23:59:59'
  AND card.type = 'visa'
ORDER BY card.ssn;",,,"SELECT c.first_name, c.last_name
FROM customers c LEFT JOIN credit_cards card on c.ssn = card.ssn
WHERE c.country = 'Singapore' 
  AND card.type IN ('jcb','visa')
GROUP BY c.ssn
HAVING COUNT(DISTINCT card.type) = 2;",,,"SELECT c.ssn, COALESCE(count(type), 0) AS no_of_cards
FROM customers c LEFT JOIN credit_cards card on c.ssn = card.ssn
GROUP BY c.ssn
ORDER BY no_of_cards;",,,"SELECT c.ssn, card.type, COALESCE(COUNT(NUMBER),0) AS no_of_cards
FROM customers c LEFT JOIN credit_cards card ON c.ssn = card.ssn
GROUP BY c.ssn, card.type
ORDER BY c.ssn;",,,"SELECT  c.country, count (distinct c.ssn)
FROM customers c, credit_cards card, transactions t, merchants m
WHERE c.ssn = card.ssn
  AND card.number = t.number
  AND t.code = m.code 
  AND c.country <> m.country
GROUP BY c.country
ORDER BY count DESC;",,,"SELECT t.identifier, card.type, t.amount 
FROM    
	(SELECT card1.type card_type, max(t1.amount) AS max_amount
	FROM transactions t1 JOIN credit_cards card1 ON card1.number = t1.number
	GROUP BY card1.type) AS t1,
	transactions t,
	credit_cards card
WHERE t.number = card.number
  AND card.type = t1.card_type
  AND t.amount = t1.max_amount;",,,"SELECT  t.identifier, card.type, t.amount
FROM transactions t, credit_cards card
WHERE t.number = card.number
  AND t.amount >= ALL(
  SELECT t1.amount
  FROM transactions t1, credit_cards card1
  WHERE t1.number = card1.number
    AND card.type = card1.type);",,,"SELECT m.code, m.name
FROM merchants m
WHERE (m.code, m.name) NOT IN(
  SELECT m1.code, m1.name
  FROM merchants m1, transactions t1, credit_cards card
  WHERE m1.code = t1.code
    AND t1.number = card.number
    AND t1.amount >= 888
    AND (card.type LIKE 'visa%' OR card.type LIKE 'diners-club%'));",,
A0218865R,"select distinct ssn from transactions tx
left join credit_cards cc on cc.number=tx.number
where date(datetime)='2017-12-25'
and type = 'visa';",,,"select first_name, last_name from customers c
where ssn in (((select cc.ssn from credit_cards cc where type = 'jcb') 
 intersect (select cc.ssn from credit_cards cc where type = 'visa')))
and country = 'Singapore';",,,"select c.ssn, case when num_cc is null then 0 else num_cc end as num_cc  
from customers c
left join (select ssn, count(distinct number) as num_cc 
		   from credit_cards
		   group by ssn) cc on cc.ssn = c.ssn;",,,"select total.ssn, total.type,
case when num_type_cc is null then 0 else num_type_cc end as num_type_cc
from (select distinct cust.ssn, cc.type
from customers cust, credit_cards cc) total
left join (select ssn, type, count(distinct number) as num_type_cc 
		   from credit_cards
		   group by ssn,type) a on total.type = a.type and total.ssn = a.ssn 
		   order by total.ssn;",,,"select cust_country, count(distinct ssn) as num_customers from (
select c.ssn, c.country as cust_country, tx.number, m.code, m.country as merchant_country,
case when c.country != m.country then 1 else 0 end as is_different_country
from customers c, credit_cards cc, transactions tx, merchants m
where cc.ssn= c.ssn
and tx.number = cc.number
and m.code = tx.code
) A where is_different_country =1
group by cust_country;",,,"select identifier from (
select type, max(amount) as largest_amt 
from transactions tx, credit_cards cc
where tx.number=cc.number group by type) agg
inner join (
select identifier, tx.number, amount, cc.type 
from transactions tx, credit_cards cc
where cc.number = tx.number) B on B.amount = largest_amt and B.type = agg.type;",,,"select tx.identifier from transactions tx, credit_cards cc
where tx.number=cc.number
and tx.amount>=ALL(select amount from transactions tx2, credit_cards cc2
				  where tx2.number=cc2.number and cc2.type=cc.type);",,,"select code, name from merchants
where code not in (
select m.code
from merchants m, transactions tx, credit_cards cc
where m.code = tx.code
and cc.number = tx.number
and amount>=888 and (type like '%visa%' or type like '%diners-club%'));",,
A0218871X,"SELECT c.ssn
FROM credit_cards c,transactions t
WHERE c.number = t.number
AND c.type = 'visa'
AND DATE(t.datetime) = '2017-12-25'
;",,,"SELECT c.first_name, c.last_name
FROM customers c, credit_cards cc1, credit_cards cc2
WHERE c.country = 'Singapore'
AND (c.ssn = cc1.ssn AND cc1.type = 'visa')
AND (c.ssn = cc2.ssn AND cc2.type = 'jcb')
;",,,"SELECT c.ssn, COUNT(cc.number)
FROM credit_cards cc RIGHT JOIN customers c ON cc.ssn = c.ssn
GROUP BY c.ssn
;",,,"DROP VIEW IF EXISTS temp_c;
DROP VIEW IF EXISTS cc_type;
CREATE VIEW cc_type AS
SELECT DISTINCT type from credit_cards;
CREATE VIEW temp_c AS
SELECT * FROM customers,cc_type;
SELECT c.ssn,c.type,COUNT(cc.ssn)
FROM temp_c c LEFT JOIN credit_cards cc ON (c.ssn = cc.ssn AND c.type = cc.type)
GROUP BY c.ssn,c.type
ORDER BY c.ssn,c.type ASC
;",,,"SELECT c.country , COUNT(*)
FROM customers c
WHERE EXISTS
(SELECT DISTINCT c.ssn
FROM merchants m,transactions t, credit_cards cc
WHERE c.ssn = cc.ssn AND t.number = cc.number AND t.code = m.code
AND c.country <> m.country)
GROUP BY c.country
;",,,"DROP VIEW IF EXISTS amount_1;
CREATE VIEW amount_1 AS
SELECT cc.type,MAX(t.amount)
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
GROUP BY cc.type
;
SELECT t.identifier , cc.type, t.amount
FROM credit_cards cc, transactions t, amount_1 amt
WHERE t.number = cc.number AND cc.type = amt.type AND t.amount = amt.max
;",,,"SELECT DISTINCT type FROM credit_cards;
* By using distinct, we are able to know there are 16 types of credit cards in table credit cards.
""diners-club-us-ca""
""instapayment""
""china-unionpay""
""bankcard""
""diners-club-carte-blanche""
""visa""
""diners-club-international""
""laser""
""americanexpress""
""maestro""
""solo""
""switch""
""jcb""
""visa-electron""
""diners-club-enroute""
""mastercard""
Then, we will be able to get the identifier of the transaction with largest amount using '>= ALL' with a subquery for each type of credit card
and connect them altogether using UNION.
*/
SELECT cc.type,t.identifier,t.amount FROM credit_cards cc, transactions t
WHERE cc.number = t.number AND cc.type ='diners-club-us-ca'
AND t.amount >= ALL (SELECT t.amount from credit_cards cc,transactions t WHERE cc.number = t.number AND cc.type = 'diners-club-us-ca')
UNION
SELECT cc.type,t.identifier,t.amount FROM credit_cards cc, transactions t
WHERE cc.number = t.number AND cc.type ='instapayment'
AND t.amount >= ALL (SELECT t.amount from credit_cards cc,transactions t WHERE cc.number = t.number AND cc.type = 'instapayment')
UNION
SELECT cc.type,t.identifier,t.amount FROM credit_cards cc, transactions t
WHERE cc.number = t.number AND cc.type ='china-unionpay'
AND t.amount >= ALL (SELECT t.amount from credit_cards cc,transactions t WHERE cc.number = t.number AND cc.type = 'china-unionpay')
UNION
SELECT cc.type,t.identifier,t.amount FROM credit_cards cc, transactions t
WHERE cc.number = t.number AND cc.type ='bankcard'
AND t.amount >= ALL (SELECT t.amount from credit_cards cc,transactions t WHERE cc.number = t.number AND cc.type = 'bankcard')
UNION
SELECT cc.type,t.identifier,t.amount FROM credit_cards cc, transactions t
WHERE cc.number = t.number AND cc.type ='diners-club-carte-blanche'
AND t.amount >= ALL (SELECT t.amount from credit_cards cc,transactions t WHERE cc.number = t.number AND cc.type = 'diners-club-carte-blanche')
UNION
SELECT cc.type,t.identifier,t.amount FROM credit_cards cc, transactions t
WHERE cc.number = t.number AND cc.type ='visa'
AND t.amount >= ALL (SELECT t.amount from credit_cards cc,transactions t WHERE cc.number = t.number AND cc.type = 'visa')
UNION
SELECT cc.type,t.identifier,t.amount FROM credit_cards cc, transactions t
WHERE cc.number = t.number AND cc.type ='diners-club-international'
AND t.amount >= ALL (SELECT t.amount from credit_cards cc,transactions t WHERE cc.number = t.number AND cc.type = 'diners-club-international')
UNION
SELECT cc.type,t.identifier,t.amount FROM credit_cards cc, transactions t
WHERE cc.number = t.number AND cc.type ='laser'
AND t.amount >= ALL (SELECT t.amount from credit_cards cc,transactions t WHERE cc.number = t.number AND cc.type = 'laser')
UNION
SELECT cc.type,t.identifier,t.amount FROM credit_cards cc, transactions t
WHERE cc.number = t.number AND cc.type ='americanexpress'
AND t.amount >= ALL (SELECT t.amount from credit_cards cc,transactions t WHERE cc.number = t.number AND cc.type = 'americanexpress')
UNION
SELECT cc.type,t.identifier,t.amount FROM credit_cards cc, transactions t
WHERE cc.number = t.number AND cc.type ='maestro'
AND t.amount >= ALL (SELECT t.amount from credit_cards cc,transactions t WHERE cc.number = t.number AND cc.type = 'maestro')
UNION
SELECT cc.type,t.identifier,t.amount FROM credit_cards cc, transactions t
WHERE cc.number = t.number AND cc.type ='solo'
AND t.amount >= ALL (SELECT t.amount from credit_cards cc,transactions t WHERE cc.number = t.number AND cc.type = 'solo')
UNION
SELECT cc.type,t.identifier,t.amount FROM credit_cards cc, transactions t
WHERE cc.number = t.number AND cc.type ='switch'
AND t.amount >= ALL (SELECT t.amount from credit_cards cc,transactions t WHERE cc.number = t.number AND cc.type = 'switch')
UNION
SELECT cc.type,t.identifier,t.amount FROM credit_cards cc, transactions t
WHERE cc.number = t.number AND cc.type ='jcb'
AND t.amount >= ALL (SELECT t.amount from credit_cards cc,transactions t WHERE cc.number = t.number AND cc.type = 'jcb')
UNION
SELECT cc.type,t.identifier,t.amount FROM credit_cards cc, transactions t
WHERE cc.number = t.number AND cc.type ='visa-electron'
AND t.amount >= ALL (SELECT t.amount from credit_cards cc,transactions t WHERE cc.number = t.number AND cc.type = 'visa-electron')
UNION
SELECT cc.type,t.identifier,t.amount FROM credit_cards cc, transactions t
WHERE cc.number = t.number AND cc.type ='diners-club-enroute'
AND t.amount >= ALL (SELECT t.amount from credit_cards cc,transactions t WHERE cc.number = t.number AND cc.type = 'diners-club-enroute')
UNION
SELECT cc.type,t.identifier,t.amount FROM credit_cards cc, transactions t
WHERE cc.number = t.number AND cc.type ='mastercard'
AND t.amount >= ALL (SELECT t.amount from credit_cards cc,transactions t WHERE cc.number = t.number AND cc.type = 'mastercard')
;",,,"SELECT *
FROM merchants m
WHERE NOT EXISTS (SELECT m.code
FROM transactions t,  credit_cards cc
WHERE t.number = cc.number AND t.code = m.code
AND t.amount >= 888
AND (cc.type LIKE '%visa%' OR cc.type LIKE '%diners-club%'))
;
*
""50-9541874""	""Bartoletti-Wilderman""	""Indonesia""
""37-2421122""	""Torp-Vandervort""	""Indonesia""
""44-3387143""	""Flatley Inc""	""Thailand""
""47-0770742""	""Bartoletti and Sons""	""Indonesia""
""57-6774544""	""Olson, Corwin and Emard""	""Singapore""
""44-6155344""	""Bernhard and Sons""	""Singapore""
""87-5899014""	""Nicolas, Olson and Krajcik""	""Singapore""
 */",,
A0218875N,"SELECT DISTINCT c.ssn
FROM customers c, credit_cards cc, transactions t
WHERE c.ssn = cc.ssn
AND cc.number = t.number
AND cc.type = 'visa'
AND t.datetime:: date = '2017-12-25'
ORDER BY c.ssn;",,,"WITH Visa AS (
SELECT DISTINCT c.ssn, c.first_name, c.last_name, c.country, cc.type
FROM customers c, credit_cards cc
WHERE c.country = 'Singapore'
AND c.ssn = cc.ssn
AND cc.type = 'visa'
ORDER BY c.first_name),
Jcb AS(
SELECT DISTINCT c.ssn, c.first_name, c.last_name, c.country, cc.type
FROM customers c, credit_cards cc
WHERE c.country = 'Singapore'
AND c.ssn = cc.ssn
AND cc.type = 'jcb'
ORDER BY c.first_name)
SELECT v.ssn, v.type as creditcard1, j.type as creditcard2, v.first_name, v.last_name, v.country
FROM Visa v, Jcb j
WHERE v.ssn = j.ssn
Order by v.first_name;",,,"SELECT c.ssn, count(cc.type)
FROM customers c
LEFT OUTER JOIN credit_cards cc
ON c.ssn = cc.ssn
GROUP BY c.ssn
ORDER BY COUNT;",,,"SELECT c.ssn, cc.type, count(cc.type)
FROM customers c
LEFT OUTER JOIN credit_cards cc
ON c.ssn = cc.ssn
GROUP BY c.ssn, cc.type
ORDER BY c.ssn;",,,"SELECT c.country, count(DISTINCT c.ssn)
FROM customers c, credit_cards cc, transactions t, merchants m
WHERE cc.number = t.number
AND cc.ssn = c.ssn
AND t.code = m.code
AND c.country != m.country
GROUP BY c.country
ORDER BY count DESC;",,,"SELECT cc2.type, t2.amount, t2.identifier
FROM transactions t2, credit_cards cc2
WHERE t2.number = cc2.number 
AND (cc2.type, t2.amount) = ANY
(SELECT  cc.type, max(t.amount) as max_amt
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
GROUP BY cc.type
ORDER BY max_amt DESC)
ORDER BY cc2.type;",,,"SELECT cc1.type, t1.amount, t1.identifier
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number
AND (cc1.type, t1.amount) = ANY (SELECT cc.type, t.amount
	FROM transactions t, credit_cards cc
	WHERE t.number = cc.number
	AND cc.type = 'americanexpress'
	ORDER BY t.amount DESC
	LIMIT 1)
UNION 
SELECT cc1.type, t1.amount, t1.identifier 
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number
AND (cc1.type, t1.amount) = ANY (SELECT cc.type, t.amount
	FROM transactions t, credit_cards cc 
	WHERE t.number = cc.number 
	AND cc.type = 'bankcard' 
	ORDER BY t.amount DESC LIMIT 1)  
UNION
SELECT cc1.type, t1.amount, t1.identifier 
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number
AND (cc1.type, t1.amount) = ANY (SELECT cc.type, t.amount
	FROM transactions t, credit_cards cc 
	WHERE t.number = cc.number 
	AND cc.type = 'china-unionpay' 
	ORDER BY t.amount DESC LIMIT 1)  
UNION
SELECT cc1.type, t1.amount, t1.identifier 
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number
AND (cc1.type, t1.amount) = ANY (SELECT cc.type, t.amount
	FROM transactions t, credit_cards cc 
	WHERE t.number = cc.number 
	AND cc.type = 'diners-club-carte-blanche' 
	ORDER BY t.amount DESC LIMIT 1)  
UNION
SELECT cc1.type, t1.amount, t1.identifier 
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number
AND (cc1.type, t1.amount) = ANY (SELECT cc.type, t.amount
	FROM transactions t, credit_cards cc 
	WHERE t.number = cc.number 
	AND cc.type = 'diners-club-enroute' 
	ORDER BY t.amount DESC LIMIT 1)  
UNION
SELECT cc1.type, t1.amount, t1.identifier 
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number
AND (cc1.type, t1.amount) = ANY (SELECT cc.type, t.amount
	FROM transactions t, credit_cards cc 
	WHERE t.number = cc.number 
	AND cc.type = 'diners-club-international' 
	ORDER BY t.amount DESC LIMIT 1)  
UNION
SELECT cc1.type, t1.amount, t1.identifier 
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number
AND (cc1.type, t1.amount) = ANY (SELECT cc.type, t.amount
	FROM transactions t, credit_cards cc 
	WHERE t.number = cc.number 
	AND cc.type = 'diners-club-us-ca' 
	ORDER BY t.amount DESC LIMIT 1)  
UNION
SELECT cc1.type, t1.amount, t1.identifier 
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number
AND (cc1.type, t1.amount) = ANY (SELECT cc.type, t.amount
	FROM transactions t, credit_cards cc 
	WHERE t.number = cc.number 
	AND cc.type = 'instapayment' 
	ORDER BY t.amount DESC LIMIT 1)  
UNION
SELECT cc1.type, t1.amount, t1.identifier 
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number
AND (cc1.type, t1.amount) = ANY (SELECT cc.type, t.amount
	FROM transactions t, credit_cards cc 
	WHERE t.number = cc.number 
	AND cc.type = 'jcb' 
	ORDER BY t.amount DESC LIMIT 1)  
UNION
SELECT cc1.type, t1.amount, t1.identifier 
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number
AND (cc1.type, t1.amount) = ANY (SELECT cc.type, t.amount
	FROM transactions t, credit_cards cc 
	WHERE t.number = cc.number 
	AND cc.type = 'laser' 
	ORDER BY t.amount DESC LIMIT 1)  
UNION
SELECT cc1.type, t1.amount, t1.identifier 
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number
AND (cc1.type, t1.amount) = ANY (SELECT cc.type, t.amount
	FROM transactions t, credit_cards cc 
	WHERE t.number = cc.number 
	AND cc.type = 'maestro' 
	ORDER BY t.amount DESC LIMIT 1)  
UNION
SELECT cc1.type, t1.amount, t1.identifier 
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number
AND (cc1.type, t1.amount) = ANY (SELECT cc.type, t.amount
	FROM transactions t, credit_cards cc 
	WHERE t.number = cc.number 
	AND cc.type = 'mastercard' 
	ORDER BY t.amount DESC LIMIT 1)  
UNION
SELECT cc1.type, t1.amount, t1.identifier 
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number
AND (cc1.type, t1.amount) = ANY (SELECT cc.type, t.amount
	FROM transactions t, credit_cards cc 
	WHERE t.number = cc.number 
	AND cc.type = 'solo' 
	ORDER BY t.amount DESC LIMIT 1)  
UNION
SELECT cc1.type, t1.amount, t1.identifier 
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number
AND (cc1.type, t1.amount) = ANY (SELECT cc.type, t.amount
	FROM transactions t, credit_cards cc 
	WHERE t.number = cc.number 
	AND cc.type = 'switch' 
	ORDER BY t.amount DESC LIMIT 1)  
UNION
SELECT cc1.type, t1.amount, t1.identifier 
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number
AND (cc1.type, t1.amount) = ANY (SELECT cc.type, t.amount
	FROM transactions t, credit_cards cc 
	WHERE t.number = cc.number 
	AND cc.type = 'visa' 
	ORDER BY t.amount DESC LIMIT 1)  
UNION
SELECT cc1.type, t1.amount, t1.identifier 
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number
AND (cc1.type, t1.amount) = ANY (SELECT cc.type, t.amount
	FROM transactions t, credit_cards cc 
	WHERE t.number = cc.number 
	AND cc.type = 'visa-electron' 
	ORDER BY t.amount DESC LIMIT 1);",,,"SELECT m.code, m.name
FROM  merchants m
WHERE m.code NOT IN ( WITH h999 AS( WITH h888 AS
(SELECT *
FROM transactions t, credit_cards as cc
WHERE t.amount >= 888
AND t.number = cc.number
GROUP by cc.type, t.identifier, cc.ssn, cc.number
ORDER BY cc.type)
SELECT DISTINCT code, type
FROM h888
WHERE type like '%visa%' OR type like '%diners-club%'
ORDER BY code)
SELECT DISTINCT code
FROM H999)
ORDER BY m.code;",,
A0218877L,"SELECT DISTINCT CC.SSN
FROM CREDIT_CARDS CC LEFT JOIN TRANSACTIONS T
ON CC.NUMBER = T.NUMBER 
WHERE CC.TYPE = 'visa' AND DATE(T.DATETIME) = '2017-12-25';",,,"SELECT CUST.FIRST_NAME, CUST.LAST_NAME 
FROM CUSTOMERS CUST INNER JOIN (
	SELECT DISTINCT CCJCB.SSN 
	FROM CREDIT_CARDS CCJCB INNER JOIN (
	SELECT DISTINCT SSN FROM CREDIT_CARDS WHERE TYPE = 'visa') CCVISA
	ON CCJCB.SSN = CCVISA.SSN WHERE CCJCB.TYPE = 'jcb') CC 
ON CUST.SSN = CC.SSN
WHERE COUNTRY = 'Singapore';",,,"SELECT CUST.SSN, COALESCE(CC.CC, 0) AS NO_OF_CREDIT_CARDS 
FROM CUSTOMERS CUST LEFT JOIN (
	SELECT DISTINCT SSN, COUNT (*) AS CC 
	FROM CREDIT_CARDS 
	GROUP BY SSN) CC
ON CUST.SSN = CC.SSN
ORDER BY NO_OF_CREDIT_CARDS, SSN;",,,"SELECT CU_CC_CJ.SSN, CU_CC_CJ.TYPE, COALESCE(CUST_CC.CC, 0) AS NO_OF_CREDIT_CARDS FROM
(
SELECT CU.SSN, CC_CJ.TYPE FROM CUSTOMERS CU
CROSS JOIN 
) CU_CC_CJ
LEFT JOIN 
SELECT CUST.SSN, CC.TYPE, CC.CC
FROM CUSTOMERS CUST LEFT JOIN (
	SELECT DISTINCT TYPE, SSN, COUNT (*) AS CC 
	FROM CREDIT_CARDS 
	GROUP BY SSN, TYPE) CC
ON CUST.SSN = CC.SSN
ORDER BY SSN, TYPE
) CUST_CC
ON CU_CC_CJ.SSN = CUST_CC.SSN AND CU_CC_CJ.TYPE = CUST_CC.TYPE
ORDER BY SSN, TYPE;",,,"SELECT CUST_COUNTRY AS COUNTRY, COUNT(*) AS NO_OF_COUNTRY_CUST_WHO_PURCHASED_OVERSEAS FROM
(
SELECT DISTINCT SSN, CUST_COUNTRY FROM 
(
SELECT CUST.SSN, CUST.COUNTRY AS CUST_COUNTRY, CCTM.COUNTRY AS CCTM_COUNTRY 
FROM CUSTOMERS CUST INNER JOIN
	(
	SELECT CC.SSN, CC.NUMBER, TM.COUNTRY 
	FROM CREDIT_CARDS CC INNER JOIN 
		(
		SELECT T.NUMBER, T.CODE, M.COUNTRY 
		FROM TRANSACTIONS T INNER JOIN MERCHANTS M 
		ON T.CODE = M.CODE
	ON CC.NUMBER = TM.NUMBER
ON CUST.SSN = CCTM.SSN
WHERE CUST_COUNTRY <> CCTM_COUNTRY
GROUP BY CUST_COUNTRY
ORDER BY CUST_COUNTRY;",,,"SELECT IDENTIFIER FROM  
(
SELECT T.*, CC.TYPE, T_CC_MAX.TYPE AS T_CC_MAX_TYPE, T_CC_MAX.MAX AS T_CC_MAX_MAX FROM TRANSACTIONS T 
INNER JOIN 
CREDIT_CARDS CC ON T.NUMBER = CC.NUMBER
LEFT JOIN (
SELECT TYPE, MAX(AMOUNT) AS MAX FROM
	(
	SELECT T.*, CC.TYPE
	FROM TRANSACTIONS T INNER JOIN CREDIT_CARDS CC
	ON T.NUMBER = CC.NUMBER
	) T_CC
GROUP BY TYPE
) T_CC_MAX
ON 
T.AMOUNT = T_CC_MAX.MAX AND 
CC.TYPE = T_CC_MAX.TYPE
) FINAL_MAX
WHERE T_CC_MAX_MAX IS NOT NULL AND T_CC_MAX_TYPE IS NOT NULL
ORDER BY IDENTIFIER;",,,"SELECT IDENTIFIER FROM 
(
SELECT T.*, CC.TYPE , ROW_NUMBER() OVER (PARTITION BY TYPE ORDER BY AMOUNT DESC) AS CCTYPE_RANK 
FROM TRANSACTIONS T INNER JOIN CREDIT_CARDS CC
ON T.NUMBER = CC.NUMBER
) RANK
WHERE CCTYPE_RANK = 1
ORDER BY IDENTIFIER;",,,"SELECT DISTINCT CODE, NAME FROM 
(
SELECT CODE, NAME, MAX(F_OTHERS) AS F2_OTHERS, MAX(F_VISA) AS F2_VISA, MAX(F_DINERSCLUB) AS F2_DINERSCLUB
FROM
SELECT CODE, NAME,
CASE WHEN TYPE_DER = 'OTHERS' AND MAX_AMOUNT >= 888 THEN 1 ELSE 0 END AS F_OTHERS,
CASE WHEN TYPE_DER = 'VISA' AND MAX_AMOUNT >= 888 THEN 1 ELSE 0 END AS F_VISA,
CASE WHEN TYPE_DER = 'DINERS-CLUB' AND MAX_AMOUNT >= 888 THEN 1 ELSE 0 END AS F_DINERSCLUB
FROM
SELECT T.CODE, M.NAME, CC_DER.TYPE_DER, MAX(T.AMOUNT) AS MAX_AMOUNT FROM TRANSACTIONS T
INNER JOIN
SELECT *, 
CASE
	WHEN TYPE LIKE ('%visa%') THEN 'VISA'
	WHEN TYPE LIKE ('%diners-club%') THEN 'DINERS-CLUB'
	ELSE 'OTHERS'
END AS TYPE_DER
FROM CREDIT_CARDS
) CC_DER
ON T.NUMBER = CC_DER.NUMBER
INNER JOIN MERCHANTS M
ON T.CODE = M.CODE 
GROUP BY T.CODE, M.NAME, CC_DER.TYPE_DER
ORDER BY NAME, MAX_AMOUNT DESC
) T_M_CC_DER
) T_M_CC_DER_FLAG
GROUP BY CODE, NAME
ORDER BY NAME
) T_M_CC_DER_FLAG2
WHERE F2_OTHERS = 1 AND F2_VISA = 0 AND F2_DINERSCLUB = 0
ORDER BY NAME;",,
A0218897H,"select distinct c.ssn from transactions t 
left join credit_cards c on t.number = c.number
where t.datetime >= '2017-12-25 00:00:00' and t.datetime < '2017-12-26 00:00:00'
and c.type = 'visa';",,,"select first_name, last_name from customers c1
where c1.ssn in (select c2.ssn from credit_cards c2 where c2.type = 'jcb'
				or c2.type = 'visa' group by c2.ssn having 
				 count(concat(c2.ssn, c2.type)) >= 2)
order by first_name;",,,"select c1.ssn, count(c2.number) as n_cards from customers c1
left join credit_cards c2 on c1.ssn = c2.ssn
group by c1.ssn
order by n_cards asc;",,,"select A.ssn, A.type, count(B.type) from
(select c1.ssn, c2.type
from customers c1, (select distinct type from credit_cards) c2)A
left join credit_cards B on A.ssn = B.ssn and A.type = B.type
group by A.ssn, A.type
order by A.ssn, A.type;",,,"select c2.country, count(distinct c2.ssn) from transactions t
left join merchants m on t.code = m.code
left join credit_cards c1 on t.number = c1.number
left join customers c2 on c1.ssn =c2.ssn
where m.country <> c2.country
group by c2.country;",,,"select B.identifier from
(select c.type, max(amount) as num from transactions t
left join credit_cards c on t.number = c.number
group by c.type) A
left join
(select c.type, t.identifier, t.amount from transactions t
left join credit_cards c on t.number = c.number) B 
on A.type = B.type and A.num = B.amount;",,,"select t.identifier from transactions t
left join credit_cards c on t.number = c.number
where t.amount >= ALL(
	select t1.amount from transactions t1
	left join credit_cards c1 on t1.number = c1.number
	where c.type = c1.type);",,,"select code, name from merchants 
where code not in 
	(select t.code from transactions t left join credit_cards c
	on t.number = c.number where t.amount >= 888
	and
	('visa' ~ c.type or 'diners-club' ~ c.type));",,
A0218915Y,"SELECT DISTINCT c.ssn
	FROM customers c, credit_cards cc, transactions t
	WHERE cc.ssn = c.ssn
		AND t.number = cc.number
		AND DATE(t.datetime) = '2017-12-25'
		AND cc.type = 'visa'
;",,,"SELECT c1.first_name, c1.last_name
	FROM customers c1, customers c2,credit_cards cc1,credit_cards cc2
	WHERE cc1.ssn = c1.ssn
		AND cc2.ssn = c2.ssn
		AND cc1.type = 'jcb' 
		AND cc2.type = 'visa'
		AND c1.country = 'Singapore'
		AND c1.ssn = c2.ssn
	GROUP BY c1.ssn, c1.first_name, c1.last_name
	ORDER BY c1.first_name, c1.last_name
;",,,"SELECT c.ssn,
		CASE WHEN COUNT(cc.number) ISNULL THEN 0
		ELSE COUNT(cc.number) END
	FROM customers c LEFT OUTER JOIN credit_cards cc ON c.ssn = cc.ssn
	GROUP BY c.ssn
	ORDER BY COUNT (cc.number) ASC
;",,,"SELECT a.ssn, a.type,
	CASE WHEN b.count ISNULL THEN 0
	ELSE b.count END
	FROM (
		SELECT c.ssn, cc.type
			FROM customers c, credit_cards cc
			GROUP BY c.ssn, cc.type
			ORDER BY c.ssn) a
		LEFT OUTER JOIN
		(SELECT c.ssn, cc.type,COUNT(cc.number)
			FROM customers c, credit_cards cc
			WHERE c.ssn=cc.ssn
			GROUP BY c.ssn, cc.type) b
		ON a.ssn=b.ssn AND a.type = b.type
;",,,"SELECT c.country, COUNT(DISTINCT c.ssn) 
	FROM customers c, credit_cards cc, merchants m, transactions t
	WHERE c.country <> m.country
		AND c.ssn = cc.ssn
		AND cc.number = t.number
		AND m.code = t.code
	GROUP BY c.country
;",,,"SELECT t1.identifier
	FROM credit_cards cc1, transactions t1
	WHERE cc1.number = t1.number
		AND (cc1.type, t1.amount) IN
			(SELECT cc2.type, MAX(t2.amount)
				FROM credit_cards cc2, transactions t2
				WHERE cc2.number = t2.number
			GROUP BY cc2.type)
;",,,"SELECT t1.identifier
	FROM credit_cards cc1, transactions t1
	WHERE cc1.number = t1.number
		AND t1.amount >= ALL(
	SELECT t2.amount
		FROM credit_cards cc2, transactions t2
		WHERE cc2.number = t2.number
			AND cc2.type = cc1.type)
;",,,"SELECT DISTINCT m.code, m.name
	FROM merchants m, credit_cards cc
	WHERE NOT EXISTS (
		SELECT *
			FROM merchants m1, transactions t1, credit_cards cc1
			WHERE m1.code = t1.code
				AND t1.number = cc1.number
				AND t1.code = m.code
				AND t1.amount >=888
				AND cc1.type IN 
					(SELECT DISTINCT cc2.type 
						FROM credit_cards cc2
						WHERE cc2.type LIKE 'visa%'
							OR cc2.type LIKE 'diners-club%'))
;",,
A0218923B,"SELECT c.ssn 
FROM credit_cards c, transactions t
WHERE t.number = c.number
AND cast(""datetime"" as date)  = '2017-12-25'
AND c.type = 'visa';",,,"SELECT cu.first_name, cu.last_name
FROM credit_cards c, customers cu
WHERE c.ssn = cu.ssn 
AND cu.country = 'Singapore'
AND c.type = 'jcb' 
AND c.ssn IN (SELECT DISTINCT crd.ssn
	FROM credit_cards crd
	WHERE crd.type='visa');",,,"SELECT c.ssn, count(cr.number) FROM customers c
LEFT JOIN credit_cards cr
ON c.ssn = cr.ssn
GROUP BY c.ssn;",,,"SELECT c.ssn, cr.type, count(cr.number) FROM customers c
LEFT JOIN credit_cards cr
ON c.ssn = cr.ssn
GROUP BY c.ssn, cr.type;",,,"SELECT cu.country, count(cu.ssn)
FROM customers cu 
JOIN credit_cards cr ON cu.ssn = cr.ssn
JOIN transactions t ON cr.number=t.number
JOIN merchants m ON t.code = m.code
WHERE cu.country != m.country
GROUP BY cu.country;",,,"SELECT tr.identifier, tr.amount, cre.type
FROM transactions tr, credit_cards cre, 
    (SELECT cr.type, MAX(t.amount) as max_amount
    FROM transactions t 
    JOIN credit_cards cr ON t.number = cr.number
    GROUP BY cr.type) Z
WHERE tr.number = cre.number AND concat(tr.amount, cre.type) IN (concat(Z.max_amount, Z.type));",,,"SELECT t1.identifier, cr1.type, t1.amount 
FROM transactions t1, credit_cards cr1
WHERE t1.number = cr1.number 
AND t1.amount >= ALL 
(SELECT t2.amount 
FROM transactions t2, credit_cards cr2
WHERE t2.number = cr2.number
AND cr2.type = cr1.type);",,,"SELECT me.code, me.name 
FROM merchants me
WHERE me.code NOT IN (
	SELECT m.code
	FROM merchants m
	LEFT JOIN transactions t ON m.code = t.code
	LEFT JOIN credit_cards cr ON t.number = cr.number
	WHERE t.amount>=888 
	AND (cr.type LIKE '%visa%' OR cr.type LIKE '%diners-club%')
);",,
A0218929N,"SELECT DISTINCT c.ssn
FROM 
	customers c, 
	credit_cards cc, 
	transactions t
WHERE
	c.ssn = cc.ssn 
	AND cc.number = t.number
	AND t.datetime >= '2017-12-25'
	AND t.datetime < '2017-12-26'
	AND cc.type = 'visa';",,,"SELECT c.first_name, c.last_name
FROM credit_cards cc1, credit_cards cc2, customers c
WHERE 
	cc1.type = 'visa'
	AND cc2.type = 'jcb'
	AND cc1.ssn = cc2.ssn
	AND c.ssn = cc1.ssn
	AND c.ssn = cc2.ssn
	AND c.country = 'Singapore'
GROUP BY c.ssn, c.first_name, c.last_name
ORDER BY c.first_name, c.last_name;",,,"SELECT c.ssn, COUNT(*)
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn
GROUP BY c.ssn
UNION
SELECT c.ssn, 0
FROM customers c 
LEFT OUTER JOIN credit_cards cc
ON c.ssn = cc.ssn
WHERE cc.ssn ISNULL
ORDER BY count;",,,"SELECT left_join.ssn, left_join.type, SUM(COALESCE(right_join.total, 0)) as number_of_cards
FROM
	(SELECT *
	FROM customers c,
	(SELECT DISTINCT cc.type
	FROM credit_cards cc) AS cctype) AS left_join
LEFT OUTER JOIN
	(SELECT cc.ssn, cc.type, COUNT(*) as total
	FROM credit_cards cc
	GROUP BY cc.ssn, cc.type) AS right_join
ON left_join.ssn = right_join.ssn AND left_join.type = right_join.type
GROUP BY left_join.ssn, left_join.type
ORDER BY left_join.ssn, left_join.type;",,,"SELECT c.country, COUNT(DISTINCT c.ssn) AS number_of_customers
FROM customers c, credit_cards cc, merchants m, transactions t
WHERE c.ssn = cc.ssn AND cc.number = t.number and t.code = m.code
AND c.country != m.country
GROUP BY c.country;",,,"SELECT all_trans.type, all_trans.identifier
FROM
	(SELECT cc1.type, MAX(t1.amount) AS amount
	FROM transactions t1, credit_cards cc1
	WHERE t1.number = cc1.number 
	GROUP BY cc1.type) AS max_trans,
	(SELECT *
	 FROM transactions t2, credit_cards cc2
	 WHERE t2.number = cc2.number) AS all_trans
WHERE max_trans.amount = all_trans.amount AND max_trans.type = all_trans.type;",,,"SELECT cc1.type, t1.identifier
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number
AND t1.amount >= ALL (
	SELECT t2.amount
	FROM transactions t2, credit_cards cc2
	WHERE t2.number = cc2.number AND cc1.type = cc2.type);",,,"SELECT m.code, m.name
FROM merchants m
WHERE NOT EXISTS (
		SELECT *
		FROM transactions t, credit_cards cc
		WHERE t.number = cc.number 
		AND t.amount >= 888
		AND (cc.type LIKE '%visa%' OR cc.type LIKE '%diners-club%')
		AND m.code = t.code);",,
A0218930E,"SELECT cc.ssn
FROM transactions t
LEFT JOIN credit_cards cc
ON t.number = cc.number
WHERE DATE(datetime) = DATE('2017-12-25') AND cc.type = 'visa';",,,"SELECT c.first_name, c.last_name
FROM customers c
LEFT JOIN credit_cards cc ON cc.ssn = c.ssn
WHERE c.country = 'Singapore'
AND cc.type = 'jcb'
AND cc.ssn IN (SELECT DISTINCT cc.ssn
				FROM credit_cards cc
				WHERE cc.type='visa');",,,"SELECT c.ssn, COALESCE(count(type), 0) AS num_card_types_own
FROM customers c
LEFT JOIN credit_cards cc ON c.ssn = cc.ssn
GROUP BY c.ssn;",,,"SELECT c.ssn, type, COALESCE(count(number), 0) AS num_cards_own
FROM customers c
INNER JOIN credit_cards cc ON c.ssn = cc.ssn
GROUP BY 1, 2;",,,"SELECT c.country, count(c.ssn)
FROM customers c
INNER JOIN (SELECT t.code, cc.ssn
			FROM transactions t
			LEFT JOIN credit_cards cc ON t.number = cc.number) temp ON temp.ssn = c.ssn
LEFT JOIN merchants m ON m.code = temp.code
WHERE c.country <> m.country
GROUP BY c.country;",,,"SELECT cc.type, t.identifier, t.amount
FROM transactions t, credit_cards cc, (SELECT cc.type, MAX(t.amount) as max_amount
										FROM transactions t
										JOIN credit_cards cc ON t.number = cc.number
										GROUP BY cc.type) temp
WHERE t.number = cc.number AND concat(t.amount, cc.type) = concat(temp.max_amount, temp.type);",,,"SELECT temp.identifier, temp.type, temp.amount
FROM (SELECT cc.type, t.identifier, t.amount,
        ROW_NUMBER() OVER (PARTITION BY cc.type ORDER BY t.amount DESC) AS rank_num
	  FROM credit_cards cc
	  LEFT JOIN transactions t ON t.number = cc.number) temp
WHERE temp.rank_num = 1;
SELECT t1.identifier, cc1.type, t1.amount
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number
AND t1.amount >= ALL (SELECT t2.amount
                      FROM transactions t2, credit_cards cc2
                      WHERE t2.number = cc2.number
                      AND cc2.type = cc1.type);",,,"SELECT m.code, m.name
FROM merchants m
WHERE m.code NOT IN (SELECT m.code
					FROM merchants m
					LEFT JOIN transactions t ON t.code = m.code
					LEFT JOIN credit_cards cc ON cc.number = t.number
					WHERE t.amount >= 888
					AND (cc.type LIKE '%visa%' OR cc.type LIKE '%diners-club%'));",,
A0218942Y,"SELECT DISTINCT c.ssn
FROM transactions t
JOIN credit_cards cc ON cc.number = t.number
JOIN customers c ON c.ssn = cc.ssn
WHERE cc.type = 'visa' AND t.datetime:: date = '2017-12-25'
ORDER BY c.ssn;",,,"SELECT c.first_name, c.last_name 
FROM customers c
WHERE c.ssn IN (
	(SELECT cc.ssn 
	FROM credit_cards cc WHERE cc.type = 'visa') 
	INTERSECT
	(SELECT cc.ssn 
	 FROM credit_cards cc WHERE cc.type = 'jcb'))
AND country ='Singapore';",,,"SELECT c.ssn, count(cc.type)
FROM customers c
LEFT OUTER JOIN credit_cards cc ON cc.ssn = c.ssn
GROUP BY c.ssn
ORDER BY COUNT;",,,"SELECT c.ssn, cc.type, count(cc.type)
FROM customers c
LEFT OUTER JOIN credit_cards cc ON cc.ssn = c.ssn
GROUP BY c.ssn, cc.type
ORDER BY c.ssn, cc.type;",,,"SELECT c.country, count(DISTINCT c.ssn)
FROM customers c, credit_cards cc, merchants m, transactions t
WHERE cc.ssn = c.ssn
AND cc.number = t.number
AND t.code = m.code
AND c.country <> m.country
GROUP BY c.country
ORDER BY count DESC;",,,"SELECT t1.identifier
FROM credit_cards cc1, transactions t1
WHERE cc1.number = t1.number AND
(cc1.type, t1.amount) IN (
SELECT cc2.type, MAX(t2.amount)
FROM credit_cards cc2, transactions t2
WHERE cc2.number = t2.number
GROUP BY cc2.type);",,,"SELECT t1.identifier 
FROM credit_cards cc1, transactions t1
WHERE t1.number = cc1.number AND t1.amount >= ALL (
SELECT t2.amount
FROM credit_cards cc2, transactions t2
WHERE cc2.type = cc1.type AND t2.number = cc2.number);",,,"SELECT m.code, m.name
FROM merchants m, 
(SELECT code 
 FROM merchants
 EXCEPT
 SELECT DISTINCT code
 FROM credit_cards cc, transactions t
 WHERE cc.number = t.number and t.amount >= 888 and (type like '%diners-club%' or type like '%visa%')) did
 WHERE m.code=did.code;",,
A0218949L,"SELECT DISTINCT cc.ssn
FROM transactions t LEFT JOIN credit_cards cc ON t.number = cc.number
WHERE cc.type = 'visa'
AND DATE(t.datetime) = '2017-12-25';",,,"SELECT first_name, last_name
FROM customers
WHERE country = 'Singapore'
AND ssn IN (
	SELECT ssn FROM credit_cards WHERE type = 'jcb'
	INTERSECT
	SELECT ssn FROM credit_cards WHERE type = 'visa'
)
GROUP BY ssn;",,,"SELECT c.ssn AS ssn,
       COALESCE(cc.count, 0) AS number_of_cards
FROM customers c LEFT JOIN (
    SELECT ssn,
           COUNT(number)
    FROM credit_cards
    GROUP BY ssn) cc
ON c.ssn = cc.ssn;",,,"SELECT c_ssn.ssn AS ssn, c_type.type AS type,
	   CASE WHEN num_cards ISNULL THEN 0
	   ELSE num_cards
	   END AS num_cards
FROM (
	SELECT DISTINCT(ssn) FROM customers) c_ssn CROSS JOIN (select DISTINCT(type) FROM credit_cards) c_type
	LEFT JOIN (
		SELECT ssn, type, COUNT(distinct(number)) AS num_cards
		FROM credit_cards
		GROUP BY SSN, TYPE
	) counts ON c_ssn.ssn = counts.ssn AND c_type.type = counts.type
ORDER BY ssn, type;",,,"SELECT c.country, COUNT(DISTINCT c.ssn)
FROM customers c, merchants m, transactions t, credit_cards cc
WHERE c.ssn = cc.ssn
AND cc.number = t.number
AND m.code = t.code
AND c.country <> m.country
GROUP BY c.country;",,,"SELECT t.identifier
FROM transactions t LEFT JOIN credit_cards cc ON t.number = cc.number
WHERE (cc.type, t.amount) IN (
    SELECT cc.type,
           MAX(t.amount) AS max_amount
    FROM transactions t LEFT JOIN credit_cards cc ON t.number = cc.number
    GROUP BY cc.type
  );",,,"SELECT agg1.identifier
FROM (transactions t LEFT JOIN credit_cards c ON t.number = c.number) agg1
WHERE agg1.amount >= ALL (
  	SELECT agg2.amount
  	FROM (transactions t LEFT JOIN credit_cards c ON t.number = c.number) agg2
    WHERE agg1.type = agg2.type);",,,"SELECT code, name
FROM merchants
WHERE code IN (
  	SELECT code
  	FROM transactions t LEFT JOIN credit_cards cc ON t.number = cc.number
  	WHERE cc.type LIKE '%visa%'
  	OR cc.type LIKE '%diners-club%'
  	GROUP BY code
  	HAVING MAX(
    		CASE WHEN amount >= 888 THEN 'True'
    		ELSE 'False'
    		END
    		) = 'False'
);",,
A0218954U,"SELECT DISTINCT cc.ssn
FROM credit_cards cc, transactions t
WHERE cc.number = t.number AND cc.type='visa' AND DATE(t.datetime) = '2017-12-25';",,,"SELECT c.first_name, c.last_name
FROM customers c, credit_cards cc, credit_cards cc1
WHERE c.ssn=cc.ssn 
AND c.ssn=cc1.ssn 
AND c.country='Singapore' 
AND cc.type='visa' 
AND cc1.type='jcb' 
GROUP BY c.ssn ;",,,"SELECT c.ssn, COUNT(cc.number) 
FROM customers c LEFT OUTER JOIN credit_cards cc
ON c.ssn=cc.ssn
GROUP BY c.ssn;",,,"SELECT a.ssn, a.type, COALESCE(sum(b.cards_held), 0)
FROM
	(SELECT distinct c.ssn, cc.type
	FROM customers c,credit_cards cc ) AS a
LEFT OUTER JOIN
	(SELECT cc1.ssn, cc1.type, COUNT(cc1.number) as cards_held
	FROM credit_cards cc1
	GROUP BY cc1.ssn, cc1.type) AS b
ON a.ssn = b.ssn AND a.type = b.type
GROUP BY a.ssn, a.type
ORDER BY a.ssn, a.type;",,,"SELECT c.country, COUNT(DISTINCT c.ssn) 
FROM customers c , credit_cards cc, transactions t, merchants m
WHERE c.ssn = cc.ssn AND cc.number = t.number AND t.code = m.code AND c.country <> m.country
GROUP BY c.country;",,,"SELECT t.identifier 
FROM transactions t , credit_cards cc
WHERE t.number=cc.number AND (cc.type,t.amount)
IN (SELECT DISTINCT cc1.type, MAX(t1.amount)
	FROM credit_cards cc1, transactions t1
	WHERE cc1.number=t1.number
	GROUP BY cc1.type);",,,"SELECT t.identifier 
FROM transactions t , credit_cards cc
WHERE t.number=cc.number AND t.amount >= ALL(
	SELECT t1.amount
	FROM credit_cards cc1, transactions t1
	WHERE cc1.number=t1.number AND cc1.type=cc.type);",,,"SELECT  m.code,m.name
FROM merchants m 
WHERE m.code NOT IN 
(SELECT t.code 
 FROM transactions t, credit_cards cc
 WHERE t.number=cc.number AND t.amount >=888 
 AND (cc.type LIKE 'visa%' OR cc.type LIKE 'diners-club%'));",,
A0218968J,"SELECT DISTINCT cc.ssn
FROM credit_cards cc, transactions t
WHERE cc.type = 'visa' 
AND t.number = cc.number
AND t.datetime >= '2017-12-25 00:00:00' 
AND t.datetime < '2017-12-26 00:00:00'
ORDER BY cc.ssn;",,,"SELECT r.first_name, r.last_name FROM (
	SELECT c.ssn, c.first_name, c.last_name
	FROM credit_cards cc, customers c
	WHERE cc.type = 'visa' 
	AND c.country='Singapore' AND cc.ssn = c.ssn
	INTERSECT
	SELECT c.ssn, c.first_name, c.last_name
	FROM credit_cards cc, customers c
	WHERE cc.type = 'jcb' 
	AND c.country='Singapore' AND cc.ssn = c.ssn
) AS r
ORDER BY r.first_name, r.last_name;",,,"SELECT c.ssn, COUNT(cc.number) AS NumberOfCards 
FROM customers c 
LEFT JOIN credit_cards cc ON c.ssn = cc.ssn
GROUP BY c.ssn
ORDER by NumberOfCards, c.ssn;",,,"SELECT dc.ssn, dcc.type, COUNT(cc.number)
FROM (
	SELECT DISTINCT c.ssn
	FROM customers c
	) dc
	CROSS JOIN 
	(
	SELECT DISTINCT cc.type
	FROM credit_cards cc
	) dcc
	LEFT JOIN credit_cards cc ON dc.ssn = cc.ssn AND dcc.type = cc.type
GROUP BY dc.ssn, dcc.type
ORDER BY dc.ssn, dcc.type;",,,"SELECT c.country, COUNT(DISTINCT c.ssn) AS Number_Of_Customers
FROM customers c 
INNER JOIN credit_cards cc ON c.ssn = cc.ssn
INNER JOIN transactions t ON t.number = cc.number
INNER JOIN merchants m ON t.code = m.code
WHERE c.country <> m.country
GROUP BY c.country
ORDER BY c.country;",,,"SELECT t.identifier
FROM transactions t  
LEFT JOIN credit_cards cc ON t.number = cc.number
WHERE ( cc.type, t.amount ) IN (
	SELECT cc.type, MAX(t2.amount)
	FROM transactions t2
	LEFT JOIN credit_cards cc ON t2.number = cc.number
	GROUP BY cc.type);",,,"SELECT t.identifier
FROM credit_cards cc1
LEFT JOIN transactions t ON cc1.number = t.number 
WHERE (cc1.type, t.amount) >= ALL( 
	SELECT cc2.type, t2.amount
	FROM credit_cards cc2 
	LEFT JOIN transactions t2 ON cc2.number = t2.number
	WHERE cc2.type = cc1.type);",,,"SELECT DISTINCT m.code, m.name
FROM merchants m 
WHERE m.code NOT IN (
	SELECT m.code
	FROM merchants m 
	INNER JOIN transactions t ON t.code=m.code
	INNER JOIN credit_cards cc ON t.number = cc.number
	WHERE t.amount >= 888
	AND (cc.type LIKE '%visa%' OR cc.type LIKE '%diners-club%'))
ORDER BY m.code;",,
A0231847B,"SELECT 
  DISTINCT c.ssn 
FROM 
  customers c, 
  credit_cards cc, 
  transactions t 
WHERE 
  t.number = cc.number 
  AND cc.ssn = c.ssn 
  AND DATE(t.datetime) = '2017-12-25' 
  AND cc.type = 'visa';",,,"SELECT 
  c.first_name, 
  c.last_name 
FROM 
  customers c 
WHERE 
  c.ssn IN (
    SELECT 
      DISTINCT c.ssn 
    FROM 
      customers c, 
      credit_cards cc1, 
      credit_cards cc2 
    WHERE 
      c.country = 'Singapore' 
      AND c.ssn = cc1.ssn 
      AND c.ssn = cc2.ssn 
	  AND cc1.type = 'jcb' 
      AND cc2.type = 'visa'
  );",,,"SELECT 
  c.ssn, 
  COUNT(cc.number) AS number_of_cards 
FROM 
  customers c 
  LEFT OUTER JOIN credit_cards cc ON c.ssn = cc.ssn 
GROUP BY 
  c.ssn 
ORDER BY 
  number_of_cards ASC;",,,"CREATE VIEW card_type AS 
SELECT 
  DISTINCT cc.type 
FROM 
  credit_cards cc;
SELECT 
  c.ssn, 
  card_type.type, 
  COUNT (cc.number) 
FROM 
  customers c CROSS 
  JOIN card_type 
  LEFT OUTER JOIN credit_cards cc ON c.ssn = cc.ssn 
  AND card_type.type = cc.type 
GROUP BY 
  card_type.type, 
  c.ssn 
ORDER BY 
  c.ssn ASC, 
  card_type.type ASC;",,,"SELECT 
  c.country, 
  COUNT (DISTINCT c.ssn) AS customer_number 
FROM 
  customers c, 
  credit_cards cc, 
  merchants m, 
  transactions t 
WHERE 
  t.code = m.code 
  AND t.number = cc.number 
  AND cc.ssn = c.ssn 
  AND c.country <> m.country 
GROUP BY 
  c.country;",,,"SELECT 
  cc.type, 
  t.identifier, 
  t.amount 
FROM 
  transactions t, 
  credit_cards cc 
WHERE 
  t.number = cc.number 
GROUP BY 
  cc.type, 
  t.identifier, 
  t.amount 
HAVING 
  t.amount >= ALL (
    SELECT 
      t1.amount 
    FROM 
      transactions t1, 
      credit_cards cc1 
    WHERE 
      t1.number = cc1.number 
      AND cc1.type = cc.type
  ) 
ORDER BY 
  cc.type ASC;",,,"SELECT 
  cc.type, 
  t.identifier, 
  t.amount 
FROM 
  transactions t, 
  credit_cards cc 
WHERE 
  t.number = cc.number 
  AND t.amount >= ALL (
    SELECT 
      t1.amount 
    FROM 
      transactions t1, 
      credit_cards cc1 
    WHERE 
      t1.number = cc1.number 
      AND cc1.type = cc.type
  ) 
ORDER BY 
  cc.type ASC;",,,"SELECT 
  m.code, 
  m.name 
FROM 
  merchants m 
WHERE 
  m.code NOT IN (
    SELECT 
      t.code 
    FROM 
      transactions t, 
      credit_cards cc 
    WHERE 
      t.number = cc.number 
      AND (
        cc.type LIKE 'visa%' 
        OR cc.type LIKE 'diners-club%'
      ) 
      AND t.amount >= 888
  );",,
A0231849X,"select distinct c.ssn from customers c,credit_cards cd, transactions t
where c.ssn=cd.ssn and t.number=cd.number 
and cd.type='visa'
and date(t.datetime) ='2017-12-25';",,,"select c.first_name,c.last_name from customers c ,credit_cards cd
where c.ssn=cd.ssn and cd.type='jcb'
intersect
select c.first_name,c.last_name from customers c ,credit_cards cd
where c.ssn=cd.ssn and cd.type='visa';",,,"select c.ssn ,count(cd.number) as number_of_credit_cards_owned
from customers c left outer join credit_cards cd on c.ssn=cd.ssn
group by c.ssn;",,,"select c.ssn,cd.type,count(cd.number) as number_of_credit_cards_owned
from customers c left outer join credit_cards cd on c.ssn=cd.ssn
group by c.ssn,cd.type
order by c.ssn;",,,"select c.country,count(distinct c.ssn) from customers c,credit_cards cd,merchants m, transactions t
where c.ssn=cd.ssn and t.number=cd.number and t.code=m.code
and c.country<>m.country
group by c.country;",,,"select t.identifier,cd.type from transactions t, credit_cards cd
where t.number=cd.number
and t.amount = all(select max(t2.amount) from transactions t2,credit_cards cd2
					where t2.number=cd2.number
				   and cd2.type=cd.type
					group by cd2.type);",,,"select cd.type,t.identifier from transactions t,credit_cards cd
where t.number=cd.number
and t.amount>= all(select t2.amount from transactions t2,credit_cards cd2
				   where cd.type=cd2.type
				   and t2.number=cd2.number);",,,"select m.code,m.name
from transactions  t,credit_cards cd, merchants m
where t.number=cd.number and t.code=m.code
and (cd.type='visa' or cd.type='diners-club')
group by m.code,m.name
having max(t.amount)<888;",,
A0231850M,"SELECT DISTINCT cc.ssn
FROM credit_cards cc, transactions t
WHERE t.datetime >= '2017-12-25'
AND t.datetime < '2017-12-26'
AND t.number = cc.number
AND cc.type = 'visa';",,,"SELECT c.first_name, c.last_name
FROM customers c
WHERE c.ssn IN (SELECT DISTINCT(c1.ssn)
				FROM credit_cards c1, credit_cards c2
				WHERE c1.type = 'visa'
				AND c2.type = 'jcb'
				AND c1.ssn = c2.ssn);",,,"(SELECT c.ssn, COUNT(*) AS count
 FROM customers c, credit_cards cc
 WHERE c.ssn = cc.ssn
 GROUP BY c.ssn)
UNION
(SELECT c.ssn, 0 AS count
FROM customers c LEFT JOIN credit_cards cc
ON c.ssn = cc.ssn
WHERE cc.ssn ISNULL);",,,"SELECT cc.ssn, types.type, COUNT(*) as count
FROM credit_cards cc,
	 (SELECT DISTINCT cc.type
	 FROM credit_cards cc) AS types
WHERE cc.type = types.type
GROUP BY cc.ssn, types.type
ORDER BY ssn, type;",,,"SELECT c.country, COUNT(*)
FROM customers c, merchants m
WHERE c.country != m.country
GROUP BY c.country;",,,"SELECT t.identifier
FROM transactions t,(
	SELECT cc.type, MAX(t.amount)
	FROM transactions t, credit_cards cc
	WHERE t.number = cc.number
	GROUP BY cc.type) as temp
WHERE t.amount = temp.max;",,,"SELECT t1.identifier
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number
AND t1.amount >= ALL(SELECT t2.amount
					 FROM transactions t2, credit_cards cc2
					 WHERE t2.number = cc2.number
					 AND cc1.type = cc2.type)",,,"SELECT m.code, m.name
FROM","Missing semicolon, CHECK CODE.","Missing semicolon, CHECK CODE."
A0231851L,"select distinct cc.ssn
from credit_cards cc
where cc.number in(
		select tx.number
		from transactions tx
		where tx.datetime between '2017-12-25' and '2017-12-26'
	intersect
		select cc.number
		from credit_cards cc
		where cc.type='visa');",,,"select cs.first_name, cs.last_name
from customers cs
where cs.ssn in(
		select cs.ssn
		from customers cs
		where cs.country='Singapore'
		group by cs.ssn
	intersect
		select cc.ssn
		from credit_cards cc
		where cc.type='jcb'
		group by cc.ssn
		having cc.ssn in(
			select cc.ssn
			from credit_cards cc
			where cc.type='visa')
);",,,"select noc.ssn,count(noc.number)
from(
	select cs.ssn, cc.number
	from customers cs left join credit_cards cc on cc.ssn=cs.ssn) noc
group by noc.ssn;",,,"select ssn_tp.ssn,ssn_tp.type,count(cc.number)
from (
	(select cs.ssn from customers cs) ssn 
	cross join 
	(select distinct cc.type from credit_cards cc) tp 
) ssn_tp left join credit_cards cc on ssn_tp.ssn=cc.ssn and ssn_tp.type=cc.type
group by ssn_tp.ssn,ssn_tp.type
order by ssn_tp.ssn;",,,"select buy_oversea.country, count(*)
from(
	select distinct cs_tx.ssn,cs_tx.country
	from ((customers cs left join (select cc.ssn as ssn1,cc.number from credit_cards cc) card_no on cs.ssn=card_no.ssn1) cs_cc 
					left join transactions tx on cs_cc.number=tx.number) cs_tx
					left join merchants mt on cs_tx.code=mt.code
	where cs_tx.country<>mt.country
	) buy_oversea
group by buy_oversea.country;",,,"select i_a_t.type,i_a_t.identifier
from(
	select tx.identifier,tx.amount, cc.type
	from transactions tx left join credit_cards cc on tx.number=cc.number) i_a_t
	left join (
		select i_a_t.type,max(i_a_t.amount)
		from (
			select tx.identifier,tx.amount, cc.type
			from transactions tx left join credit_cards cc on tx.number=cc.number) i_a_t
		group by i_a_t.type) max_table 
	on i_a_t.type=max_table.type
where i_a_t.amount=max_table.max and i_a_t.type=max_table.type
order by i_a_t.type;",,,"select cc.type,tx.identifier 
from transactions tx join credit_cards cc on tx.number = cc.number
where tx.amount >= all(
	select tx1.amount
	from transactions tx1 join credit_cards cc1 on tx1.number = cc1.number
	where cc.type = cc1.type);",,,"select mt.code,mt.name
from merchants mt
where mt.code not in(
select tx.code
from transactions tx left join credit_cards cc on tx.number=cc.number
where (cc.type like 'visa%' or cc.type like 'diners-club%') and tx.amount>=888
);",,
A0231854E,"select credit_cards.ssn, credit_cards.type from 
(transactions inner join credit_cards on transactions.number = credit_cards.number)
where credit_cards.type like '%visa%' and transactions.datetime between '2017-12-25 00:00:00' and '2017-12-25 23:59:59';",,,"select distinct credit_cards.ssn, first_name, last_name  from credit_cards 
inner join customers on credit_cards.ssn = customers.ssn
where country='Singapore' and (credit_cards.type like '%visa%' or credit_cards.type = 'jcb');",,,"select customers.ssn, count(credit_cards.number) from 
customers left join credit_cards on customers.ssn = credit_cards.ssn
group by customers.ssn order by customers.ssn;",,,"select customers.ssn, credit_cards.type, count(credit_cards.number) from 
customers left join credit_cards on customers.ssn = credit_cards.ssn
group by customers.ssn, credit_cards.type order by customers.ssn;",,,"select customers.country, count(customers.ssn) from merchants, transactions, credit_cards, customers where
merchants.code = transactions.code and
transactions.number = credit_cards.number and
credit_cards.ssn = customers.ssn and 
merchants.country <> customers.country
group by customers.country;",,,"select identifier
from credit_cards inner join transactions on credit_cards.number = transactions.number
where (credit_cards.type, amount) in (
	select credit_cards.type, max(transactions.amount) as amount 
	from credit_cards inner join transactions on credit_cards.number = transactions.number
	group by credit_cards.type);",,,"select T.identifier
from (credit_cards inner join transactions on credit_cards.number = transactions.number) as T
where not exists (
	select * 
	from (credit_cards inner join transactions on credit_cards.number = transactions.number) 
	where T.amount < transactions.amount and T.type = credit_cards.type );",,,"select merchants.code, merchants.name 
from merchants 
where merchants.code 
not in (
	select merchants.code from merchants, transactions, credit_cards 
	where merchants.code = transactions.code 
	and transactions.number = credit_cards.number 
	and transactions.amount >888 
	and transactions.amount =888 
	and (credit_cards.type like '%visa%' or credit_cards.type = 'dinners-club')
);",,
A0231856B,"select distinct c.ssn
from customers c, credit_cards d, transactions t
where c.ssn=d.ssn
and d.number=t.number
and extract(year from t.datetime)=2017
and extract(month from t.datetime)=12
and extract(day from t.datetime)=25
and d.type='visa';",,,"select a.first_name, a.last_name from
(select distinct c.ssn, c.first_name, c.last_name
from customers c, credit_cards d
where c.ssn=d.ssn
and d.type ='jcb'
and country='Singapore'
intersect
select distinct c.ssn, c.first_name, c.last_name
from customers c, credit_cards d
where c.ssn=d.ssn
and d.type ='visa'
and country='Singapore'
) as a;",,,"select distinct a.ssn,
case when b.sum_cards isnull then 0 else b.sum_cards end as cards
from customers as a
left join
(select ssn,count(distinct number) as sum_cards
from credit_cards
group by ssn) as b
on a.ssn=b.ssn;",,,"select distinct all_sample.ssn, all_sample.type,
case when record.sum_cards isnull then 0 else record.sum_cards end as cards
from
(select * from
(select distinct type from credit_cards) as a cross join
(select distinct ssn from customers) as b) as all_sample
left join
(select ssn, type, count(distinct number) as sum_cards from credit_cards
group by ssn,type) as record
on all_sample.ssn=record.ssn
and all_sample.type=record.type
order by all_sample.ssn;",,,"select c.country, count(distinct c.ssn) as customers_number
from customers as c, credit_cards as d, transactions as t, merchants as m
where c.ssn=d.ssn
and d.number = t.number
and t.code=m.code
and c.country<>m.country
group by c.country;",,,"select ident.type, ident.identifier from
(select max(t.amount) as max_amount, d.type
from transactions as t
left join
credit_cards as d
on t.number=d.number group by d.type) as max_value
left join
(select t.identifier, t.amount, d.type
from transactions as t
left join
credit_cards as d
on t.number=d.number) as ident
on max_value.max_amount=ident.amount
and max_value.type=ident.type;",,,"select d1.type, t1.identifier
from transactions as t1, credit_cards as d1
where t1.number=d1.number
and t1.amount>=ALL(
select t2.amount
from transactions as t2, credit_cards as d2
where t2.number=d2.number
and d1.type=d2.type
);",,,"select distinct m.code, m.name
from merchants as m, transactions as t, credit_cards as d
where m.code=t.code
and t.number=d.number
except
select m.code, m.name
from merchants as m, transactions as t, credit_cards as d
where m.code=t.code
and t.number=d.number
and (d.type like '%visa%' or d.type like '%diners-club%')
and amount>=888;",,
A0231857Y,"SELECT 
  DISTINCT ssn 
FROM 
  credit_cards 
WHERE 
  number in (
    SELECT 
      number 
    FROM 
      transactions 
    WHERE 
      datetime BETWEEN '2017-12-25 00:00:00' 
      AND '2017-12-25 23:59:59'
  ) 
  AND type = 'visa';",,,"SELECT 
  first_name, 
  last_name 
FROM 
  customers c 
WHERE 
  ssn IN (
    SELECT 
      cc1.ssn 
    FROM 
      credit_cards cc1, 
      credit_cards cc2 
    WHERE 
      cc1.ssn = cc2.ssn 
      AND cc1.type = 'visa' 
      AND cc2.type = 'jcb'
  ) 
  AND country = 'Singapore';",,,"SELECT 
  ssn, 
  0 as cc_count 
FROM 
  customers 
where 
  ssn NOT IN (
    SELECT 
      ssn 
    FROM 
      credit_cards 
    GROUP BY 
      ssn
  ) 
UNION 
SELECT 
  ssn, 
  count(number) 
FROM 
  credit_cards 
GROUP BY 
  ssn;",,,"SELECT 
  c.ssn, 
  cc1.type, 
  COALESCE(count_cc, 0) AS count_cc 
FROM 
  customers c CROSS 
  JOIN (
    SELECT 
      type 
    FROM 
      credit_cards 
    GROUP BY 
      type
  ) AS cc1 
  LEFT JOIN (
    SELECT 
      ssn, 
      type, 
      COUNT(number) AS count_cc 
    FROM 
      credit_cards 
    GROUP BY 
      ssn, 
      type
  ) AS cc2 ON c.ssn = cc2.ssn 
  AND cc1.type = cc2.type;",,,"SELECT 
  c.country, 
  COUNT(DISTINCT c.ssn) 
FROM 
  customers c, 
  credit_cards cc, 
  transactions t, 
  merchants m 
WHERE 
  c.ssn = cc.ssn 
  AND cc.number = t.number 
  AND t.code = m.code 
  AND c.country != m.country 
GROUP BY 
  c.country;",,,"SELECT 
  identifier 
FROM 
  transactions tx1 
  JOIN credit_cards cc1 ON tx1.number = cc1.number 
  JOIN (
    SELECT 
      type, 
      max(amount) AS max_per_type 
    FROM 
      credit_cards cc2, 
      transactions tx2 
    WHERE 
      tx2.number = cc2.number 
    GROUP BY 
      type
  ) as max_cc_tx ON tx1.amount = max_cc_tx.max_per_type 
  AND max_cc_tx.type = cc1.type;",,,"SELECT 
  cc_amount1.identifier 
FROM 
  (
    SELECT 
      type, 
      amount, 
      identifier 
    FROM 
      credit_cards cc1, 
      transactions tx1 
    WHERE 
      cc1.number = tx1.number
  ) AS cc_amount1 
  LEFT JOIN (
    SELECT 
      type, 
      amount 
    FROM 
      credit_cards cc2, 
      transactions tx2 
    WHERE 
      cc2.number = tx2.number
  ) AS cc_amount2 ON cc_amount1.type = cc_amount2.type 
  AND cc_amount1.amount < cc_amount2.amount 
WHERE 
  cc_amount2.amount is NULL;",,,"SELECT 
  code, 
  name 
FROM 
  merchants m 
where 
  code NOT IN (
    SELECT 
      code 
    FROM 
      credit_cards cc 
      JOIN (
        SELECT 
          code, 
          number 
        FROM 
          transactions 
        WHERE 
          amount >= 888
      ) AS tx ON cc.number = tx.number 
    WHERE 
      type LIKE 'visa%' 
      OR type LIKE 'diners-club%'
      );",,
A0231863E,"SELECT DISTINCT cc.ssn
FROM transactions t JOIN credit_cards cc ON t.number = cc.number 
WHERE CAST(t.datetime AS DATE) = '2017-12-25' 
AND cc.type = 'visa';",,,"SELECT a.first_name, a.last_name FROM (
SELECT c.ssn, c.first_name, c.last_name
FROM customers c JOIN credit_cards cc ON c.ssn = cc.ssn
WHERE cc.type = 'jcb' AND c.country = 'Singapore'
INTERSECT
SELECT c.ssn, c.first_name, c.last_name
FROM customers c JOIN credit_cards cc ON c.ssn = cc.ssn
WHERE cc.type = 'visa' AND c.country = 'Singapore'
) AS a;",,,"SELECT c.ssn, COUNT(cc.number)
FROM customers c LEFT JOIN credit_cards cc ON c.ssn = cc.ssn
GROUP BY c.ssn
ORDER BY COUNT(cc.number) DESC;",,,"SELECT a.ssn, b.type, COUNT(cc.number)
FROM (
	SELECT DISTINCT c.ssn
	FROM customers c
	) a
	CROSS JOIN 
	(
	SELECT DISTINCT cc.type
	FROM credit_cards cc
	) b
	LEFT JOIN credit_cards cc ON a.ssn = cc.ssn AND b.type = cc.type
GROUP BY a.ssn, b.type
ORDER BY a.ssn, b.type;",,,"SELECT c.country, COUNT(DISTINCT c.ssn)
FROM transactions t 
JOIN credit_cards cc ON t.number = cc.number
JOIN customers c ON cc.ssn = c.ssn
JOIN merchants m ON t.code = m.code
WHERE c.country <> m.country
GROUP BY c.country;",,,"SELECT t.identifier
FROM transactions t
JOIN credit_cards cc ON t.number = cc.number
WHERE (cc.type, t.amount) in
	(SELECT cc.type, MAX(t1.amount) 
 	FROM transactions t1
 	JOIN credit_cards cc ON t1.number = cc.number
 	GROUP BY cc.type);",,,"SELECT t.identifier
FROM transactions t 
JOIN credit_cards cc ON t.number = cc.number
WHERE t.amount >= ALL(
	SELECT t1.amount FROM transactions t1
	JOIN credit_cards cc1 ON t1.number = cc1.number
	WHERE cc.type = cc1.type);",,,"SELECT DISTINCT m.code, m.name
FROM merchants m
WHERE m.code NOT IN
(SELECT m.code
	FROM transactions t 
	JOIN merchants m ON t.code = m.code
	JOIN credit_cards cc ON t.number = cc.number
	WHERE t.amount >= 888
	AND (cc.type LIKE '%visa%' OR cc.type LIKE '%diners-club%')
 );",,
A0231867X,"select count(distinct c.ssn) ssn
from customers c, transactions t, credit_cards d
where type = 'visa'
and date(datetime) = '2017-12-25'
and amount <> 0;",,,"select first_name, last_name
from customers
where ssn in
(
	select ssn
	from credit_cards c1
	where c1.type = 'jcb'
	INTERSECT
	select ssn
	from credit_cards c2
	where c2.type = 'visa'
)
and country = 'Singapore'
order by first_name, last_name asc;",,,"select b.ssn, (case when card_own is null then 0 else card_own end) as card_own
from
(
	select distinct ssn
	from customers c
) b
left join
(
	select distinct ssn, count(distinct number) card_own
	from credit_cards d 
	group by ssn
) a
on b.ssn = a.ssn
order by card_own desc;",,,"select a1.ssn, a1.type, (case when card_num is null then 0 else card_num end) as card_num
from
(
	select distinct ssn, type
	from customers c
	cross join
	(
		select distinct type
		from credit_cards
	) a
) a1
left join
(
	select ssn, type, count(distinct number) card_num
	from credit_cards d 
	group by ssn, type
) b
on a1.ssn = b.ssn and a1.type = b.type
order by ssn asc;",,,"select country, count(distinct a2.ssn) num
from
(
	select d.ssn ssn, country m_country
	from
	(
		select number, country
		from transactions t
		left join
		merchants m 
		on t.code = m.code
	) a1 
	left join
	credit_cards d
	on a1.number = d.number
) a2
left join
customers c 
on a2.ssn = c.ssn
where m_country <> c.country
group by country;",,,"select identifier, t1.type
from
(
	select identifier, amount, type
	from transactions t 
	left join
	credit_cards d 
	on t.number = d.number
) t1
left join
(
	select type, max(amount) amount
	from transactions t
	left join
	credit_cards d
	on t.number = d.number
	group by type
) a  
on t1.type = a.type
where t1.amount = a.amount;",,,"select identifier
from
(
	select identifier, row_number() over(partition by type order by amount desc) rn
	from transactions t
	left join
	credit_cards d 
	on t.number = d.number
) a 
where rn = 1
order by identifier asc;",,,"select distinct a.code, name
from
(
	select code, type, amount
	from transactions t 
	left join
	credit_cards d
	on t.number = d.number
	where type in ('visa', 'diners-club')
	and amount < 888
) a 
left join
merchants m
on a.code = m.code;",,
A0231868W,"SELECT c.ssn
FROM customers c, credit_cards cc, transactions t
WHERE c.ssn = cc.ssn
AND t.number = cc.number
AND (SELECT EXTRACT(DAY FROM t.datetime ))= '25'
AND (SELECT EXTRACT(MONTH FROM t.datetime ))= '12'
AND cc.type = 'visa';",,,"SELECT first_name, last_name
FROM (SELECT DISTINCT ssn, first_name, last_name
	  FROM customers
	  WHERE country = 'Singapore'
	  AND ssn IN
	  (SELECT ssn
	   FROM credit_cards
       WHERE type ='visa'
	  )
	  AND ssn IN
	  (SELECT ssn
	   FROM credit_cards
       WHERE type ='jcb'
	  )
	 ) d;",,,"SELECT c.ssn, count(cc.number) AS number_of_cards
FROM customers c LEFT JOIN credit_cards cc
ON c.ssn = cc.ssn
GROUP BY c.ssn;",,,"SELECT r.ssn, g.type, COUNT(d.type) num
FROM (SELECT DISTINCT type FROM credit_cards) g CROSS JOIN
     (SELECT DISTINCT ssn FROM customers) r LEFT JOIN
     (SELECT c.ssn, cc.type FROM customers c LEFT JOIN credit_cards cc
			ON c.ssn = cc.ssn) d
      ON d.ssn = r.ssn AND d.type = g.type
GROUP BY r.ssn, g.type
ORDER BY r.ssn;",,,"SELECT c.country, count( distinct c.ssn ) as num
FROM customers c, merchants m, transactions t, credit_cards cc
WHERE c.ssn = cc.ssn
AND cc.number = t.number
AND t.code = m.code
AND c.country <> m.country
GROUP BY c.country",,,"SELECT n.identifier, s.type, s.largest
FROM (SELECT cc.type, t.identifier, t.amount
	    FROM transactions t, credit_cards cc
      WHERE t.number = cc.number) n,
     (SELECT cc.type, max(t.amount) largest
      FROM transactions t, credit_cards cc
      WHERE t.number = cc.number
      GROUP BY cc.type) s
WHERE n.amount = s.largest
AND n.type = s.type
ORDER BY type",,,"SELECT t.identifier, cc1.type, t.amount
FROM transactions t, credit_cards cc1
WHERE cc1.number = t.number
AND t.amount >=
ALL (SELECT t1.amount
	   FROM transactions t1, credit_cards cc2
	   WHERE cc2.number = t1.number
	   AND cc1.type = cc2.type
	  )
ORDER BY type",,,"SELECT code, name
FROM merchants
EXCEPT
SELECT DISTINCT m.code, m.name
FROM merchants m, transactions t, credit_cards cc
WHERE m.code = t.code
AND cc.number = t.number
AND t.amount >=888
AND (cc.type = 'visa'
OR cc.type = 'diners-club')","Missing semicolon, CHECK CODE.","Missing semicolon, CHECK CODE."
A0231869U,"SELECT DISTINCT c.ssn
FROM customers c, credit_cards cc, transactions t
WHERE c.ssn = cc.ssn
AND cc.number = t.number
AND t.datetime BETWEEN '2017-12-25 00:00:00' AND '2017-12-26 00:00:00'
AND cc.type = 'visa';",,,"SELECT c1.first_name, c1.last_name
FROM customers c1
WHERE c1.country = 'Singapore'
AND c1.ssn IN (
	SELECT cc1.ssn
	FROM credit_cards cc1, credit_cards cc2
	WHERE cc1.ssn = cc2.ssn
	AND cc1.type = 'jcb'
	AND cc2.type = 'visa');",,,"SELECT c.ssn, count(DISTINCT cc.number) AS number_of_credit_cards
FROM customers c FULL OUTER JOIN credit_cards cc ON c.ssn = cc.ssn
GROUP BY c.ssn
ORDER BY number_of_credit_cards ASC;",,,"SELECT c.ssn, cdtype.type, count(DISTINCT cc.number) AS number_of_credit_cards
FROM (SELECT *, 1 AS a FROM customers) AS c
JOIN (SELECT DISTINCT type, 1 AS a FROM credit_cards) AS cdtype 
	ON c.a = cdtype.a
LEFT JOIN credit_cards AS cc ON c.ssn = cc.ssn
	AND cdtype.type = cc.type
GROUP BY c.ssn, cdtype.type
ORDER BY c.ssn;",,,"SELECT c.country, count(DISTINCT c.ssn)
FROM customers c LEFT JOIN credit_cards cc ON c.ssn = cc.ssn
LEFT JOIN transactions t ON cc.number = t.number
LEFT JOIN merchants m ON t.code = m.code
WHERE m.country <> c.country
GROUP BY c.country;",,,"SELECT DISTINCT cc1.type, t1.identifier
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number
AND cc1.type || t1.amount in
 (SELECT cc.type || MAX(t.amount) FROM transactions t, credit_cards cc
 WHERE t.number = cc.number
 GROUP BY cc.type);",,,"SELECT cc.type, t.identifier
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
AND t.amount >= ALL(
	SELECT t2.amount FROM transactions t2, credit_cards cc2 
	WHERE t2.number = cc2.number AND cc2.type=cc.type);",,,"SELECT DISTINCT m.code, m.name
FROM merchants m LEFT JOIN transactions t ON m.code = t.code 
LEFT JOIN credit_cards cc ON t.number =cc.number
WHERE cc.type LIKE 'visa%'
OR cc.type LIKE 'diners-club%'
GROUP BY m.code, m.name
HAVING max(t.amount) < 888","Missing semicolon, CHECK CODE.","Missing semicolon, CHECK CODE."
A0231872E,"select distinct cc.ssn
from credit_cards cc, transactions t
where cc.number=t.number
and extract(year from t.datetime)=2017
and extract(month from t.datetime)=12
and extract(day from t.datetime)=25
and cc.type='visa';",,,"select A.first_name,A.last_name
from(
select c.ssn,c.first_name,c.last_name
from customers c natural join credit_cards cc
where cc.type='jcb'
and c.country='Singapore'
intersect 
select c.ssn,c.first_name,c.last_name
from customers c left join credit_cards cc on cc.ssn=c.ssn
where cc.type='visa'
and c.country='Singapore')A;",,,"select cc.ssn,count(*)
from customers c natural join credit_cards cc 
group by cc.ssn
union
select c.ssn,count(*)-1
from customers c left join credit_cards cc on cc.ssn=c.ssn
where cc.type is null
group by c.ssn;",,,"select cc.ssn,cc.type,count(*) 
from credit_cards cc
group by cc.type,cc.ssn
union
select B.ssn,A.type,count(*)-1
from (select distinct cc.type
from credit_cards cc) A,(select c.ssn
from customers c
where c.ssn not in 
(select cc.ssn
from credit_cards cc
) )B
group by B.ssn,A.type
union
select C.ssn,C.type,count(*)-1
from (select * from(select distinct cc.ssn
from credit_cards cc) D,(select distinct cc.type
from credit_cards cc) E
except
select cc.ssn,cc.type
from credit_cards cc) C
group by C.ssn,C.type;",,,"select c.country,count(distinct c.ssn)
from customers c
left join credit_cards cc
on c.ssn=cc.ssn
left join transactions t
on t.number =cc.number
left join merchants m
on m.code=t.code
where c.country<>m.country
group by c.country;",,,"select  t.identifier 
from transactions t natural join credit_cards cc left join (select max(t.amount) max_amount, cc.type
from transactions t left join credit_cards cc
on t.number=cc.number 
group by cc.type) A on A.max_amount=t.amount
where A.type=cc.type;",,,"select t.identifier
from transactions t left join credit_cards cc on cc.number=t.number
where t.amount>=all(
select t1.amount
from transactions t1 left join credit_cards cc1 on cc1.number=t1.number
where cc.type=cc1.type );",,,"select m.code,m.name
from merchants m left join transactions t on m.code=t.code left join credit_cards cc on t.number=cc.number 
except
select m.code,m.name
from merchants m left join transactions t on m.code=t.code left join credit_cards cc on t.number=cc.number 
where (cc.type like '%visa%' or cc.type like '%diners-club%')
and t.amount>=888;",,
A0231875Y,"SELECT DISTINCT c.ssn
FROM credit_cards AS c, transactions AS t
WHERE c.type = 'visa'
AND t.number = c.number 
AND DATE(t.datetime) = '2017-12-25'
AND t.amount >0;",,,"SELECT cust.first_name, cust.last_name 
FROM 
	(SELECT c.ssn
	FROM credit_cards AS c
	WHERE c.type = 'visa'
	INTERSECT 
	SELECT c.ssn
	FROM credit_cards AS c
	WHERE c.type = 'jcb') AS cards
INNER JOIN customers AS cust ON cust.ssn = cards.ssn
WHERE cust.country = 'Singapore';",,,"SELECT cust.ssn, 
	(CASE WHEN card_count ISNULL THEN 0 
		  WHEN card_count >0 THEN card_count end) AS card_count
FROM customers AS cust 
LEFT JOIN
	(SELECT c.ssn, count(c.type) AS card_count 
	FROM credit_cards AS c
	GROUP BY c.ssn) AS cards
ON cust.ssn = cards.ssn;",,,"SELECT cust.ssn, cs.type, count(c.type) 
FROM customers AS cust
CROSS JOIN
	  (SELECT DISTINCT c.type 
	  FROM credit_cards AS c) AS cs
LEFT JOIN
	credit_cards AS c 
	ON c.type = cs.type AND c.ssn = cust.ssn 
GROUP BY cust.ssn, cs.type
ORDER BY cust.ssn;",,,"SELECT cust_country, SUM(country_count)
FROM 
	(SELECT t.identifier, t.amount, c.ssn, m.country AS merchant_country, cust.country AS cust_country,
		(CASE WHEN cust.country <> m.country THEN 1 ELSE 0 END) AS country_count 
	FROM transactions AS t, credit_cards AS c, merchants AS m, customers AS cust 
	WHERE  t.number = c.number 
	AND t.code = m.code
	AND c.ssn = cust.ssn) AS subquery
GROUP BY cust_country;",,,"SELECT s1.identifier
FROM 
	(SELECT c.type, t.identifier, t.amount 
	FROM transactions AS t, credit_cards AS c
	WHERE t.number = c.number) AS s1
RIGHT JOIN  
	(SELECT cc.type, MAX(tt.amount) AS max_amt
	FROM transactions AS tt, credit_cards AS cc
	WHERE tt.number = cc.number
	GROUP BY cc.type) AS s2	
ON s1.amount = s2.max_amt 
AND s1.type = s2.type
ORDER BY s1.type;",,,"SELECT tt.identifier
FROM transactions AS tt, credit_cards AS cc
WHERE tt.number = cc.number
AND tt.amount >= ALL 
	(SELECT t.amount
	FROM transactions AS t, credit_cards AS c
	WHERE t.number = c.number
	AND cc.type = c.type
	AND t.amount <> tt.amount);",,,"SELECT m.code, m.name 
FROM merchants AS m 
EXCEPT 
SELECT m.code, m.name
FROM transactions AS t, credit_cards AS c, merchants AS m 
WHERE t.number = c.number
AND t.code = m.code 
AND t.amount >= 888 
AND (c.type LIKE '%visa%' OR c.type LIKE '%diners-club%');",,
A0231880H,"SELECT c.SSN
FROM customers c, credit_cards r, transactions t
WHERE c.SSN = r.SSN
AND r.number = t.number
AND t.datetime between '2017-12-25' and '2017-12-26'
AND r.type = 'visa';",,,"SELECT c.first_name, c.last_name
FROM customers c, credit_cards r
WHERE c.SSN = r.SSN
AND r.type = 'jcb'
AND c.country = 'Singapore'
GROUP by c.SSN
INTERSECT
SELECT c.first_name, c.last_name
FROM customers c, credit_cards r
WHERE c.SSN = r.SSN
AND r.type = 'visa'
AND c.country = 'Singapore'
GROUP BY c.SSN;",,,"SELECT c.SSN, COUNT(r.number) 
FROM customers c LEFT OUTER JOIN credit_cards r ON c.SSN = r.SSN
GROUP BY c.SSN;",,,"CREATE VIEW view1 AS
SELECT c.SSN, r.type, c.SSN ||' '|| r.type AS ssntype, count(r.number) AS cards_owned
FROM customers c CROSS JOIN credit_cards r
WHERE c.SSN = r.SSN
GROUP BY c.SSN, r.type
ORDER BY c.SSN;
CREATE VIEW view2 AS
SELECT c.SSN, r.type, c.SSN ||' '|| r.type AS ssntype
FROM customers c CROSS JOIN credit_cards r
GROUP BY c.SSN, r.type
ORDER BY c.SSN;
SELECT v1.SSN as SSN, v1.type as type, v1.cards_owned
FROM view1 v1
Union
SELECT v2.SSN as SSN, v2.type as type, 0 as cards_owned
FROM view2 v2
WHERE v2.ssntype NOT IN (SELECT v1.ssntype FROM view1 v1)
ORDER BY SSN, type;",,,"CREATE VIEW tempc AS
SELECT c.SSN, c.country AS own, m.country AS merchant
FROM customers c, credit_cards r, merchants m, transactions t
WHERE c.SSN = r.SSN AND r.number = t.number AND t.code = m.code;
SELECT own, COUNT(*)
FROM tempc
WHERE own <> merchant
GROUP BY own;",,,"CREATE VIEW maxtemp AS
SELECT t.identifier, t.amount, r.type
FROM transactions t, credit_cards r
WHERE t.number = r.number
AND t.amount IN (SELECT max(t.amount)
					FROM credit_cards r, transactions t
					WHERE t.number = r.number
					GROUP BY r.type) 
AND r.type IN (SELECT DISTINCT(r.type) FROM credit_cards r)
ORDER BY r.type;
SELECT a1.identifier
FROM maxtemp a1
WHERE a1.amount >= ALL (
	SELECT a2.amount
	FROM maxtemp a2 
	WHERE a1.type = a2.type)
ORDER BY a1.identifier;",,,"CREATE VIEW temp AS
SELECT t.identifier, t.amount, r.type 
FROM transactions t, credit_cards r
WHERE t.number = r.number;
SELECT t1.identifier
FROM temp t1
WHERE t1.amount >= ALL (SELECT t2.amount FROM temp t2 WHERE t1.type = t2.type);",,,"SELECT DISTINCT(m.code), m.name
FROM merchants m, credit_cards r, transactions t
WHERE r.number = t.number AND m.code = t.code
AND m.code NOT IN (SELECT t.code 
				   FROM transactions t, credit_cards r 
				   WHERE r.number = t.number
				   AND t.amount >= 888
				   AND (r.type LIKE '%visa%' OR r.type LIKE '%diners-club%'));",,
A0231884Y,"select distinct cc.ssn 
from credit_cards cc, transactions t
where cc.number = t.number
and cc.type = 'visa'
and t.datetime >= '2017-12-25'
and t.datetime < '2017-12-26';",,,"select cus1.first_name, cus1.last_name
from (
	select distinct cus.ssn
	from customers cus, credit_cards cc1, credit_cards cc2
	where cus.ssn = cc1.ssn
	and cus.ssn = cc2.ssn
	and cus.country = 'Singapore'
	and cc1.type = 'jcb'
	and cc2.type = 'visa') as dssn, customers cus1
where cus1.ssn = dssn.ssn;",,,"select joint.ssn, count(joint.number) as numbercc
from (
	select cus1.ssn, cc1.number from
	customers cus1 left join credit_cards cc1
	on cus1.ssn = cc1.ssn) as joint
group by joint.ssn
order by numbercc;",,,"select wh.ssn, wh.type, count(wh.number)
from (
	select distinct df.ssn, df.type, cc.number from
	((select ssn from customers) as cusssn
	cross join (select distinct type from credit_cards)as cct) as df
	left join credit_cards cc
	on df.ssn = cc.ssn and df.type = cc.type
) as wh
group by wh.ssn, wh.type
order by wh.ssn, wh.type;",,,"select cus.country, count(distinct cus.ssn)
from customers cus, credit_cards cc, transactions t, merchants m
where cus.ssn = cc.ssn
and cc.number = t.number
and m.code = t.code
and cus.country != m.country
group by cus.country;",,,"select type_max.type, t.identifier, type_max.max_amount
from (
	select cc1.type, max(t1.amount) as max_amount
	from credit_cards cc1, transactions t1
	where cc1.number = t1.number
	group by cc1.type) as type_max, transactions t, credit_cards cc
where cc.number = t.number
and cc.type = type_max.type
and t.amount = type_max.max_amount;",,,"select cc.type, t.identifier, t.amount
from transactions t, credit_cards cc
where t.number = cc.number
and t.amount >= all(
	select t1.amount
	from transactions t1, credit_cards cc1
	where t1.number = cc1.number
	and cc.type = cc1.type);",,,"select distinct m.code, m.name
from merchants m
where m.code not in(
	select distinct m1.code
	from merchants m1, transactions t, credit_cards cc
	where m1.code = t.code
	and cc.number = t.number
	and t.amount >= 888
	and (cc.type like '%visa%' or cc.type like '%diners-club%'))
order by m.code;",,
A0231885X,"SELECT DISTINCT cc.ssn
FROM credit_cards cc JOIN transactions t ON cc.number=t.number
WHERE cc.type = 'visa'
AND CAST(t.datetime AS DATE) = '2017-12-25';",,,"SELECT name.first_name, name.last_name 
FROM (SELECT cu.ssn, cu.first_name, cu.last_name
FROM customers cu INNER JOIN credit_cards cc ON cu.ssn = cc.ssn 
	  INNER JOIN Transactions t ON cc.number=t.number
WHERE cu.country = 'Singapore' AND cc.type = 'jcb'
INTERSECT
SELECT cu.ssn, cu.first_name, cu.last_name
FROM customers cu INNER JOIN credit_cards cc ON cu.ssn = cc.ssn 
	  INNER JOIN Transactions t ON cc.number=t.number
WHERE cu.country = 'Singapore' AND cc.type = 'visa'
) AS name;",,,"SELECT cu.ssn, COUNT(cc.number)
FROM customers cu 
LEFT OUTER JOIN credit_cards cc ON cu.ssn = cc.ssn
GROUP BY cu.ssn
ORDER BY COUNT;",,,"SELECT sin.ssn, card.type, COUNT(*)
FROM (SELECT cu.ssn FROM customers cu) sin CROSS JOIN (SELECT cc.type FROM credit_cards cc) card
	LEFT OUTER JOIN credit_cards cc ON sin.ssn = cc.ssn AND card.type = cc.type
GROUP BY sin.ssn, card.type
ORDER BY sin.ssn;",,,"SELECT cu.country, COUNT(*)
FROM transactions t INNER JOIN credit_cards cc ON t.number = cc.number 
INNER JOIN customers cu ON cc.ssn = cu.ssn INNER JOIN merchants m ON t.code = m.code
WHERE cu.country < m.country OR cu.country > m.country
GROUP BY cu.country;",,,"SELECT t.identifier
FROM transactions t INNER JOIN credit_cards cc ON t.number = cc.number
WHERE t.amount = (select MAX(transfer.amount)
 	FROM transactions transfer
 	INNER JOIN credit_cards cc1 ON transfer.number = cc1.number
    WHERE cc1.type=cc.type);",,,"SELECT t.identifier
FROM transactions t 
JOIN credit_cards cc ON t.number = cc.number
WHERE t.amount >= ALL(
	SELECT t1.amount FROM transactions t1
	JOIN credit_cards cc1 ON t1.number = cc1.number
	WHERE cc.type = cc1.type);",,,"SELECT m.code, m.name FROM merchants m
WHERE m.code NOT IN
(SELECT m.code FROM transactions t LEFT OUTER JOIN merchants m ON t.code = m.code
	LEFT OUTER JOIN credit_cards cc ON t.number = cc.number
	WHERE t.amount >= 888 AND (cc.type LIKE '%visa%' OR cc.type LIKE '%diners-club%'));",,
A0231886W,"select
    distinct a.ssn
from
    credit_cards a
    left join
        transactions b
    on
        a.number = b.number
where
    a.type = 'visa'
and
    date(b.datetime) = '2017-12-24'
and
    amount != 0
;",,,"select
    a.first_name
    , a.last_name
from
    customers a
    left join
        credit_cards b
    on
        a.ssn = b.ssn
group by
    a.ssn
having
    sum(case when b.type = 'visa' then 1 else 0 end) > 0
and
    sum(case when b.type = 'jcb' then 1 else 0 end) > 0
;",,,"select
    a.ssn
    , count(distinct b.number) as credit_card_number
from
    customers a
    left join
        credit_cards b
    on
        a.ssn = b.ssn
group by
    a.ssn
;",,,"select
    a.ssn
    , b.type as credit_card_type
    , count(b.number) as credit_card_number
from
    customers a
    left join
        credit_cards b
    on
        a.ssn = b.ssn
group by
    a.ssn
    , b.type
;",,,"select
    c.country
    , count(1) as target_customer_number
from
    transactions a
    left join
        credit_cards b
    on
        a.number = b.number
    left join
        customers c
    on
        b.ssn = c.ssn
    left join
        merchants d
    on
        a.code = d.code
where
    c.country != d.country
group by
    c.country
;",,,"select
    b.type
    , a.identifier
from
    transactions a
    left join
        credit_cards b
    on
        a.number = b.number
group by
    b.type
having
    a.amount = max(a.amount)
;",,,"select
    c.type
    , c.identifier
from
    (
        select
            b.type
            , a.identifier
            , row_number() over(partition by b.type order by a.amount desc) rnk
        from
            transactions a
            left join
                credit_cards b
            on
                a.number = b.number
    ) c
where
    c.rnk = 1
;",,,"select
    a.code
    , a.name
from
    merchants a
    left join
        transactions b
    on
        a.code = b.code
    left join
        credit_cards c
    on
        b.number = c.number
where
    c.type in ('visa', 'diners-club')
group by
    a.code
having
    max(b.amount) < 888
;",,
A0231887U,"select cc.ssn
from credit_cards as cc  
inner join transactions as t on cc.number = t.number
where 1=1
  and cc.type = 'visa' 
  and t.datetime >= '2017-12-25 00:00:00.000000' 
  and t.datetime < '2017-12-26 00:00:00.000000' 
group by 1
;",,,"select j.first_name, j.last_name
from (
	 select c.ssn, c.first_name, c.last_name
	 from customers c
	 inner join credit_cards cc on c.ssn = cc.ssn
	 where 1=1 
	   and c.country = 'Singapore'
	   and cc.type = 'jcb'
	 group by 1,2,3
) as j
inner join (
	 select c.ssn, c.first_name, c.last_name
	 from customers c
	 inner join credit_cards cc on c.ssn = cc.ssn
	 where 1=1
	   and c.country = 'Singapore'
	   and cc.type = 'visa'
	 group by 1,2,3
) as v
on (j.ssn = v.ssn and j.first_name = v.first_name and j.last_name = v.last_name)",,,"select c.ssn as ssn, count(*) as cnt
from customers c  
left join credit_cards cc on c.ssn = cc.ssn  
where 1=1  
  and cc.ssn is not null
group by 1
union
select c.ssn as ssn, 0 as cnt
from customers c  
left join credit_cards cc on c.ssn = cc.ssn  
where 1=1  
  and cc.ssn is null
group by 1
;",,,"select c.ssn, cc.type, count(*) as cnt
from customers as c
left join credit_cards cc on c.ssn = cc.ssn
where 1=1
  and cc.ssn is not null
group by 1,2
union
select c.ssn, cc.type, 0 as cnt
from customers as c
left join credit_cards cc on c.ssn = cc.ssn
where 1=1
  and cc.ssn is null
group by 1,2
;",,,"select c.country as cntr_c
	 , count(distinct c.ssn) as cnt
from transactions t
inner join credit_cards cc on cc.number = t.number
inner join merchants m on m.code = t.code
inner join customers c on c.ssn = cc.ssn
where 1=1
  and c.country != m.country
group by 1
order by 1
;",,,"select cc.type, count(distinct t.identifier) as cnt
from transactions as t
inner join credit_cards as cc on cc.number = t.number 
group by 1
limit 1",,,"select t.identifier 
from (
	select cc.type, t.identifier
	from transactions as t
	inner join credit_cards as cc on cc.number = t.number 
	order by 1
	limit 1
) t",,,"select m.code, m.name
from transactions t 
inner join merchants m on m.code = t.code
inner join credit_cards cc on cc.number = t.number
where 1=1
  and (cc.type like '%visa%' or cc.type like '%diners-club%')
group by 1,2
having max(t.amount) < 888
;",,
A0231891A,"select 
  distinct cc.ssn 
from 
  credit_cards cc, 
  transactions t 
where 
  cc.number = t.number 
  and t.datetime BETWEEN TIMESTAMP '2017-12-25 00:00:00' 
  AND TIMESTAMP '2017-12-25 23:59:59' 
  and cc.type = 'visa';",,,"select a.first_name, a.last_name
from
	(select cc.ssn, c.first_name, c.last_name
	from customers c, credit_cards cc
	where c.ssn = cc.ssn
	and c.country = 'Singapore'
	and cc.type = 'jcb'
	group by cc.ssn, c.first_name, c.last_name
	intersect 
	select cc.ssn, c.first_name, c.last_name
	from customers c, credit_cards cc
	where c.ssn = cc.ssn
	and c.country = 'Singapore'
	and cc.type = 'visa'
	group by cc.ssn, c.first_name, c.last_name) a;",,,"select c.ssn, count(cc.number)
from customers c 
left outer join credit_cards cc 
on cc.ssn = c.ssn
group by c.ssn
order by c.ssn Asc, count Asc;",,,"select c.ssn, c.type, count(cc.number)
from( 
	(select ssn
	from customers) a
	cross join
	(select distinct type 
	from credit_cards) b
	) c
left join credit_cards cc 
on (cc.type, cc.ssn) =  (c.type, c.ssn)
group by c.ssn, c.type
order by c.ssn Asc, c.type Asc;",,,"select c.country, count(distinct c.ssn)
from customers c, merchants m, credit_cards cc, transactions t
where c.ssn = cc.ssn 
and cc.number = t.number
and t.code = m.code
and c.country <>m.country
group by c.country",,,"SELECT cc1.type, t1.identifier
from transactions t1, credit_cards cc1
where cc1.number = t1.number
and (cc1.type, t1.amount) in
	(SELECT cc2.type, max(t2.amount)
	from transactions t2, credit_cards cc2
	where  cc2.number = t2.number
	group by cc2.type)
order by cc1.type ASC, t1.identifier ASC;",,,"SELECT distinct cc1.type, t1.identifier
from credit_cards cc1, transactions t1
where cc1.number = t1.number
and t1.amount >= all(
	select t2.amount
	from credit_cards cc2, transactions t2
	where cc2.number = t2.number
	and cc1.type = cc2.type)
order by cc1.type ASC, t1.identifier ASC;",,,"select m.code, m.name
from merchants m 
except
select m.code, m.name
from transactions t, credit_cards cc, merchants m
where t.number = cc.number
and m.code = t.code 
and (cc.type like '%visa%' or cc.type like '%diners-club%')
and t.amount >= 888","Missing semicolon, CHECK CODE.","Missing semicolon, CHECK CODE."
A0231894X,"SELECT DISTINCT cu.ssn 
FROM customers cu, transactions t, credit_cards cc 
WHERE cu.ssn = cc.ssn 
AND cc.number = t.number 
AND t.datetime BETWEEN '2017-12-25' AND '2017-12-26' 
AND cc.type = 'visa';",,,"SELECT cu.first_name, cu.last_name 
FROM customers cu
WHERE cu.ssn = ANY(
	SELECT cc1.ssn 
	FROM credit_cards cc1, credit_cards cc2 
	WHERE cu.country = 'Singapore' 
	AND cc1.ssn = cc2.ssn 
	AND cc1.ssn = cu.ssn 
	AND cc1.type = 'visa' 
	AND cc2.type = 'jcb' 
);",,,"SELECT cu.ssn, COUNT(cc.number) 
FROM customers cu LEFT OUTER JOIN credit_cards cc 
ON cu.ssn = cc.ssn 
GROUP BY cu.ssn ;",,,"SELECT t2.ssn, t2.type, CASE WHEN t3.count ISNULL THEN 0 ELSE t3.count END AS t
FROM (
	SELECT cu.ssn, t1.type FROM customers cu, (
		SELECT DISTINCT type FROM credit_cards
	) AS t1
) AS t2 
LEFT OUTER JOIN (
	SELECT cu.ssn, cc.type, COUNT(cc.number) AS count
	FROM customers cu LEFT OUTER JOIN credit_cards cc
	ON cu.ssn = cc.ssn
	GROUP BY cu.ssn, cc.type
) AS t3
ON t2.ssn = t3.ssn
AND t2.type = t3.type;",,,"SELECT cu.country, COUNT(DISTINCT cc.ssn) 
FROM customers cu, credit_cards cc, merchants m, transactions t 
WHERE cu.ssn = cc.ssn 
AND cc.number = t.number 
AND m.code = t.code 
AND cu.country <> m.country 
GROUP BY cu.country;",,,"SELECT cc.type, t.identifier, t.amount 
FROM credit_cards cc, transactions t, (
	SELECT cc.type, MAX(t.amount) AS amount
	FROM credit_cards cc, transactions t 
	WHERE cc.number = t.number 
	GROUP BY cc.type 
) AS max_amount 
WHERE t.amount = max_amount.amount 
AND cc.type = max_amount.type 
AND cc.number = t.number;",,,"SELECT cc1.type, t1.identifier, t1.amount 
FROM credit_cards cc1, transactions t1 
WHERE cc1.number = t1.number
AND NOT EXISTS (
	SELECT *
	FROM credit_cards cc2, transactions t2 
	WHERE t1.amount < t2.amount 
	AND cc2.number = t2.number 
	AND cc1.type = cc2.type
);",,,"SELECT m.code, m.name 
FROM merchants m 
WHERE m.code NOT IN (
	SELECT m.code
	FROM merchants m, transactions t, credit_cards cc 
	WHERE cc.number = t.number 
	AND m.code = t.code 
	AND (cc.type LIKE 'visa%' OR cc.type LIKE 'diners-club%')
	AND t.amount >= 888 
);",,
A0231902R,"select c.ssn
from customers c, credit_cards cc, transactions t
where c.ssn = cc.ssn
and cc.number = t.number
and t.datetime >= '2017-12-24'
and t.datetime < '2017-12-25'
and cc.type = 'visa';",,,"select distinct c.first_name, c.last_name
from customers c, credit_cards cc
where c.ssn = cc.ssn
and cc.type = 'jcb' 
or cc.type = 'visa'
;",,,"select c.ssn, count(cc.type) as num
from customers c, credit_cards cc
where c.ssn = cc.ssn
group by c.ssn
union
select ssn, 0 as num
from customers
where ssn not in (
select distinct ssn
from credit_cards)
;",,,"select a.ssn,a.type,case when num is not null then num else 0 end as num
from 
(select distinct c.ssn,cc.type
from customers c, credit_cards cc) a
left join 
(select c.ssn,type,count(cc.type) as num
from customers c, credit_cards cc
where c.ssn = cc.ssn
group by c.ssn,type) b
on a.ssn=b.ssn
and a.type=b.type;",,,"select c.country, count(*) as num
from customers c
where exists(
select c.ssn
from customers c, credit_cards cc, merchants m, transactions t
where c.ssn = cc.ssn
and cc.number = t.number
and t.code = m.code
and c.country <> m.country)
group by c.country;",,,"select identifier,a.amount
from (select type,amount,identifier
from transactions t,credit_cards cc
where t.number=cc.number) a,
(select type,max(amount) as amount
from transactions t,credit_cards cc
where t.number=cc.number
group by type) b
where a.type=b.type
and a.amount=b.amount;",,,"select a.identifier
from 
(select identifier,type,amount
from transactions t,credit_cards cc
where t.number=cc.number)  a
where amount >= all (select amount
from transactions t,credit_cards cc
where t.number=cc.number
and type=a.type);",,,"select code,name
from merchants
where code not in (
select m.code
from merchants m,transactions t,credit_cards cc
where m.code=t.code
and cc.number=t.number
and type in (
select distinct type
from credit_cards
where type like 'diners-club%'
or type like 'visa%'
)
group by m.code
having max(amount)>=888);",,
A0231904M,"SELECT DISTINCT c.ssn
FROM customers AS c, credit_cards AS card, transactions AS t
WHERE c.ssn = card.ssn AND card.number = t.number
AND card.type = 'visa' 
AND t.datetime BETWEEN '2017-12-25' AND '2017-12-26';",,,"SELECT temp.first_name, temp.last_name
FROM (SELECT c.ssn, c.first_name, c.last_name
	    FROM customers AS c, credit_cards AS cards
		WHERE c.ssn = cards.ssn
		AND c.country = 'Singapore'
		AND cards.type = ('visa')
		INTERSECT
		SELECT c.ssn, c.first_name, c.last_name
		FROM customers AS c, credit_cards AS cards
		WHERE c.ssn = cards.ssn
		AND c.country = 'Singapore'
		AND cards.type = ('jcb')) AS temp
ORDER BY temp.first_name;",,,"SELECT c.ssn, COUNT(cards.number)
FROM customers AS c
LEFT JOIN credit_cards AS cards ON c.ssn = cards.ssn
GROUP BY c.ssn
ORDER BY COUNT(cards.number);",,,"SELECT temp1.ssn, temp2.type, COUNT(cards.number)
FROM (SELECT DISTINCT c.ssn
	  FROM customers AS c) AS temp1
	  CROSS JOIN
	  (SELECT DISTINCT cards.type
	  FROM credit_cards AS cards) AS temp2
LEFT JOIN credit_cards AS cards 
ON temp1.ssn = cards.ssn AND temp2.type = cards.type
GROUP BY temp1.ssn, temp2.type
ORDER BY temp1.ssn, temp2.type;",,,"SELECT c.country, COUNT (DISTINCT c.ssn)
FROM customers AS c, credit_cards AS card, 
     merchants AS m, transactions AS t
WHERE c.ssn = card.ssn AND card.number = t.number AND
      t.code = m.code
AND c.country != m.country
GROUP BY c.country;",,,"SELECT t.identifier
FROM transactions AS t, credit_cards AS cards, 
     (SELECT cards.type, MAX(amount) AS max_amount
		FROM transactions AS t, credit_cards AS cards
		WHERE t.number = cards.number
		GROUP BY cards.type) AS temp
WHERE t.number = cards.number
AND   t.amount = max_amount 
AND   cards.type = temp.type;",,,"SELECT t.identifier
FROM transactions AS t, credit_cards AS cards
WHERE t.number = cards.number
AND t.amount >= ALL(
		SELECT t2.amount
		FROM transactions AS t2, credit_cards AS cards2
		WHERE t2.number = cards2.number
		AND   cards.type = cards2.type);",,,"SELECT m.code, m.name
FROM merchants AS m, transactions AS t, credit_cards AS cards
WHERE m.code = t.code AND t.number = cards.number
EXCEPT
SELECT m.code, m.name
FROM merchants AS m, transactions AS t, credit_cards AS cards
WHERE m.code = t.code AND t.number = cards.number
AND (cards.type LIKE '%visa%' OR cards.type LIKE '%diners-club%')
AND t.amount >= 888
ORDER BY code;",,
A0231905L,"SELECT 
  DISTINCT cc.ssn 
FROM 
  credit_cards cc, 
  transactions tr 
WHERE 
  cc.number = tr.number 
  AND cc.type = 'visa' 
  AND tr.datetime :: date = '2017-12-25';",,,"SELECT 
  cu_names.first_name, 
  cu_names.last_name 
FROM 
  (
    SELECT 
      cu.first_name, 
      cu.last_name, 
      cu.ssn 
    FROM 
      customers cu, 
      credit_cards cc 
    WHERE 
      cu.ssn = cc.ssn 
      AND cu.country = 'Singapore' 
      AND cc.type = 'visa' 
    INTERSECT 
    SELECT 
      cu.first_name, 
      cu.last_name, 
      cu.ssn 
    FROM 
      customers cu, 
      credit_cards cc 
    WHERE 
      cu.ssn = cc.ssn 
      AND cu.country = 'Singapore' 
      AND cc.type = 'jcb'
  ) AS cu_names;",,,"SELECT 
  cu.ssn, 
  COUNT(cc.number) 
FROM 
  customers cu 
  LEFT JOIN credit_cards cc ON cu.ssn = cc.ssn 
GROUP BY 
  cu.ssn;",,,"SELECT 
  cc_list.ssn, 
  cc_list.type, 
  COALESCE (cc_count.card_count, 0) 
FROM 
  (
    SELECT 
      DISTINCT cc.type, 
      cu.ssn 
    FROM 
      customers cu, 
      credit_cards cc
  ) AS cc_list 
  LEFT JOIN (
    SELECT 
      cu.ssn, 
      cc.type, 
      COUNT(cc.number) AS card_count 
    FROM 
      customers cu 
      LEFT JOIN credit_cards cc ON cu.ssn = cc.ssn 
    GROUP BY 
      cu.ssn, 
      cc.type
  ) AS cc_count ON cc_count.ssn = cc_list.ssn 
  AND cc_count.type = cc_list.type 
ORDER BY 
  cc_list.ssn;",,,"SELECT 
  cu.country, 
  COUNT (DISTINCT cu.ssn) 
FROM 
  customers cu, 
  credit_cards cc, 
  transactions tr, 
  merchants me 
WHERE 
  cu.ssn = cc.ssn 
  AND cc.number = tr.number 
  AND tr.code = me.code 
  AND cu.country <> me.country 
GROUP BY 
  cu.country;",,,"SELECT 
  t.identifier 
FROM 
  transactions t, 
  credit_cards c, 
  (
    SELECT 
      cc.type, 
      MAX (tr.amount) AS maximum_amount 
    FROM 
      credit_cards cc, 
      transactions tr 
    WHERE 
      cc.number = tr.number 
    GROUP BY 
      cc.type
  ) as max_amounts 
WHERE 
  t.amount = max_amounts.maximum_amount 
  AND c.number = t.number 
  AND c.type = max_amounts.type;",,,"SELECT 
  tr.identifier
FROM 
  transactions tr, 
  credit_cards cc 
WHERE 
  tr.number = cc.number 
  AND NOT EXISTS (
    SELECT 
      1 
    FROM 
      transactions tr2, 
      credit_cards cc2 
    WHERE 
      cc2.number = tr2.number 
      AND tr2.amount > tr.amount 
      AND cc2.type = cc.type
  );",,,"SELECT 
  me.code, 
  me.name 
FROM 
  merchants me 
EXCEPT 
SELECT 
  me.code, 
  me.name 
FROM 
  merchants me, 
  transactions tr, 
  credit_cards cc 
WHERE 
  me.code = tr.code 
  AND tr.number = cc.number 
  AND tr.amount >= 888 
  AND (
    cc.type LIKE 'visa%' 
    OR cc.type LIKE 'diners-club%'
  );",,
A0231906J,"SELECT DISTINCT c.ssn
FROM credit_cards cr, transactions t, customers c
WHERE cr.number = t.number
AND c.ssn = cr.ssn
AND cr.type = 'visa'
AND DATE(t.datetime) ='2017-12-25';",,,"SELECT set.first_name, set.last_name
FROM (SELECT cr.ssn, c.first_name, c.last_name
	  FROM customers c, credit_cards cr
	  WHERE c.ssn = cr.ssn
	  AND c.country = 'Singapore'
	  AND cr.type ='visa'
	  INTERSECT
	  SELECT cr.ssn, c.first_name, c.last_name
	  FROM customers c, credit_cards cr
	  WHERE c.ssn = cr.ssn
	  AND c.country = 'Singapore'
	  AND cr.type ='jcb') set;",,,"SELECT cr.ssn,  (CASE WHEN count(*) IS NULL THEN 0 ELSE count(*) END)
FROM customers c LEFT OUTER JOIN credit_cards cr ON c.ssn = cr.ssn
GROUP BY cr.ssn;",,,"SELECT c1.ssn, cr1.type, count(cr2.number)
FROM (SELECT DISTINCT c.ssn
	  FROM customers c) AS c1
	  CROSS JOIN
	 (SELECT DISTINCT cr.type
	  FROM credit_cards cr) AS cr1
LEFT OUTER JOIN credit_cards cr2 ON cr1.type = cr2.type
AND c1.ssn = cr2.ssn
GROUP BY c1.ssn, cr1.type
ORDER BY c1.ssn, cr1.type;",,,"SELECT c.country, count(DISTINCT c.ssn) AS customers_count
FROM customers c, merchants m, transactions t, credit_cards cr
WHERE cr.number = t.number
AND t.code = m.code
AND c.ssn = cr.ssn
AND NOT c.country = m.country
GROUP BY c.country;",,,"SELECT t.identifier
FROM transactions t, credit_cards cr, (
	SELECT cr.type, MAX(t.amount) AS max
	FROM transactions t, credit_cards cr
	WHERE cr.number = t.number
	GROUP BY cr.type)m
WHERE t.number = cr.number
AND cr.type = m.type
AND t.amount = max;",,,"SELECT t.identifier
FROM transactions t, credit_cards cr
WHERE t.amount >= ALL (
	SELECT t2.amount
	FROM transactions t2, credit_cards cr2
	WHERE t2.number = cr2.number
	AND cr.type = cr2.type)
AND t.number = cr.number;",,,"SELECT DISTINCT m.code, m.name
FROM merchants m, transactions t, credit_cards cr
WHERE m.code = t.code
AND cr.number = t.number
EXCEPT
SELECT DISTINCT m.code, m.name
FROM merchants m, transactions t, credit_cards cr
WHERE m.code = t.code
AND cr.number = t.number
AND (t.amount >= 888)
AND (cr.type LIKE '%visa%' OR cr.type LIKE '%diners-club%');",,
A0231907H,"SELECT DISTINCT c.ssn
FROM customers c, credit_cards cd, transactions t
WHERE EXTRACT(YEAR FROM t.datetime) = '2017'
AND EXTRACT(MONTH FROM t.datetime) = '12'
AND EXTRACT(DAY FROM t.datetime) = '25'
AND cd.number = t.number
AND c.ssn = cd.ssn
AND cd.type = 'visa'",,,"SELECT c.first_name, c.last_name
FROM (SELECT c1.ssn, c1.first_name, c1.last_name
      FROM  customers c1 
	  LEFT JOIN credit_cards cd1 ON c1.ssn = cd1.ssn
      WHERE c1.country = 'Singapore'
      AND cd1.type = 'jcb'
      INTERSECT
      SELECT c2.ssn, c2.first_name, c2.last_name
      FROM customers c2 
	  LEFT JOIN credit_cards cd2 ON c2.ssn = cd2.ssn
      WHERE c2.country = 'Singapore'
      AND cd2.type = 'visa') AS c
ORDER BY c.first_name",,,"SELECT c.ssn, count(*)
FROM customers c
LEFT JOIN  credit_cards cd ON c.ssn = cd.ssn
GROUP BY c.ssn
ORDER BY c.ssn",,,"SELECT c.ssn,cd.type,count(cd2.number) as num_of_cards
FROM (SELECT DISTINCT c1.ssn FROM customers c1) AS c
      CROSS JOIN 
      (SELECT DISTINCT cd1.type FROM credit_cards cd1) AS cd
      LEFT JOIN credit_cards cd2 
	  ON cd2.ssn = c.ssn AND cd2.type = cd.type
GROUP BY c.ssn, cd.type",,,"SELECT c.country, count(DISTINCT c.ssn) AS num
FROM customers c
LEFT JOIN credit_cards cd ON c.ssn = cd.ssn
LEFT JOIN transactions t ON cd.number = t.number
LEFT JOIN merchants m ON t.code = m.code
WHERE c.country <> m.country
GROUP BY c.country",,,"SELECT t1.identifier, cd1.type
FROM transactions t1, credit_cards cd1
WHERE t1.number = cd1.number
AND t1.amount = ALL (
  SELECT MAX(t2.amount)
  FROM transactions t2, credit_cards cd2
  WHERE t2.number = cd2.number
  AND cd1.type = cd2.type)",,,"SELECT t1.identifier, cd1.type
FROM transactions t1, credit_cards cd1
WHERE t1.number = cd1.number
AND t1.amount >= ALL (
  SELECT t2.amount
  FROM transactions t2, credit_cards cd2
  WHERE t2.number = cd2.number
  AND cd1.type = cd2.type)",,,"SELECT m.code, m.name
FROM merchants m 
WHERE m.code NOT IN
  (SELECT m1.code
   FROM merchants m1, transactions t1, credit_cards cd1
   WHERE t1.code = m1.code
   AND t1.number = cd1.number
   AND t1.amount >= 888
   AND cd1.type like '%visa%')
INTERSECT
SELECT m.code, m.name
FROM merchants m 
WHERE m.code NOT IN
   (SELECT m2.code
   FROM merchants m2, transactions t2, credit_cards cd2
   WHERE t2.code = m2.code
   AND t2.number = cd2.number
   AND t2.amount >= 888
   AND cd2.type like '%diners-club%')
*
SELECT DISTINCT cd.type FROM credit_cards cd
WHERE cd.type like '&diners-club%'
OR cd.type like '%visa%'
OUTPUT: visa visa-electron
*/","Missing semicolon, CHECK CODE.","Missing semicolon, CHECK CODE."
A0231908E,"select distinct c.ssn
from customers as c, credit_cards as d, transactions as t
where c.ssn=d.ssn
and d.number=t.number
and date(t.datetime) = '2017-12-25'
and d.type = 'visa';",,,"select temp.first_name,temp.last_name,temp.ssn
from
(select c.first_name,c.last_name,c.ssn
from customers c, credit_cards d
where c.ssn=d.ssn
and d.type = 'visa'
and c.country='Singapore'
intersect
select c.first_name,c.last_name,c.ssn
from customers c, credit_cards d
where c.ssn=d.ssn
and d.type = 'jcb'
and c.country='Singapore') as temp
order by temp.first_name,temp.last_name;",,,"select c.ssn,
(CASE WHEN count(d.number) IS NULL
THEN 0
ELSE count(d.number) END) as cards_owned
from customers c left join credit_cards d
on c.ssn=d.ssn
group by c.ssn
order by cards_owned;
select c.ssn,count(d.number) as cards_owned
from customers c left join credit_cards d
on c.ssn=d.ssn
group by c.ssn
order by cards_owned;",,,"* 	
another answers: 
select main.ssn, main.type, count(main.number) cards_owned
from (select distinct temp.ssn,temp.type,d.number from
(
(select distinct ssn from customers ) as customers cross join
(select distinct type from credit_cards) as cards_type
) temp
left join
credit_cards d
on temp.ssn=d.ssn
and temp.type=d.type) main 
group by main.ssn,main.type
*/
select main.ssn, main.type,
coalesce(sub.cards_owned, 0) as cards_owned 
from
(select distinct c.ssn,cards_type.type
from customers c,
(select distinct type
from credit_cards) as cards_type) main
left join
(select c.ssn,d.type,count(*) as cards_owned
from customers c,credit_cards d
where c.ssn=d.ssn
group by c.ssn, d.type
order by cards_owned,c.ssn,d.type) sub
on main.ssn=sub.ssn
and main.type=sub.type
order by main.ssn,main.type,cards_owned;",,,"select temp.customer_country,count(distinct temp.ssn) number 
from
(select c.ssn,c.country customer_country,d.number,m.code,m.country merchant_country
from customers c,credit_cards d,merchants m,transactions t
where c.ssn=d.ssn
and d.number=t.number
and t.code=m.code) temp
where temp.customer_country != temp.merchant_country
group by temp.customer_country;",,,"*
select d.type,t.identifier
from transactions t,credit_cards d
where t.number=d.number
and t.amount = all
(select max(t1.amount)
from transactions t1,credit_cards d1
where t1.number=d1.number
group by d1.type
having d.type=d1.type);                                                                      */
select d.type,t.identifier
from transactions t,credit_cards d
where t.number=d.number
and (d.type,t.amount) in
(select d1.type,max(t1.amount)
from transactions t1,credit_cards d1
where t1.number=d1.number
group by d1.type);",,,"select d.type,t.identifier
from transactions t,credit_cards d
where t.number=d.number
and t.amount >= all (
select t1.amount
from transactions t1,credit_cards d1
where t1.number=d1.number
and d.type=d1.type);",,,"select distinct m.name, m.code
from merchants m
where not exists(
select t.amount
from transactions t,credit_cards d
where t.number=d.number
and (d.type like '%visa%'
or d.type like '%diners-club%')
and t.amount >= 888
and m.code=t.code);",,
A0231909A,"SELECT DISTINCT c.ssn
FROM credit_cards c
INNER JOIN transactions t ON c.number = t.number
WHERE c.type = 'visa'
AND t.datetime between '2017-12-25' AND '2017-12-26';",,,"SELECT m.first_name, m.last_name
FROM customers m
INNER JOIN credit_cards c ON m.ssn = c.ssn
WHERE m.country = 'Singapore'
AND c.type in ('jcb', 'visa')
GROUP BY m.ssn, m.first_name, m.last_name
HAVING COUNT(DISTINCT c.type) = 2;",,,"SELECT m.ssn, COUNT(c.number)
FROM customers m
LEFT outer JOIN credit_cards c ON m.ssn = c.ssn
GROUP BY m.ssn;",,,"SELECT m.ssn, c.type, COUNT(c.number)
FROM customers m
LEFT outer JOIN credit_cards c ON m.ssn = c.ssn
GROUP BY m.ssn, c.type;",,,"SELECT u.country, COUNT(DISTINCT u.ssn)
FROM customers u
INNER JOIN credit_cards c ON u.ssn = c.ssn
INNER JOIN transactions t ON t.number = c.number
INNER JOIN merchants m ON m.code = t.code
WHERE u.country <> m.country
GROUP BY u.country;",,,"SELECT t.identifier, c.type
FROM transactions t
INNER JOIN credit_cards c ON t.number = c.number
INNER JOIN (
    SELECT c.type, MAX(t.amount) AS max_amount
    FROM transactions t
    INNER JOIN credit_cards c ON t.number = c.number
    GROUP BY c.type
) AS a ON c.type = a.type
WHERE t.amount = a.max_amount;",,,"SELECT identifier, type
FROM
(
    SELECT t.identifier, c.type
        , dense_rank() over(partition BY c.type ORDER BY t.amount desc) AS amount_rank
    FROM transactions t
    INNER JOIN credit_cards c ON t.number = c.number
) AS a
WHERE a.amount_rank = 1;",,,"SELECT code, name
FROM merchants m
WHERE NOT EXISTS(
	SELECT t.identifier
	FROM transactions t
	INNER JOIN credit_cards c ON t.number = c.number
	WHERE t.code = m.code
	AND t.amount >= 888
	AND (c.type LIKE '%visa%' OR c.type LIKE '%diners-club%')
);",,
A0231912N,"SELECT DISTINCT cc.ssn
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
AND t.datetime >= '2017-12-25 00:00:00.000000' AND t.datetime <'2017-12-26 00:00:00.000000'
AND cc.type LIKE '%visa%';",,,"SELECT subtable.first_name, subtable.last_name
FROM
(SELECT DISTINCT cc.ssn, c.last_name, c.first_name
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn
AND cc.type LIKE '%visa%' 
INTERSECT
SELECT DISTINCT c.ssn,c.last_name, c.first_name
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn
AND cc.type LIKE '%jcb%') as subtable
ORDER BY subtable.first_name;",,,"SELECT c.ssn,coalesce(m.count,0) AS number
FROM
(SELECT cc.ssn,COUNT(*) 
FROM credit_cards cc
GROUP BY cc.ssn  )AS m 
RIGHT JOIN customers c
ON m.ssn =c.ssn
ORDER BY COUNT desc
*SELECT c.ssn 
FROM customers c
WHERE c.ssn NOT IN(
	SELECT cc.ssn
	FROM credit_cards cc)	
*/",,,"SELECT DISTINCT atp.ssn,atp.type,coalesce(tp.count,0)
FROM
(SELECT DISTINCT cc.ssn,cc.type, COUNT(cc.type)
FROM credit_cards cc
GROUP BY cc.ssn, cc.type) as tp
RIGHT JOIN
(SELECT DISTINCT c.ssn,cc.type
FROM customers c,credit_cards cc
ORDER BY c.ssn) AS atp
ON tp.ssn = atp.ssn AND tp.type = atp.type
ORDER BY atp.ssn,atp.type;",,,"SELECT tb.c1, count(*)
FROM 
(select c.ssn,c.country as c1,m.country as c2 ,t.identifier
FROM customers c, credit_cards cc, transactions t, merchants m
WHERE c.ssn=cc.ssn
AND cc.number =t.number
AND t.code=m.code) as tb
WHERE tb.c1!=tb.c2
GROUP BY tb.c1;",,,"SELECT t2.identifier
FROM transactions t2, credit_cards cc2,
(SELECT cc.type, MAX(t.amount)
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
GROUP BY cc.type) AS maxtable
WHERE maxtable.max = t2.amount
AND maxtable.type = cc2.type
AND t2.number = cc2.number",,,"SELECT t2.identifier
FROM transactions t2, credit_cards cc2,
(SELECT DISTINCT ON(gt.TYPE) *
FROM
(SELECT cc.type, t.amount
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
ORDER BY cc.type,t.amount desc)AS gt ) AS gt2
WHERE gt2.amount = t2.amount
AND gt2.type = cc2.type
AND t2.number = cc2.number",,,"SELECT m.code,m.name
FROM 
(SELECT *
FROM credit_cards
WHERE type LIKE '%visa' OR type LIKE '%diners-club%') AS cc, 
merchants m,
(SELECT *
FROM transactions  
WHERE amount<=888) AS t 
WHERE 
cc.number = t.number
AND m.code =t.code","Missing semicolon, CHECK CODE.","Missing semicolon, CHECK CODE."
A0231915J,"select distinct c.ssn
from customers c inner join credit_cards b on c.ssn=b.ssn inner join transactions t on t.number=b.number
where b.type='visa' and to_date(t.datetime::text,'YYYY-MM-DD')='2017-12-25';",,,"select c.first_name,c.last_name
from customers c,credit_cards b,credit_cards a
where c.ssn=b.ssn and c.ssn=a.ssn and b.type='jcb' and a.type='visa' and c.country='Singapore'
group by c.ssn,c.first_name,c.last_name;",,,"select c.ssn,count(b.number)
from customers c left outer join credit_cards b
on c.ssn=b.ssn
group by c.ssn
order by c.ssn;",,,"create view DType As
select distinct(b1.type) from credit_cards b1;
select c.ssn,d.type,count(b.number)
from customers c cross join DType d left join credit_cards b on c.ssn=b.ssn and d.type=b.type
group by c.ssn,d.type
order by c.ssn;",,,"select c.country,count(distinct c.ssn) 
from customers c inner join credit_cards b on c.ssn=b.ssn inner join transactions t on b.number=t.number inner join merchants m on m.code=t.code
where c.country != m.country
group by c.country;",,,"select t.identifier
from credit_cards b inner join transactions t on b.number=t.number
where t.amount=any(select T1.Amount from (select b1.type AS Type,MAX(t1.amount) AS Amount 
														 from credit_cards b1 inner join transactions t1 on b1.number=t1.number where b1.type=b.type
														 group by b1.type)AS T1);",,,"select t.identifier
from credit_cards b inner join transactions t on b.number=t.number
where t.amount>=ALL (select t1.amount from transactions t1 inner join credit_cards b1 on b1.number=t1.number where b.type=b1.type);",,,"select m.code,m.name
from credit_cards b inner join transactions t on b.number=t.number inner join merchants m on m.code=t.code
where position ('visa' in b.type)>0 or position ('diners-club' in b.type)>0 
group by m.code,m.name
having MAX(t.amount)<888;",,
A0231917E,"SELECT DISTINCT c.ssn
FROM credit_cards c, transactions t
WHERE c.number = t.number
AND c.type = 'visa'
AND t.datetime BETWEEN '2017-12-25 00:00:00' AND '2017-12-25 23:59:59'",,,"SELECT DISTINCT a.first_name, a.last_name, a.ssn
FROM customers a, credit_cards c
WHERE a.ssn = c.ssn
AND a.country = 'Singapore'
AND c.type = 'jcb'
INTERSECT
SELECT DISTINCT a.first_name, a.last_name, a.ssn
FROM customers a, credit_cards c
WHERE a.ssn = c.ssn
AND a.country = 'Singapore'
AND c.type = 'visa'",,,"SELECT DISTINCT a.ssn, 
(CASE WHEN c.ssn IS NULL THEN '0' ELSE COUNT(*) END) AS cardnumber
FROM customers a LEFT OUTER JOIN credit_cards c ON a.ssn = c.ssn
GROUP BY a.ssn,c.ssn
ORDER BY a.ssn",,,"SELECT ak.ssn, ak.type,
(CASE WHEN c3.type IS NULL THEN '0' ELSE COUNT(*) END) AS cardnumber
FROM	(SELECT c2.type, c2.ssn
		FROM (SELECT DISTINCT c.type
	 		FROM credit_cards c) AS c1 
	 		LEFT OUTER JOIN 
	 		(SELECT DISTINCT a.ssn, c.type
	 		FROM customers a, credit_cards c) AS c2
		 	ON c1.type = c2.type) AS ak 
		LEFT OUTER JOIN credit_cards c3
		ON ak.ssn = c3.ssn AND ak.type = c3.type
GROUP BY ak.ssn, ak.type,c3.type",,,"SELECT DISTINCT am.country, COUNT(*)
FROM (
	SELECT DISTINCT a.ssn, a.country
	FROM customers a, credit_cards c, merchants m, transactions t
	WHERE a.ssn = c.ssn AND c.number = t.number AND t.code = m.code
	AND m.country <> a.country
	GROUP BY a.ssn, a.country, m.country) AS am
GROUP BY am.country",,,"SELECT DISTINCT t2.identifier 
FROM (
	SELECT DISTINCT c1.type, MAX(t1.amount)
	FROM credit_cards c1 JOIN transactions t1 ON c1.number = t1.number
	GROUP BY c1.type) AS c1t1, transactions t2, credit_cards c2
WHERE c1t1.max = t2.amount
AND c1t1.type = c2.type
AND t2.number = c2.number",,,"SELECT t2.identifier
FROM (
	(SELECT t.identifier,
	MAX(t.amount) OVER (partition by c.type) AS maxi
	FROM transactions t JOIN credit_cards c ON t.number = c.number) AS t1
	JOIN transactions t2 ON t1.maxi = t2.amount AND t1.identifier = t2.identifier)",,,"SELECT DISTINCT m.code, m.name
FROM merchants m
EXCEPT
SELECT DISTINCT vd.code, vd.name
FROM (
	SELECT t.amount, c.type, m.name, m.code
	FROM merchants m, transactions t, credit_cards c
	WHERE m.code = t.code
	AND t.number = c.number
	AND t.amount >= 888
	AND c.type LIKE 'visa%'
	UNION
	SELECT t.amount, c.type, m.name, m.code
	FROM merchants m, transactions t, credit_cards c
	WHERE m.code = t.code
	AND t.number = c.number
	AND t.amount >= 888
	AND c.type LIKE '%diners-club%') AS vd","Missing semicolon, CHECK CODE.","Missing semicolon, CHECK CODE."
A0231918A,"SELECT DISTINCT c.ssn
FROM customers c, credit_cards cc, transactions t
WHERE c.ssn = cc.ssn
AND cc.number = t.number
AND date(t.datetime) = '2017-12-25'
AND cc.type = 'visa';",,,"SELECT a.first_name, a.last_name
FROM (
	SELECT c.ssn, c.first_name, c.last_name
	FROM customers c, credit_cards cc
	WHERE c.ssn = cc.ssn
	AND c.country = 'Singapore'
	AND cc.type = 'jcb'
	INTERSECT
	SELECT c.ssn, c.first_name, c.last_name
	FROM customers c, credit_cards cc
	WHERE c.ssn = cc.ssn
	AND c.country = 'Singapore'
	AND cc.type = 'visa'
	) a;",,,"SELECT c.ssn, COUNT(cc.number)
FROM customers c
LEFT OUTER JOIN credit_cards cc
ON c.ssn = cc.ssn
GROUP BY c.ssn
ORDER BY COUNT(cc.number);",,,"SELECT a.ssn, a.type, COUNT(cc1.number)
FROM (
	SELECT c.ssn, cc.type
	FROM customers c, (
		SELECT DISTINCT type
		FROM credit_cards
	) cc
) a
LEFT JOIN credit_cards cc1
ON (a.ssn, a.type) = (cc1.ssn, cc1.type)
GROUP BY a.ssn, a.type
ORDER BY a.ssn, a.type;",,,"SELECT c.country, COUNT(DISTINCT c.ssn)
FROM customers c, credit_cards cc, merchants m, transactions t
WHERE cc.number = t.number
AND m.code = t.code
AND c.ssn = cc.ssn
AND c.country <> m.country
GROUP BY c.country;",,,"SELECT t.identifier
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
AND (cc.type, t.amount) IN (
	SELECT cc1.type, MAX(t1.amount)
	FROM credit_cards cc1, transactions t1
	WHERE cc1.number = t1.number
	GROUP BY cc1.type);",,,"SELECT t.identifier
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
AND t.amount >= ALL(
	SELECT t1.amount
	FROM credit_cards cc1, transactions t1
	WHERE cc1.number = t1.number
	AND cc1.type = cc.type);",,,"SELECT DISTINCT code, name
FROM merchants
WHERE (code, name) NOT IN (
	SELECT DISTINCT m.code, m.name
	FROM merchants m, transactions t, (
		SELECT *
		FROM credit_cards
		WHERE type LIKE 'visa%'
		OR type LIKE 'diners-club%'
		) cc
	WHERE m.code = t.code
	AND t.number = cc.number
	GROUP BY m.code, cc.type
	HAVING MAX(t.amount) >= 888
);",,
A0231919B,"select distinct c.ssn from customers c, credit_cards cc, transactions t
where c.ssn = cc.ssn
and cc.number = t.number
and cc.type = 'visa'
and date(t.datetime) = '2017-12-25';",,,"select c.first_name, c.last_name, count(cc.type) from customers c, credit_cards cc
where c.ssn = cc.ssn
and c.country = 'Singapore'
and (cc.type = 'jcb' or cc.type = 'visa')
group by c.first_name, c.last_name, c.ssn 
having count(distinct cc.type) >1;",,,"select c.ssn, case when count(cc.number) is null then 0 else count(cc.number) end
from customers c 
left join credit_cards cc
on c.ssn = cc.ssn
group by c.ssn;",,,"select ct.ssn, ct.type, case when count(cc.type) is null then 0 else count(cc.type) end
from (
	select distinct c.ssn, cc.type
	from customers c, credit_cards cc) as ct
left join credit_cards cc
on ct.ssn = cc.ssn
and ct.type = cc.type
group by ct.ssn, ct.type
order by ct.ssn;",,,"select c.country, count(distinct c.ssn)
from customers c, credit_cards cc, merchants m, transactions t
where c.ssn = cc.ssn
and cc.number = t.number
and m.code = t.code
and m.country <> c.country
group by c.country;",,,"select t.identifier
from transactions t
inner join credit_cards cc 
on cc.number = t.number
inner join(
	select cc.type as type, max(t.amount) as amount 
	from transactions t, credit_cards cc
	where cc.number = t.number 
	group by cc.type) mm
on cc.type = mm.type
and t.amount = mm.amount;",,,"select t1.identifier
from transactions t1
inner join credit_cards cc1 
on cc1.number = t1.number
where not exists(
	select t2.identifier
	from transactions t2
	inner join credit_cards cc2
	on cc2.number = t2.number
	where t1.amount<t2.amount
	and cc1.type = cc2.type);",,,"select distinct m.code, m.name
from merchants m
where m.code not in (
	select m.code
	from merchants m, transactions t, credit_cards cc
	where m.code = t.code
	and t.number = cc.number
	and t.amount >= 888
	and (cc.type like '%visa%' or cc.type like '%diners-club%'));",,
A0231921N,"SELECT DISTINCT cc.ssn
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
    AND cc.type = 'visa' 
    AND date(t.datetime) = '2017-12-25'
;",,,"WITH jcb_ssn AS (
    SELECT DISTINCT cc.ssn
    FROM credit_cards cc
    WHERE cc.type = 'jcb'),
    visa_ssn AS
    (SELECT DISTINCT cc.ssn
    FROM credit_cards cc
    WHERE cc.type = 'visa')
SELECT ct.first_name, ct.last_name
FROM jcb_ssn jcb, visa_ssn vs, customers ct
WHERE jcb.ssn = vs.ssn 
    AND vs.ssn = ct.ssn
    AND ct.country = 'Singapore'
;",,,"SELECT ct.ssn, COUNT(cc.number)
FROM customers ct LEFT JOIN credit_cards cc
    ON ct.ssn = cc.ssn
GROUP BY ct.ssn
;",,,"WITH cardtypes AS(
	SELECT DISTINCT type
	FROM credit_cards cc)
SELECT ct.ssn, typ.type, count(cc.number)
FROM customers ct
	CROSS JOIN cardtypes typ 
	LEFT JOIN credit_cards cc
	ON ct.ssn = cc.ssn
	AND typ.type = cc.type
GROUP BY ct.ssn, typ.type
ORDER BY ct.ssn, typ.type
;",,,"SELECT ct.country AS buyer_country, COUNT (DISTINCT ct.ssn) AS bought_overseas
FROM transactions t, credit_cards cc, customers ct, merchants m
WHERE t.number = cc.number
    AND cc.ssn = ct.ssn
	AND t.code = m.code
	AND ct.country <> m.country
GROUP BY ct.country
;",,,"WITH max_by_card_type AS 
	(SELECT cc.type, MAX(amount) as amount
	FROM transactions t, credit_cards cc
	WHERE t.number = cc.number
	GROUP BY cc.type)
SELECT t.identifier
FROM transactions t, max_by_card_type mx, credit_cards cc
WHERE t.number = cc.number
	AND cc.type = mx.type
	AND t.amount = mx.amount
;",,,"SELECT trank.identifier
FROM (SELECT t.identifier, t.amount, cc.type, RANK() OVER(PARTITION BY cc.type ORDER BY t.amount DESC) rank
	FROM transactions t, credit_cards cc
	WHERE t.number = cc.number) AS trank
WHERE trank.rank = 1
ORDER BY trank.identifier
;",,,"SELECT m.code, m.name
FROM merchants m
WHERE m.code NOT IN (
	SELECT DISTINCT m.code
	FROM transactions t, merchants m, credit_cards cc
	WHERE t.number = cc.number
		AND t.code = m.code
		AND t.amount >=888
		AND (cc.type LIKE '%visa%' OR cc.type LIKE '%diners-club%')
	)
;",,
A0231922M,"SELECT distinct c.ssn
FROM customers c, transactions t,credit_cards cc
WHERE c.ssn = cc.ssn
and cc.number = t.number
and t.datetime between '2017-12-25 00:00:01' AND '2017-12-26 00:00:00'
and cc.type ='visa';",,,"SELECT  c.first_name, c.last_name
FROM customers c,credit_cards cc1, credit_cards cc2
WHERE c.ssn = cc1.ssn
and c.ssn = cc2.ssn
and c.country = 'Singapore'
and cc1.type = 'visa'
and cc2.type ='jcb'
group by c.ssn;",,,"SELECT c.ssn, count (cc.number) as num_cards
FROM customers c left outer join credit_cards cc 
on c.ssn = cc.ssn
group by c.ssn
order by  num_cards asc;",,,"SELECT c.ssn, temp.type, count(cc.number)
FROM customers c 
left outer join 
(SELECT c.ssn, cards.type
FROM customers c, (select distinct cc.type from credit_cards cc) as cards) as temp
on c.ssn = temp.ssn
left outer join credit_cards cc on c.ssn = cc.ssn
and temp.type = cc.type
group by  c.ssn, temp.type
order by c.ssn,temp.type;",,,"SELECT c.country,count(distinct c.ssn) as num_cust_buy_elsewhere
FROM customers c, merchants m, transactions t, credit_cards cc
WHERE t.code = m.code
and t.number = cc.number
and cc.ssn = c.ssn
and c.country <> m.country
group by c.country
order by c.country;",,,"select t1.identifier, temp.type, temp.max_amt
from
	(select cc.type, max( t.amount) as max_amt
	FROM transactions t, credit_cards cc
	WHERE t.number = cc.number
	group by cc.type
	) as temp, transactions t1,credit_cards cc1
where t1.amount = temp.max_amt
and t1.number = cc1.number
and cc1.type = temp.type
order by temp.type;",,,"select t1.identifier,cc1.type,t1.amount
from transactions t1, credit_cards cc1
where cc1.number = t1.number 
and t1.amount >= all
	(select t2.amount
	from transactions t2, credit_cards cc2
	where cc2.number = t2.number
	and cc1.type = cc2.type)
order by cc1.type;",,,"select m.code, m.name
from merchants m
where not exists (
select *
from transactions t, credit_cards cc 
where cc.number = t.number 
and m.code = t.code
and t.amount >= 888
and (cc.type like 'visa%' or cc.type like 'diners-club%'));",,
A0231929Y,"SELECT c.ssn
FROM customers c, transactions t, credit_cards cc
WHERE c.ssn = cc.ssn
AND t.number = cc.number
AND t.datetime >= '2017-12-25'
AND t.datetime < '2017-12-26'
AND cc.type = 'visa';",,,"SELECT DISTINCT c.first_name, c.last_name 
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn
AND cc.type = 'visa'
AND c.country = 'Singapore'
UNION
SELECT DISTINCT c.first_name, c.last_name 
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn
AND cc.type = 'jcb'
AND c.country = 'Singapore';",,,"SELECT cc.ssn, COUNT(cc.number) AS count
FROM credit_cards cc, customers c
WHERE c.ssn = cc.ssn
GROUP BY cc.ssn
UNION
SELECT cc.ssn, 0 AS count
FROM credit_cards cc LEFT OUTER JOIN customers c
ON c.ssn = cc.ssn
WHERE cc.number ISNULL;",,,"SELECT cc.ssn, cc.type, COUNT(cc.type) AS count
FROM credit_cards cc, customers c
WHERE c.ssn = cc.ssn
GROUP BY cc.ssn,cc.type
UNION
SELECT cc.ssn, cc.type, 0 AS count
FROM credit_cards cc LEFT OUTER JOIN customers c
ON c.ssn = cc.ssn
WHERE cc.number ISNULL;",,,"SELECT c.country, COALESCE(COUNT(c.ssn),0) AS count
FROM customers c, merchants m, credit_cards cc, transactions t
WHERE c.country <> m.country
AND t.number = cc.number
AND t.code = m.code
AND cc.ssn = c.ssn
GROUP BY c.country;",,,"SELECT t1.identifier, t1.amount
FROM credit_cards cc, transactions t1
WHERE cc.number = t1.number
AND t1.amount = (SELECT MAX(amount) 
                FROM credit_cards cc2, transactions t2
                WHERE cc2.number = t2.number
                AND cc2.type = cc.type
                );",,,"SELECT t1.identifier, t1.amount
FROM credit_cards cc, transactions t1
WHERE cc.number = t1.number
AND t1.amount = (SELECT t2.amount
                FROM credit_cards cc2, transactions t2
                WHERE cc2.number = t2.number
                AND cc2.type = cc.type
				ORDER BY t2.amount DESC
				LIMIT 1);",,,"SELECT DISTINCT m.code, m.name
FROM merchants m
WHERE (m.code, m.name) NOT IN (
	SELECT DISTINCT m.code, m.name
	FROM merchants m, transactions t, (
  		SELECT *
  		FROM credit_cards
  		WHERE type LIKE 'visa%'
  		OR type LIKE 'diners-club%') cc
	WHERE t.number = cc.number
	AND m.code = t.code
	AND t.amount >= 888)","Missing semicolon, CHECK CODE.","Missing semicolon, CHECK CODE."
A0231930N,"SELECT DISTINCT(c.ssn)
FROM customers c, credit_cards cc, transactions t
WHERE c.ssn = cc.ssn
AND t.number = cc.number
AND cc.type = 'visa'
AND DATE(t.datetime) = '2017-12-25';",,,"SELECT DISTINCT first_name,last_name
FROM customers AS x1
INNER JOIN credit_cards AS c1 ON x1.ssn = c1.ssn
WHERE c1.type = 'visa'
AND country = 'Singapore'
INTERSECT
SELECT DISTINCT first_name,last_name
FROM customers AS x2
INNER JOIN credit_cards AS c2 ON x2.ssn = c2.ssn
WHERE c2.type = 'jcb'
AND country = 'Singapore';",,,"SELECT c.ssn, count(cc.number) AS cards_owned
FROM customers c
LEFT JOIN credit_cards cc
ON c.ssn = cc.ssn
GROUP BY c.ssn;",,,"SELECT cc.type, c.ssn,
CASE
	WHEN COUNT(cc.type) > 0 THEN COUNT(cc.type)
	ELSE 0
END overall_count
FROM credit_cards cc, customers c
WHERE c.ssn = cc.ssn
GROUP BY c.first_name, c.last_name, cc.type, c.ssn
ORDER BY overall_count DESC;",,,"SELECT customers.country, COUNT (DISTINCT customers.ssn) FROM customers, credit_cards, merchants, transactions
WHERE customers.ssn = credit_cards.ssn AND credit_cards.number = transactions.number
AND transactions.code = merchants.code AND customers.country <> merchants.country
GROUP BY customers.country;",,,"SELECT identifier
FROM transactions t1
JOIN credit_cards cc1
ON t1.number = cc1.number
JOIN(
    SELECT type, MAX(amount) AS max_per_type
    FROM credit_cards cc2, transactions t2
    WHERE t2.number = cc2.number
    GROUP BY type
    ) AS max_cc_t ON t1.amount = max_cc_t.max_per_type
AND max_cc_t.type = cc1.type;",,,"SELECT t.identifier,cc.type, t.amount
FROM credit_cards cc
LEFT JOIN transactions t on cc.number = t.number
WHERE (cc.type, t.amount) >= ALL (
SELECT cc1.type, t1.amount
FROM credit_cards cc1
LEFT JOIN transactions t1 on cc1.number = t1.number
WHERE cc.type = cc1.type)
ORDER BY t.amount DESC;",,,"SELECT merchants.code, merchants.name
FROM merchants, transactions, credit_cards
WHERE merchants.code = transactions.code AND transactions.number = credit_cards.number
EXCEPT
SELECT merchants.code, merchants.name
FROM merchants, transactions, credit_cards
WHERE merchants.code = transactions.code AND transactions.number = credit_cards.number
AND (credit_cards.type LIKE '%visa%' OR credit_cards.type LIKE '%diners-club%') AND transactions.amount >= 888
ORDER BY code;",,
A0231931M,"SELECT cc.ssn
FROM credit_cards cc, transactions tx
WHERE tx.number = cc.number
	AND CAST(tx.datetime AS date) = '2017-12-25'
	AND cc.type = 'visa';",,,"SELECT cs.first_name, cs.last_name
FROM customers cs, credit_cards cc
WHERE cc.ssn = cs.ssn
	AND cs.country = 'Singapore'
	AND cc.type = 'jcb' 
INTERSECT
SELECT cs.first_name, cs.last_name
FROM customers cs, credit_cards cc
WHERE cc.ssn = cs.ssn
	AND cs.country = 'Singapore'
	AND cc.type = 'visa';",,,"SELECT cc.ssn, COUNT(cc.number)
FROM customers cs, credit_cards cc
WHERE cc.ssn = cs.ssn
GROUP BY cc.ssn
UNION
SELECT cs.ssn, 0 AS count
FROM customers cs LEFT OUTER JOIN credit_cards cc 
ON cc.ssn = cs.ssn
WHERE cc.ssn IS NULL;",,,"SELECT cus1.ssn, cus2.type, COUNT(credit_cards.number)
FROM (SELECT DISTINCT customers.ssn
	  FROM customers) AS cus1
	  CROSS JOIN
	  (SELECT DISTINCT credit_cards.type
	  FROM credit_cards) AS cus2
LEFT JOIN credit_cards 
ON cus1.ssn = credit_cards.ssn AND cus2.type = credit_cards.type
GROUP BY cus1.ssn, cus2.type
ORDER BY cus1.ssn, cus2.type;",,,"SELECT cs.country, COUNT(*) AS total
FROM customers cs, credit_cards cc, transactions tx, merchants mc
WHERE mc.code = tx.code
	AND tx.number = cc.number
	AND cc.ssn = cs.ssn
	AND cs.country != mc.country
GROUP BY cs.country;",,,"SELECT tx.identifier, cc.type, tx.amount
FROM transactions tx
LEFT JOIN credit_cards cc on cc.number = tx.number
WHERE (cc.type, tx.amount) IN (
	SELECT cc.type, MAX(tx1.amount)
	FROM transactions tx1
	LEFT JOIN credit_cards cc ON tx1.number = cc.number
	GROUP BY cc.type)
ORDER BY tx.identifier;",,,"SELECT tx.identifier, cc.type, tx.amount
FROM credit_cards cc
LEFT OUTER JOIN transactions tx ON cc.number= tx.number
WHERE (cc.type, tx.amount) >= ALL (
	SELECT cc1.type, tx1.amount
	FROM credit_cards cc1
	LEFT OUTER JOIN transactions tx1 ON cc1.number = tx1.number
	WHERE cc.type = cc1.type)
ORDER BY tx.identifier;",,,"SELECT DISTINCT mer.code, mer.name
FROM merchants mer, transactions tx, credit_cards cc
WHERE tx.code = mer.code
AND tx.number = cc.number
AND tx.amount < 888
AND cc.type IN ('visa', 'diners-club')
ORDER BY mer.code;",,
A0231933J,"select distinct ssn
from credit_cards c2,transactions t
where c2.number=t.number
and date(t.datetime)='2017-12-25'
and c2.type='visa';",,,"select c1.first_name,c1.last_name
from customers c1
where c1.ssn in (
	select c1.ssn
	from customers c1,credit_cards c2
	where c1.ssn=c2.ssn
	and c1.country='Singapore'
	and c2.type='jcb'
	intersect
	select c1.ssn
	from customers c1,credit_cards c2
	where c1.ssn=c2.ssn
	and c1.country='Singapore'
	and c2.type='visa');",,,"select c1.ssn, count(c2.number)
from customers c1 left outer join credit_cards c2 on c1.ssn=c2.ssn
group by c1.ssn;",,,"select c1.ssn, c4.type, count(number)
from customers c1 cross join (select distinct c3.type from credit_cards c3) as c4 left outer join credit_cards c2 
on c1.ssn=c2.ssn and c2.type=c4.type
group by c1.ssn, c4.type
order by ssn;",,,"select c1.country, count(distinct c1.ssn)
from customers c1, credit_cards c2, merchants m,transactions t
where c1.ssn=c2.ssn
and t.number=c2.number
and t.code=m.code
and c1.country!=m.country
group by c1.country;",,,"select c2.type,t.identifier
from (select c2.type, max(t.amount) as max_amount
	from credit_cards c2,transactions t
	where c2.number=t.number
	group by c2.type) as s, transactions t, credit_cards c2
where c2.number=t.number
and c2.type=s.type
and s.max_amount=t.amount
order by c2.type;",,,"select distinct on (c2.type) c2.type, t.identifier
from credit_cards c2,transactions t
where c2.number=t.number
order by c2.type, t.amount desc;",,,"select m.code,m.name
from merchants m,transactions t,credit_cards c2
where m.code=t.code
and t.number=c2.number
and (c2.type='visa' or c2.type='diners-club')
group by m.code,m.name
having sum(t.amount)<888;",,
A0231936A,"SELECT DISTINCT c.ssn
FROM customers c, credit_cards cc, transactions t
WHERE c.ssn = cc.ssn
AND cc.number = t.number
AND cc.type = 'visa'
AND date(t.datetime) = '2017-12-25';",,,"SELECT jv.first_name, jv.last_name
FROM (SELECT c.first_name, c.last_name, c.ssn
	  FROM customers c, credit_cards cc
	  WHERE c.ssn = cc.ssn
	  AND cc.type = 'jcb'
	  AND c.country = 'Singapore'
	  INTERSECT
	  SELECT c.first_name, c.last_name, c.ssn
	  FROM customers c, credit_cards cc
	  WHERE c.ssn = cc.ssn
	  AND cc.type = 'visa'
	  AND c.country = 'Singapore') AS jv
ORDER BY jv.first_name;",,,"SELECT c.ssn, COUNT(cc.number) AS number_of_cards
FROM customers c LEFT JOIN credit_cards cc
ON c.ssn = cc.ssn
GROUP BY c.ssn;",,,"CREATE VIEW card_type AS
SELECT DISTINCT c.ssn, cc.type
FROM customers c, credit_cards cc;
SELECT ct.ssn, ct.type, COUNT(cc.type) AS number_of_cards
FROM card_type ct
LEFT JOIN credit_cards cc
ON ct.ssn = cc.ssn
AND ct.type = cc.type
GROUP BY ct.ssn, ct.type
ORDER BY ct.ssn;",,,"SELECT c.country, COUNT(DISTINCT c.ssn)
FROM customers c, credit_cards cc, transactions t, merchants m
WHERE c.ssn = cc.ssn
AND cc.number = t.number
AND t.code = m.code
AND c.country != m.country
GROUP BY c.country;",,,"SELECT t.identifier
FROM credit_cards cc,
	 transactions t,
	 (SELECT cc2.type AS type, MAX(t2.amount) AS max
	  FROM transactions t, transactions t2, credit_cards cc2
	  WHERE t2.number = cc2.number
	  AND t.identifier = t2.identifier
	  GROUP BY cc2.type) AS m
WHERE cc.number = t.number
AND t.amount = m.max
AND cc.type = m.type;",,,"SELECT t.identifier
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
AND t.amount >= ALL(SELECT t2.amount
					FROM transactions t2, credit_cards cc2
					WHERE t2.number = cc2.number
				    AND cc.type = cc2.type);",,,"SELECT DISTINCT m.code, m.name
FROM merchants m
WHERE m.code NOT IN (SELECT m.code
					FROM merchants m, transactions t, credit_cards cc
					WHERE m.code = t.code
					AND t.number = cc.number
					AND t.amount >= 888
					AND (cc.type LIKE '%visa%' OR cc.type LIKE '%diners-club%'))","Missing semicolon, CHECK CODE.","Missing semicolon, CHECK CODE."
A0231941L,"SELECT DISTINCT c.ssn
FROM customers c, credit_cards cc, transactions t
WHERE c.ssn=cc.ssn
AND cc.number=t.number
AND cc.type='visa'
AND date(t.datetime)='2017-12-25';",,,"SELECT c1.first_name, c1.last_name
FROM(
	SELECT c.ssn, c.first_name, c.last_name
	FROM customers c, credit_cards cc
	WHERE c.ssn=cc.ssn
	AND cc.type='jcb'
	AND c.country='Singapore'
	INTERSECT
	SELECT c.ssn, c.first_name, c.last_name
	FROM customers c, credit_cards cc
	WHERE c.ssn=cc.ssn
	AND cc.type='visa'
	AND c.country='Singapore') c1;",,,"SELECT c.ssn, COUNT(cc.number)
FROM customers c LEFT OUTER JOIN credit_cards cc ON c.ssn=cc.ssn
GROUP BY c.ssn
ORDER BY COUNT(cc.number);",,,"SELECT a.ssn, a.type, COUNT(cc1.number)
FROM (
	SELECT c.ssn, cc.type
	FROM customers c, (
		SELECT DISTINCT type
		FROM credit_cards) cc
) a
LEFT JOIN credit_cards cc1 ON (a.ssn, a.type) = (cc1.ssn, cc1.type)
GROUP BY a.ssn, a.type
ORDER BY a.ssn, a.type;",,,"SELECT c.country, COUNT(DISTINCT c.ssn)
FROM customers c, credit_cards cc, transactions t, merchants m
WHERE c.ssn=cc.ssn
AND cc.number=t.number
AND t.code=m.code
AND c.country <> m.country
GROUP BY c.country;",,,"SELECT cc.type, t.identifier
FROM credit_cards cc, transactions t
WHERE cc.number=t.number
AND (cc.type,t.amount) IN (
	SELECT cc1.type, max(t1.amount)
	FROM credit_cards cc1, transactions t1
	WHERE cc1.number=t1.number
	GROUP BY cc1.type);",,,"SELECT cc.type, t.identifier
FROM credit_cards cc, transactions t
WHERE cc.number=t.number
GROUP BY cc.type, t.identifier
HAVING t.amount >= ALL(
	SELECT t1.amount
	FROM transactions t1, credit_cards cc1
	WHERE cc1.number=t1.number
	AND cc.type=cc1.type);",,,"SELECT DISTINCT m.code, m.name
FROM merchants m
WHERE (m.code, m.name) NOT IN(
	SELECT DISTINCT m1.code, m1.name
	FROM merchants m1, transactions t, (
		SELECT * 
		FROM credit_cards cc
		WHERE cc.type LIKE 'visa%' OR cc.type LIKE 'diners-club%') cc1
	WHERE m1.code=t.code
	AND t.number=cc1.number
	GROUP BY m1.code, m1.name, cc1.type
	HAVING max(t.amount)>=888);",,
A0231945A,"select distinct ct.ssn
from customers ct, transactions t,credit_cards c
where c.number = t.number
and ct.ssn = c.ssn
and date(t.datetime)='2017-12-25'
and c.type='visa';",,,"select ct.first_name,ct.last_name
from customers ct,(select c.ssn
from credit_cards c
where c.type='visa'
intersect
select c.ssn
from credit_cards c
where c.type='jcb') as new_card
where new_card.ssn =ct.ssn
and ct.country ='Singapore';",,,"SELECT c.ssn, COUNT(cc.number)
FROM customers c
LEFT  JOIN credit_cards cc
ON c.ssn = cc.ssn
GROUP BY c.ssn
ORDER BY COUNT(cc.number);",,,"SELECT aa.ssn, aa.type, COUNT(cc1.number)
FROM (
	SELECT c.ssn, cc.type
	FROM customers c, (
		SELECT DISTINCT type
		FROM credit_cards
	) cc
) aa
LEFT JOIN credit_cards cc1
ON (aa.ssn, aa.type) = (cc1.ssn, cc1.type)
GROUP BY aa.ssn, aa.type
ORDER BY aa.ssn, aa.type;",,,"select ct.country,count(distinct ct.ssn)
from merchants m ,customers ct,transactions t,credit_cards c
where ct.country <> m.country
and t.number = c.number
and t.code = m.code
and c.ssn = ct.ssn
group by ct.country;",,,"SELECT t.identifier, t.amount, cc.type
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
AND (cc.type, t.amount) IN (
	SELECT cc1.type, MAX(t1.amount) as max_amount
	FROM credit_cards cc1, transactions t1
	WHERE cc1.number = t1.number
	GROUP BY cc1.type);",,,"select t.identifier,t.amount,cc.type
from transactions t, credit_cards cc
where t.number = cc.number
and t.amount>=all(
	select t.amount
	from transactions t, credit_cards c
	where c.number= t.number
	and c.type = cc.type);",,,"SELECT DISTINCT m.code, m.name
FROM merchants m
WHERE m.code NOT IN (
	SELECT DISTINCT m.code
	FROM merchants m, transactions t, (
		SELECT *
		FROM credit_cards
		WHERE type LIKE '%visa%'
		OR type LIKE '%diners-club%'
		) cc
	WHERE m.code = t.code
	AND t.number = cc.number
	GROUP BY m.code, cc.type
	HAVING MAX(t.amount) >= 888
);",,
A0231947Y,"SELECT DISTINCT c.ssn
FROM customers c, credit_cards d, transactions t
WHERE c.ssn = d.ssn 
AND d.type = 'visa'
AND d.number = t.number
AND EXTRACT(year from t.datetime)='2017' 
AND EXTRACT(month from t.datetime)='12' 
AND EXTRACT(day FROM t.datetime) = 25;",,,"SELECT temp.first_name, temp.last_name
FROM (SELECT c.ssn, c.first_name, c.last_name
	  FROM customers c, credit_cards d
	  WHERE c.ssn = d.ssn
	  AND c.country = 'Singapore'
	  AND d.type = 'jcb'
	  INTERSECT
	  SELECT c.ssn, c.first_name, c.last_name
	  FROM customers c, credit_cards d
	  WHERE c.ssn = d.ssn
	  AND c.country = 'Singapore'
	  AND d.type = 'visa') AS temp
ORDER BY temp.first_name;",,,"(SELECT c.ssn, COUNT(d.number) AS number_owned
FROM customers c, credit_cards d
WHERE c.ssn = d.ssn
GROUP BY c.ssn)
UNION
(SELECT c.ssn, 0 AS cards_type_number
FROM customers c LEFT OUTER JOIN credit_cards d ON c.ssn = d.ssn
WHERE d.ssn ISNULL)
ORDER BY number_owned;",,,"SELECT c.ssn, d.type, COUNT (temp.number)
FROM customers c CROSS JOIN (SELECT DISTINCT d.type FROM credit_cards d) AS d
LEFT OUTER JOIN credit_cards temp ON c.ssn = temp.ssn and d.type = temp.type
GROUP BY c.ssn, d.type
ORDER BY c.ssn, d.type;",,,"SELECT c.country, COUNT(DISTINCT c.ssn)
FROM customers c, credit_cards d, merchants m, transactions t
WHERE c.ssn = d.ssn
AND d.number = t.number
AND t.code = m.code
AND c.country <> m.country
GROUP BY c.country;",,,"SELECT t.identifier
FROM credit_cards d, transactions t,
(SELECT d1.type, MAX(t1.amount) AS max_amount
 FROM credit_cards d1, transactions t1 
 WHERE d1.number = t1.number
 GROUP BY d1.type) AS temp
WHERE d.number = t.number
AND d.type = temp.type
AND t.amount = max_amount;",,,"SELECT t.identifier
FROM credit_cards d, transactions t
WHERE d.number = t.number
AND t.amount >= ALL (
	SELECT t1.amount
	FROM credit_cards d1, transactions t1
	WHERE d1.number = t1.number
	AND d.type = d1.type);",,,"SELECT DISTINCT m.code, m.name 
FROM merchants m, credit_cards d, transactions t
WHERE m.code = t.code
AND t.number = d.number
AND (d.type like 'visa%' or d.type like 'diners-club%')
AND t.amount <> 0
EXCEPT
SELECT DISTINCT m.code, m.name
FROM merchants m, credit_cards d, transactions t
WHERE m.code = t.code
AND t.number = d.number
AND (d.type like 'visa%' or d.type like 'diners-club%')
AND t.amount >= 888;",,
A0231952H,"select distinct c.ssn
from customers c, credit_cards cc, transactions t
where c.ssn=cc.ssn and cc.number=t.number
and t.datetime between '2017-12-25 0:00:00' and '2017-12-25 24:00:00' and cc.type='visa';",,,"select distinct m.ssn, m.first_name, m.last_name
from (select distinct c.ssn, c.first_name, c.last_name
	  from customers c, credit_cards cc
	  where c.ssn=cc.ssn and cc.type='visa' and c.country='Singapore'
	  order by c.first_name) m, credit_cards cc
where m.ssn=cc.ssn and cc.type='jcb' 
order by m.ssn;",,,"select c.ssn, count(cc.number) as number_of_credit_card 
from customers c left join credit_cards cc on c.ssn=cc.ssn
group by c.ssn
order by number_of_credit_card;",,,"select cc3.ssn, cc3.type, count(cc3.number) as number_of_credit_card 
from 
(select t.type, t.ssn, cc1.number
from (select distinct cc2.type, c.ssn
from credit_cards cc2, customers c) as t left join credit_cards cc1 
on t.ssn=cc1.ssn and t.type=cc1.type
order by t.ssn, t.type) as cc3
group by cc3.ssn, cc3.type
order by cc3.ssn, cc3.type, number_of_credit_card;",,,"select c.country, count(distinct c.ssn)
from customers c, merchants m, (select m.code, cc.ssn, cc.number, t.identifier
from merchants m, transactions t, credit_cards cc
where t.code=m.code and cc.number=t.number) as tcm
where tcm.code=m.code and tcm.ssn=c.ssn and c.country<>m.country
group by c.country;",,,"select tttt.identifier, tttt.type, ttt.maxamount
from (select tt.type, max(tt.amount) as maxamount
	  from (select cc.type, cc.ssn, cc.number, t.identifier, t.amount
			from transactions t, credit_cards cc
			where cc.number=t.number) as tt
	  group by tt.type
	  order by tt.type) as ttt, (select cc.type, cc.number, t.identifier, t.amount
								 from transactions t, credit_cards cc
								 where cc.number=t.number) as tttt
where tttt.type=ttt.type and tttt.amount=ttt.maxamount
order by tttt.type;",,,"select tt.identifier, tt.type, tt.amount
from (select cc.type, cc.ssn, cc.number, t.identifier, t.amount
from transactions t, credit_cards cc
where cc.number=t.number) as tt
where tt.amount>=all(
select tt1.amount 
	from (select cc.type, cc.ssn, cc.number, t.identifier, t.amount
		  from transactions t, credit_cards cc
		  where cc.number=t.number) as tt1 
	where tt1.type=tt.type)
order by tt.type;",,,"select m.code, m.name
from merchants m, (select max(mm.amount) as maxamount, mm.code
from (select m.code, cc.ssn, cc.number, cc.type, t.identifier,t.amount
	  from merchants m, transactions t, credit_cards cc
	  where (t.code=m.code and cc.number=t.number) and 
	  (cc.type like '%visa%' or cc.type like '%diners-club%')) as mm
group by mm.code) as mmm
where m.code=mmm.code and maxamount<888
order by m.code;",,
A0231953E,"select distinct ssn
from credit_cards cr, transactions t
where t.number = cr.number
and cr.type = 'visa'
and t.datetime >= '2017-12-25 00:00:00'
and t.datetime < '2017-12-26 00:00:00';",,,"select distinct cu.ssn, first_name, last_name
from customers cu, credit_cards cr
where country = 'Singapore'
and cu.ssn = cr.ssn
and type = 'jcb'
intersect
select distinct cu.ssn, first_name, last_name
from customers cu, credit_cards cr
where country = 'Singapore'
and cu.ssn = cr.ssn
and type = 'visa';",,,"select distinct cr.ssn, count(distinct cr.number) as number_of_cards
from credit_cards cr
group by cr.ssn
union
(select distinct cu1.ssn, 0 as number_of_cards
 from customers cu1
 except
 select distinct cr2.ssn, 0 as number_of_cards
 from credit_cards cr2)
order by number_of_cards;",,,"select distinct cr.ssn, cr.type, count(distinct cr.number) as number_of_cards
from credit_cards cr
group by cr.ssn, cr.type
union
(select distinct cu1.ssn, cr1.type, 0 as number_of_cards
 from customers cu1, credit_cards cr1
except
select distinct cr2.ssn, cr2.type, 0 as number_of_cards
from credit_cards cr2)
order by ssn, type, number_of_cards;",,,"select distinct cu.country, count(distinct cu.ssn)
from customers cu, merchants m, transactions t, credit_cards cr
where cu.country <> m.country
and m.code = t.code
and t.number = cr.number
and cr.ssn = cu.ssn
group by cu.country;",,,"select t.identifier, cr.type, max_amount
from transactions t, credit_cards cr, (
	select cr.type, max(t1.amount) as max_amount 
	from credit_cards cr, transactions t1
	where cr.number = t1.number
	group by cr.type) as A
where t.amount = A.max_amount
and cr.number = t.number
and cr.type = A.type
order by type;",,,"select t.identifier, type, amount
from credit_cards cr, transactions t
where cr.number = t.number
and t.amount >= all(
	select t1.amount 
	from credit_cards cr1, transactions t1 
	where cr1.number = t1.number 
	and cr1.type = cr.type)
order by type;",,,"select code, name
from merchants m
except
(select distinct m1.code, m1.name
from merchants m1, transactions t1, credit_cards cr1
where t1.code = m1.code
and t1.number = cr1.number
and cr1.type in (
	select distinct cr2.type
	from credit_cards cr2
	where cr2.type like '%diners-club%' or cr2.type like 'visa')
and amount >= 888);",,
A0231956Y,"SELECT DISTINCT cc.ssn
FROM transactions t, credit_cards cc
WHERE cc.number = t.number
	and cc.type ='visa'
	and DATE(t.datetime)='2017-12-25';",,,"SELECT c.first_name,c.last_name,c.ssn
FROM customers c
WHERE c.ssn in(
	SELECT cc1.ssn
	FROM credit_cards cc1, credit_cards cc2
	WHERE c.ssn=cc1.ssn
	and c.ssn=cc2.ssn
	and cc1.ssn=cc2.ssn
	and c.country='Singapore'
	and (cc1.type='visa'and cc2.type='jcb'))
ORDER BY first_name, last_name;",,,"SELECT c.ssn,
	(CASE
	 	WHEN COUNT(cc.ssn) IS NULL THEN 0
	 	ELSE COUNT(cc.ssn)
	 END) as cc_count
FROM customers c
LEFT JOIN credit_cards cc
	ON c.ssn=cc.ssn
GROUP BY c.ssn, cc.ssn
ORDER BY c.ssn;",,,"SELECT c.ssn,cc.type,count(cc.type)
FROM customers c, credit_cards cc
WHERE c.ssn=cc.ssn
GROUP BY c.ssn,cc.type
UNION
SELECT c.ssn,cc.type,0
FROM customers c, credit_cards cc
WHERE (c.ssn,cc.type) NOT IN(
	SELECT c.ssn,cc.type
	FROM customers c, credit_cards cc
	WHERE c.ssn=cc.ssn
	GROUP BY c.ssn,cc.type
	ORDER BY c.ssn)
GROUP BY c.ssn,cc.type
ORDER BY ssn ASC, type ASC;",,,"SELECT c.country, COUNT (DISTINCT c.ssn) 
FROM customers c, credit_cards cc, 
	merchants m, transactions t
WHERE c.ssn = cc.ssn 
	and cc.number = t.number 
	and t.code = m.code 
	and c.country != m.country
GROUP BY c.country
ORDER BY c.country;",,,"SELECT t.identifier
FROM transactions t, credit_cards cc
WHERE t.number=cc.number
	and (cc.type,t.amount) IN(
		SELECT cc.type,max(t.amount)
		FROM transactions t, credit_cards cc
		WHERE t.number=cc.number
		GROUP BY cc.type)
ORDER BY t.identifier ASC;",,,"SELECT t1.identifier 
FROM transactions t1, credit_cards cc1
WHERE t1.number=cc1.number
	and t1.amount >= ALL(
		SELECT t2.amount
		FROM transactions t2, credit_cards cc2
		WHERE t2.number=cc2.number
			and cc1.type=cc2.type)
ORDER BY t1.identifier;",,,"SELECT m.code,m.name
FROM merchants m
WHERE (m.code,m.name) NOT IN(
	SELECT m.code, m.name
	FROM transactions t, credit_cards cc, merchants m
	WHERE t.number=cc.number
		and t.code=m.code
		and (cc.type LIKE '%visa%' or cc.type LIKE '%diners-club%')
		and t.amount>=888)
ORDER BY m.name,m.code;",,
A0231957X,"SELECT cc.ssn,EXTRACT(day FROM T.datetime) AS DAY, EXTRACT(month FROM T.datetime) AS MONTH
FROM credit_cards cc, transactions t
WHERE cc.type='visa' 
AND cc.number=t.number
AND EXTRACT(day FROM T.datetime)=25
AND EXTRACT(month FROM T.datetime)=12
AND EXTRACT(year FROM T.datetime)=2017;",,,"SELECT cu.first_name, cu.last_name,  cu.ssn
FROM customers cu, credit_cards cc
WHERE cu.ssn=cc.ssn
AND cc.type='JCB' OR cc.type='visa'
GROUP BY cu.ssn, cu.first_name, cu.last_name;",,,"SELECT cu.ssn, count(cc.number)
FROM customers cu full outer join credit_cards cc on cu.ssn=cc.ssn
group by cu.ssn;",,,,,,"select cu.country, count(cu.ssn)
from customers cu
where cu.ssn in(
select cu.ssn
from customers cu, credit_cards cc,transactions t,merchants m
where cu.ssn=cc.ssn
and cc.number=t.number
and t.code=m.code
and m.country<>cu.country)
group by cu.country;",,,"select frm.maz,frm.tp
from (select max(t.amount) as maz,cc.type as tp
	  from credit_cards cc, transactions t
	  where cc.number=t.number
	  group by cc.type) as frm;",,,"select cc.type,t.identifier
from credit_cards cc, transactions t
where t.amount>=ALL(select t.amount
					from credit_cards cc, transactions t
					where cc.number=t.number 
					GROUP BY cc.type,t.amount) 
					and cc.number=t.number
					group by cc.type,t.identifier;",,,"select m.code,m.name
from merchants m
where m.code not in
(select m.code
from merchants m, transactions t,credit_cards cc
where t.code=m.code
and cc.number=t.number
and t.amount>=888
and cc.type='visa' or cc.type='diners-club');",,
A0231958W(timeout),"SELECT c.ssn
FROM customers c, transactions t, credit_cards d
WHERE
(t.datetime BETWEEN '2017-12-25 00:00:00.000000' AND '2017-12-25 23:59:59.999999')
AND (d.type = 'visa');",,,"SELECT c.first_name, c.last_name
FROM customers c, credit_cards d
WHERE c.country = 'Singapore'
AND (d.type ='jcb' OR d.type = 'visa')
GROUP BY c.first_name, c.last_name
ORDER BY c.first_name, c.last_name;",,,"SELECT c.ssn,
(CASE
 WHEN count(*) is null
 THEN 0
 ELSE count(*) END) AS nb_credit_cards
FROM customers c, credit_cards d
WHERE c.ssn = d.ssn
GROUP BY c.ssn
ORDER BY count(*);",,,"SELECT c.ssn, d.type, 
(CASE
 WHEN count(*) is null
 THEN 0
 ELSE count(*) END) AS nb_credit_cards
FROM customers c, credit_cards d
WHERE c.ssn = d.ssn
GROUP BY c.ssn, d.type
ORDER BY c.ssn;",,,"SELECT c.country, count(c.ssn)
FROM customers c, credit_cards d, merchants m, transactions t
WHERE t.number = d.number AND  t.code = m.code AND d.ssn = c.ssn
GROUP BY c.country
HAVING count(c.ssn) = ALL (
	SELECT count(c.ssn)
	FROM customers c1, merchants m1
	WHERE c1.country <> m1.country);",,,"SELECT t.identifier, d.type, max(t.amount)
FROM transactions t, credit_cards d
GROUP BY t.identifier, d.type;",,,"SELECT t1.identifier, d.type, t1.amount
FROM transactions t1, credit_cards d
WHERE t1.amount >= ALL (
	SELECT t2.amount
	FROM transactions t2
	WHERE t1.identifier = t2.identifier)
GROUP BY t1.identifier, d.type;",,,"SELECT m.code, m.name
FROM merchants m, credit_cards d, transactions t
WHERE NOT EXISTS (
	SELECT d.type, t.amount
	WHERE d.type LIKE 'visa%' OR d.type LIKE 'diners-club%' AND t.amount >= 888)
GROUP BY m.code, m.name
ORDER BY m.code, m.name;",,
A0231971E,"SELECT DISTINCT cr.ssn
FROM credit_cards cr, transactions t
WHERE cr.number = t.number
AND (t.datetime BETWEEN '2017-12-25 00:00:00.000000' AND '2017-12-25 23:59:59.999999')
AND cr.type = 'visa';",,,"SELECT cu.first_name, cu.last_name
FROM  customers cu
WHERE cu.country = 'Singapore'
AND cu.ssn IN (
	SELECT DISTINCT ssn
	FROM credit_cards cr
	WHERE cr.type = 'jcb'
	INTERSECT	
	SELECT DISTINCT ssn
	FROM credit_cards cr
	WHERE cr.type = 'visa');",,,"SELECT q1c.ssn, count(q1c.number)
FROM (SELECT cu.ssn, cr.number
	  FROM customers cu LEFT OUTER JOIN credit_cards cr ON cu.ssn = cr.ssn
	  GROUP BY cu.ssn, cr.number
	  ORDER BY cu.ssn, cr.number) AS q1c
GROUP BY q1c.ssn;",,,"SELECT q1d.ssn, q1d.type, count(q1d.number)
FROM (SELECT cu.ssn, cr.type, cr.number
	  FROM customers cu LEFT OUTER JOIN credit_cards cr ON cu.ssn = cr.ssn
	  GROUP BY cu.ssn, cr.type, cr.number
	  ORDER BY cu.ssn, cr.type) AS q1d
GROUP BY q1d.ssn, q1d.type;",,,"SELECT cu.country, count(*)
FROM customers cu, credit_cards cr, merchants m, transactions t
WHERE cu.ssn = cr.ssn
AND cr.number = t.number 
AND t.code = m.code
AND m.country <> cu.country
GROUP BY cu.country;",,,"SELECT t.identifier, t.amount
FROM transactions t
WHERE t.amount IN (
	SELECT MAX(t.amount)
	FROM transactions t, credit_cards cr
	WHERE cr.number = t.number
	GROUP BY cr.type)
ORDER BY t.amount;",,,"SELECT t.identifier, t.amount
FROM transactions t
WHERE t.amount IN (
	SELECT temp1.amount
	FROM (SELECT cr1.type, t1.amount
		  FROM credit_cards cr1, transactions t1
	 	  WHERE cr1.number = t1.number
		  GROUP BY cr1.type, t1.amount
		  ORDER BY cr1.type, t1.amount desc) AS temp1
	WHERE temp1.amount >= ALL (
		SELECT temp2.amount
		FROM (SELECT cr2.type, t2.amount
			  FROM credit_cards cr2, transactions t2
			  WHERE cr2.number = t2.number
			  GROUP BY cr2.type, t2.amount
			  ORDER BY cr2.type, t2.amount desc) AS temp2
		WHERE temp1.type = temp2.type))
ORDER BY t.amount;",,,"SELECT m.code, m.name 
FROM merchants m LEFT OUTER JOIN(
	SELECT m.code, m.name
	FROM merchants m
	WHERE m.code IN(
		SELECT t.code
		FROM transactions t
		WHERE t.amount >= 888
		AND t.number in (
			SELECT t.number 
			FROM credit_cards cr, transactions t
			WHERE t.number = cr.number
			AND (cr.type = 'visa' or cr.type = 'diners-club')))) AS opp
ON m.code = opp.code
WHERE opp.code ISNULL;",,
A0231973B,"SELECT DISTINCT c.ssn 
FROM customers c, credit_cards cc, transactions t
WHERE c.ssn = cc.ssn
AND cc.number = t.number
AND t.datetime::date = '2017-12-25'
AND cc.type = 'visa';",,,"SELECT c.first_name, c.last_name
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn 
AND c.country ='Singapore'
AND cc.type = 'jcb'
INTERSECT 
SELECT c.first_name, c.last_name
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn
AND c.country ='Singapore'
AND cc.type = 'visa';",,,"SELECT c.ssn, COUNT(cc.number) AS nb_cc
FROM customers c LEFT JOIN credit_cards cc ON c.ssn = cc.ssn 
GROUP BY c.ssn;",,,"SELECT cust_cc.ssn, cust_cc.type, COUNT(cc.number)
FROM (SELECT DISTINCT c.ssn, cc.type 
	  FROM customers c, credit_cards cc) AS cust_cc
LEFT JOIN credit_cards cc ON cust_cc.ssn = cc.ssn AND cust_cc.type = cc.type
GROUP BY cust_cc.ssn, cust_cc.type;",,,"SELECT c.country AS customer_country, COUNT(*) AS nb_customers_buying_abroad
FROM customers c, credit_cards cc, transactions t, merchants m
WHERE c.ssn = cc.ssn
AND cc.number = t.number
AND t.code = m.code
AND c.country <> m.country
GROUP BY c.country;",,,"SELECT t.identifier, cc.type
FROM transactions t LEFT JOIN credit_cards cc ON t.number = cc.number
WHERE (cc.type, t.amount) = ANY (
	SELECT cc.type, MAX(t.amount)
	FROM transactions t LEFT JOIN credit_cards cc ON t.number = cc.number
	GROUP BY cc.type);",,,"SELECT table1.identifier, table1.type
FROM (transactions t1 LEFT JOIN credit_cards cc1 ON t1.number = cc1.number) AS table1
WHERE NOT EXISTS (SELECT (table2.type, table2.amount) 
				  FROM (transactions t2 LEFT JOIN credit_cards cc2 ON t2.number = cc2.number) AS table2
				  WHERE table1.type = table2.type
				  AND table1.amount < table2.amount);",,,"SELECT m.code, m.name, cc.type, t.amount
FROM credit_cards cc, transactions t, merchants m
WHERE cc.number = t.number
AND m.code = t.code
AND NOT( (cc.type = 'visa' OR cc.type ='diners-club') 
		 AND t.amount >=888);",,
A0231974Y,"Select distinct c.ssn, c.first_name, c.last_name
From Customers AS c, Transactions AS t, Credit_cards AS cc
Where cc.type = 'visa' AND t.datetime Between '2017-12-24 23:59:59.999999' AND '2017-12-25 23:59:59.999999'
AND c.ssn = cc.ssn;",,,"Select c.first_name, c.last_name
From customers c Inner Join credit_cards cc ON c.ssn = cc.ssn Inner Join Transactions t ON cc.number = t.number
AND c.country = 'Singapore' AND cc.type = ('visa')
INTERSECT
Select c.first_name, c.last_name
From customers c Inner Join credit_cards cc ON c.ssn = cc.ssn Inner Join Transactions t ON cc.number = t.number
AND c.country = 'Singapore' AND cc.type = ('jcb');",,,"Select c.ssn, count(cc.number)
From customers c LEFT Join credit_cards cc ON c.ssn = cc.ssn
Group By c.ssn
Order by count;",,,"Select c.ssn, cc.type, count(cc.number)
From customers c LEFT Join credit_cards cc ON c.ssn = cc.ssn
Group By c.ssn, cc.type
Order by c.ssn;",,,"Select c.country, count(distinct c.ssn)
From transactions t
Inner Join credit_cards cc ON t.number = cc.number
Inner Join customers c ON c.ssn = cc.ssn
Inner Join merchants m ON m.code = t.code
Where c.country <> m.country
Group By c.country;",,,"Select t.identifier
From transactions t
Join credit_cards cc ON t.number = cc.number
Where t.amount = (
	Select MAX(t1.amount)
	From transactions t1
	Join credit_cards cc1 on t1.number = cc1.number
	Where cc.type = cc1.type
);",,,"Select t.identifier
From transactions t
Join credit_cards cc ON t.number = cc.number
Where t.amount >= ALL(
	Select t1.amount
	From transactions t1
	Join credit_cards cc1 on t1.number = cc1.number
	Where cc.type = cc1.type
);",,,"Select m.code
From merchants m
Where m.code NOT IN(
	Select m.code
	From transactions t
	Inner Join merchants m ON t.code = m.code
	Inner Join credit_cards cc ON t.number = cc.number
	Where t.amount >= 888
	AND (cc.type IN ('visa', 'diners-club'))
);",,
A0231975X,"Select DISTINCT c.ssn
From customers c, credit_cards k, merchants m, transactions t
Where c.ssn = k.ssn
AND k.number = t.number
AND m.code = t.code
AND k.type = 'visa'
AND EXTRACT(DAY FROM t.datetime) = 25;",,,"Select DISTINCT c.first_name, c.last_name, c.ssn
From customers c, credit_cards k
Where c.ssn = k.ssn
AND k.type = 'visa'
AND c.country = 'Singapore'
INTERSECT
Select DISTINCT c.first_name, c.last_name, c.ssn
From customers c, credit_cards k
Where c.ssn = k.ssn
AND k.type = 'jcb'
AND c.country = 'Singapore';",,,"Select c.ssn, count(k.number) as cards_number
From customers c LEFT OUTER JOIN credit_cards k ON c.ssn = k.ssn
GROUP BY c.ssn;",,,"Select c.ssn, k.type, count(k.number) as cards_number
From customers c LEFT OUTER JOIN credit_cards k ON c.ssn = k.ssn
GROUP BY c.ssn, k.type
ORDER BY c.ssn, k.type;",,,"Select c.country, count(distinct c.ssn) as customers_number
From customers c
	left join credit_cards k
	on c.ssn = k.ssn
	left join transactions t
	on k.number = t.number
	left join merchants m
	on t.code = m.code
Where c.country <> m.country
GROUP BY c.country;",,,"Select k.type, t.identifier 
From transactions t natural join credit_cards k 
    left join
	(select max(t.amount) as max_amount, k.type
	from transactions t left join credit_cards k
	on t.number=k.number 
	group by k.type) A 
	on A.max_amount=t.amount 
Where A.type= k.type;",,,"Select k1.type, t1.identifier 
From transactions t1 natural join credit_cards k1
Where t1.amount >= ALL(
	Select t2.amount
	From transactions t2 natural join credit_cards k2
	Where k1.type = k2.type);",,,"Select m.code, m.name
From merchants m
	left join transactions t
	on m.code = t.code
	left join credit_cards k
	on t.number = k.number
Where k.type like '%visa%' or k.type like '%diners-club%'
GROUP BY m.code, m.name
HAVING max(t.amount) < 888;",,
A0231979N,"SELECT c.ssn
FROM customers c, credit_cards cc, transactions t
WHERE c.ssn = cc.ssn AND cc.number = t.number
AND cc.type= 'visa' AND t.datetime::date ='2017-12-25'",,,"SELECT  c.first_name, c.last_name
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn  AND c.country= 'Singapore' AND cc.type = 'jcb'
INTERSECT 
SELECT  c.first_name, c.last_name
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn  AND c.country= 'Singapore' AND cc.type = 'visa'",,,"SELECT  c.ssn,COUNT(cc.number) as result
FROM customers c LEFT JOIN credit_cards cc ON c.ssn= cc.ssn
GROUP BY c.ssn
ORDER BY result",,,"SELECT sub.ssn, sub.type,COUNT(cc.number)
FROM  (SELECT DISTINCT c.ssn,cc.type FROM customers c,credit_cards cc) as sub
LEFT JOIN credit_cards cc ON sub.ssn = cc.ssn AND sub.type = cc.type
GROUP BY sub.ssn, sub.type
ORDER BY sub.ssn",,,"SELECT c.country, COUNT(*)
FROM customers c, credit_cards cc, transactions t, merchants m
WHERE c.ssn = cc.ssn AND t.number = cc.number AND t.code = m.code AND c.country != m.country
GROUP BY c.country",,,"SELECT cc.type,t.identifier
FROM credit_cards cc, transactions t 
WHERE cc.number = t.number
AND (cc.type,t.amount) IN (SELECT cc.type,MAX(t.amount) FROM  credit_cards cc, transactions t WHERE cc.number = t.number GROUP BY cc.type)
ORDER BY cc.type",,,"SELECT cc.type,t.identifier
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
AND NOT EXISTS ( SELECT t2.identifier FROM credit_cards cc2, transactions t2 WHERE cc2.number=t2.number AND cc2.type = cc.type AND t2.amount>t.amount)
ORDER BY cc.type",,,"* Write your answer in SQL below: 
		*/
SELECT DISTINCT m.code, m.name
FROM credit_cards cc, transactions t, merchants m
WHERE t.number = cc.number AND t.code = m.code 
AND NOT EXISTS (SELECT *
			FROM credit_cards cc, transactions t, merchants m2
			WHERE t.number = cc.number AND t.code = m2.code AND m2.code = m.code
			AND t.amount >= 888 and (cc.type = 'visa' or cc.type='diners-club'))
ORDER BY m.code, m.name","Missing semicolon, CHECK CODE.","Missing semicolon, CHECK CODE."
A0231982B,"select distinct ssn
from credit_cards c,transactions t
where c.number=t.number
and date(t.datetime)='2017-12-25'
and t.amount>0
and c.type='visa';",,,"select a.first_name,a.last_name
from
(select cu.ssn, cu.first_name, cu.last_name
from customers cu join credit_cards cc on cu.ssn=cc.ssn
where cc.type='visa' and cu.country='Singapore'
intersect
select cu.ssn, cu.first_name, cu.last_name
from customers cu join credit_cards cc on cu.ssn=cc.ssn
where cc.type='visa' and cu.country='Singapore') as a ;",,,"select cu.ssn, count(cc.number)
from customers cu
left join credit_cards cc
on cu.ssn=cc.ssn
group by cu.ssn;",,,"select a.ssn, b.type, count(cc.number)
from(select distinct cu.ssn from customers cu)as a cross join (select distinct cc.type from credit_cards cc)as b
left join credit_cards cc
on a.ssn=cc.ssn and b.type=cc.type
group by a.ssn, b.type
order by a.ssn, b.type;",,,"select cu.country, count(distinct cu.ssn)
from transactions t
join merchants m on t.code=m.code
join credit_cards cc on cc.number=t.number
join customers cu on cu.ssn=cc.ssn
where cu.country<>m.country
group by cu.country;",,,"select t.identifier
from transactions t
join credit_cards cc on cc.number=t.number
where (cc.type,t.amount) in (select cc.type,max(t1.amount) 
							 from transactions t1
							 join credit_cards cc
							 on cc.number=t1.number
							 group by cc.type
							);",,,"select t.identifier
from transactions t
join credit_cards cc on cc.number=t.number
where t.amount >= all (select t1.amount
					   from transactions t1
					   join credit_cards cc1
					   on cc1.number=t1.number
					   where cc1.type=cc.type
							);",,,"select distinct m.code, m.name
from merchants m
where (m.code,m.name) not in
(select m.code, m.name
from merchants m
join transactions t on m.code=t.code
join credit_cards cc on cc.number=t.number
where t.amount>=888
and (cc.type like '%visa%' OR cc.type LIKE '%diners-club%'));",,
A0231989M,"select distinct(c.ssn)
from customers as c, credit_cards as cc, transactions as tx
where c.ssn = cc.ssn and tx.number = cc.number and cc.type = 'visa' and tx.datetime::timestamp::date = '2017-12-25';",,,"select temp.first_name, temp.last_name
from (select c.ssn,c.first_name, c.last_name
from customers as c, credit_cards as cc
where c.ssn = cc.ssn and cc.type = 'visa' and c.country = 'Singapore'
intersect
select c.ssn,c.first_name, c.last_name
from customers as c, credit_cards as cc
where c.ssn = cc.ssn and cc.type = 'jcb' and c.country = 'Singapore') as temp;",,,"select c.ssn,count(cc.ssn)
from customers c 
left join credit_cards cc 
on c.ssn = cc.ssn
group by c.ssn;",,,"select c.ssn,cc.type, (case when count(cc.type) isnull then 0 else count(cc.type) end) as count_cc_type
from credit_cards cc, customers c
where c.ssn = cc.ssn
group by c.ssn, cc.type
union
select c1.ssn,cc1.type,0
from customers c1, credit_cards cc1
where not exists(select c2.ssn,cc2.type, (case when count(cc2.type) isnull then 0 else count(cc2.type) end) as count_cc_type2
				from credit_cards cc2, customers c2
				where c2.ssn = cc2.ssn and c2.ssn = c1.ssn and cc1.ssn = cc2.ssn
				group by c2.ssn, cc2.type)
;",,,"select c.country, count(distinct(c.ssn))
from customers as c, credit_cards as cc, transactions as tx, merchants as m
where c.ssn = cc.ssn and cc.number = tx.number and tx.code = m.code and c.country != m.country
group by c.country;",,,"select temp2.identifier
from (select cc.type,max((case when tx.amount isnull then 0 else tx.amount end)) as max_tx
from credit_cards as cc, transactions as tx
where tx.number = cc.number 
group by cc.type) as temp
left join (select * from transactions as tx,credit_cards as cc where cc.number = tx.number) as temp2
on temp.max_tx = temp2.amount and temp.type = temp2.type;",,,"select tx.identifier
from credit_cards cc, transactions tx
where( tx.number = cc.number and tx.amount >= ALL
	(select tx1.amount
	from transactions as tx1, credit_cards as cc1 
	where cc1.number = tx1.number and cc1.type = cc.type));",,,"select mm.code, mm.name
from merchants mm
where mm.code not in (select m.code
from merchants m, transactions tx, credit_cards cc
where tx.code = m.code and cc.number = tx.number and tx.amount >= 888.0 and (cc.type like 'visa%' or cc.type like 'diners-club%'));",,
A0231990A,"SELECT DISTINCT cc.ssn
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
AND cc.type = 'visa'
AND t.datetime >= '2017-12-25'
AND t.datetime < '2017-12-26';",,,"SELECT
	cu.first_name,
	cu.last_name
FROM customers cu, credit_cards cc
WHERE cu.ssn = cc.ssn
AND cu.country = 'Singapore'
AND cc.type = 'jcb'
AND EXISTS (
	SELECT
		cu1.ssn
	FROM customers cu1, credit_cards cc1
	WHERE cu1.ssn = cc1.ssn
	AND cc1.type = 'visa'
	AND cu.ssn = cu1.ssn)
GROUP BY cu.ssn, cu.first_name, cu.last_name
ORDER BY cu.first_name, cu.last_name;",,,"SELECT 
	cu.ssn, 
	(CASE WHEN cc.ssn ISNULL THEN 0 ELSE COUNT(*) END) as cc_count
FROM customers cu LEFT OUTER JOIN credit_cards cc
ON cu.ssn = cc.ssn
GROUP BY cu.ssn, cc.ssn;",,,"SELECT 
	cct.ssn, 
	cct.type, 
	(CASE WHEN cc.ssn ISNULL THEN 0 ELSE COUNT(*) END) as cc_count 
FROM 
  	(SELECT 
   		cu1.ssn, 
		cc1.type 
	 FROM customers cu1, 
	 	(SELECT DISTINCT type 
         FROM credit_cards) cc1) cct 
	 LEFT OUTER JOIN credit_cards cc ON (cct.ssn = cc.ssn AND cct.type = cc.type) 
GROUP BY cct.ssn, cct.type, cc.ssn
ORDER BY cct.ssn, cct.type;",,,"SELECT
	cu1.country,
	count(*) as n_customers
FROM
	(SELECT
		cu.country,
		cu.ssn
	 FROM customers cu, credit_cards cc, transactions t, merchants m
	 WHERE cu.ssn = cc.ssn
	 AND cc.number = t.number
	 AND t.code = m.code
	 AND cu.country <> m.country
	 GROUP BY cu.country, cu.ssn) cu1
GROUP BY cu1.country
ORDER BY cu1.country;",,,"SELECT t.identifier
FROM 
	credit_cards cc, 
	transactions t,
	(SELECT 
	 	cc1.type, 
	 	MAX(t1.amount) as amount
	 FROM credit_cards cc1, transactions t1
	 WHERE cc1.number = t1.number
	 GROUP BY cc1.type) tmx
WHERE cc.number = t.number
AND cc.type = tmx.type
AND t.amount = tmx.amount;",,,"SELECT t.identifier
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
AND t.amount >= ALL (
	SELECT t1.amount
	FROM credit_cards cc1, transactions t1
	WHERE cc1.number = t1.number
	AND cc.type = cc1.type);",,,"SELECT DISTINCT t.code, m.name
FROM transactions t, merchants m
WHERE t.code = m.code
AND NOT EXISTS (
	SELECT t1.code
	FROM credit_cards cc1, transactions t1
	WHERE cc1.number = t1.number
	AND (cc1.type like 'visa%' OR cc1.type like 'diners-club%')
	AND t1.amount >= 888
	AND t.code = t1.code);",,
A0231993X,"SELECT c.ssn
FROM credit_cards c, transactions t
WHERE c.type = 'visa' AND t.number = c.number AND DATE(datetime) = '2017-12-25';
* can check that it is correct by using 
 SELECT c.ssn, t.number, c.number, c.type, DATE(t.datetime) */",,,"SELECT cust.first_name, cust.last_name
FROM customers cust, credit_cards c
WHERE cust.country = 'Singapore' AND c.ssn = cust.ssn  AND (c.type = 'visa' or c.type ='jcb')",,,"SELECT cust.ssn, COUNT(c.ssn)
FROM customers cust, credit_cards c
WHERE cust.ssn = c.ssn
GROUP BY cust.ssn
UNION
SELECT cust.ssn, COUNT(cust.ssn)-1 
FROM customers cust
WHERE cust.ssn NOT IN (SELECT c.ssn FROM credit_cards c)
GROUP BY cust.ssn
ORDER BY COUNT;",,,"select cust.ssn, c.type, count(*) as count
from customers as cust, credit_cards as c
where cust.ssn = c.ssn 
union
select distinct (tempA.ssn), tempA.type, 0 as count
from (select cust.ssn, subquery.type, count(*) 
	from customers cust, credit_cards c, (select distinct c.type from credit_cards as c) as subquery
	where cust.ssn = c.ssn and c.type <> subquery.type
	group by cust.ssn, subquery.type
	order by cust.ssn
		(select cust.ssn, c.type
			from customers as cust, credit_cards as c
			where cust.ssn = c.ssn 
			group by cust.ssn, c.type
			order by cust.ssn) as temporaryB
	on tempA.ssn = temporaryB.ssn and (tempA.type = temporaryB.type  )
order by ssn;",,,"select aact.cust_country, sum(aact.count) as number_of_overseas_purchase
from (SELECT m.country as m_country, cust.country as cust_country, COUNT(*)
from transactions t, merchants m, customers cust, credit_cards c
where t.code = m.code AND t.number = c.number AND c.ssn = cust.ssn AND m.country = cust.country
left join (SELECT m.country as m_country, cust.country as cust_country, COUNT(*)
from transactions t, merchants m, customers cust, credit_cards c
where t.code = m.code AND t.number = c.number AND c.ssn = cust.ssn 
on sct.m_country = aact.m_country and sct.cust_country <> aact.cust_country
group by aact.cust_country; 
*
SELECT m.country, COUNT(*)
from transactions t, merchants m
where t.code = m.code 
GROUP BY m.country; 
*/
*
SELECT m.country, cust.country, COUNT(*)
from transactions t, merchants m, customers cust, credit_cards c
where t.code = m.code AND t.number = c.number AND c.ssn = cust.ssn AND m.country = cust.country
GROUP BY m.country, cust.country; */
* this solution is my working but because i use INTO, i just rewrite again without 
SELECT m.country, cust.country, COUNT(*)
from transactions t, merchants m, customers cust, credit_cards c
where t.code = m.code AND t.number = c.number AND c.ssn = cust.ssn 
GROUP BY m.country, cust.country
SELECT m.country as m_country, cust.country as cust_country, COUNT(*)
into sct
from transactions t, merchants m, customers cust, credit_cards c
where t.code = m.code AND t.number = c.number AND c.ssn = cust.ssn AND m.country = cust.country
GROUP BY m.country, cust.country;
SELECT m.country as m_country, cust.country as cust_country, COUNT(*)
into aact
from transactions t, merchants m, customers cust, credit_cards c
where t.code = m.code AND t.number = c.number AND c.ssn = cust.ssn 
GROUP BY m.country, cust.country;
select * from sct;
select * from aact;
select aact.cust_country, sum(aact.count)
from sct 
left join aact
on sct.m_country = aact.m_country and sct.cust_country <> aact.cust_country
group by aact.cust_country
*/",,,"from transactions as t, credit_cards as c
FROM transactions t, credit_cards c
WHERE t.number = c.number 
GROUP BY c.type ) 
order by t.identifier;
*SELECT *
FROM transactions t, credit_cards c
WHERE t.number = c.number and c.type = 'visa-electron'  and t.amount = '1000.34'",,,"select t.identifier, t.amount
from transactions as t, credit_cards as c
where c.number = t.number and t.amount >= ALL(
	SELECT t1.amount 
	from transactions as t1, credit_cards as c1
	where t1.number = c1.number and c.type =c1.type)
order by t.identifier;",,,"select m.code, m.name
from merchants as m
from merchants as m
select distinct right_table.name
from
from transactions as t, merchants as m, credit_cards as c
where t.amount >= 888 and t.number = c.number and t.code = m.code and ( c.type like 'visa%' or c.type like 'diners-club%')
group by t.amount, t.number, c.number, t.code, m.code, c.type
) as innerjoin
on m.name = innerjoin.name
order by innerjoin.name;",,
A0231994W,"SELECT DISTINCT c.ssn FROM customers c, credit_cards d, transactions t
WHERE d.type='visa' 
AND c.ssn = d.ssn
AND d.number = t.number
AND t.datetime between '2017-12-25' and '2017-12-26';",,,"SELECT c.first_name, c.last_name
FROM customers c, credit_cards d
WHERE c.ssn = d.ssn AND (c.first_name, c.last_name) IN(
SELECT c.first_name,c.last_name FROM customers c, credit_cards d
WHERE c.ssn = d.ssn AND d.type = 'jcb')
AND d.type = 'visa';",,,"SELECT c.ssn, COUNT(d.number) as A
FROM customers c LEFT OUTER JOIN credit_cards d ON c.ssn = d.ssn
GROUP BY (c.ssn)
Order by A;",,,"SELECT c.ssn,d.type,COUNT(d.number)
FROM customers c LEFT OUTER JOIN credit_cards d ON c.ssn = d.ssn
GROUP BY (c.ssn,d.type)
UNION
SELECT c.ssn,d.type,0
FROM customers c LEFT OUTER JOIN credit_cards d ON c.ssn = d.ssn
GROUP BY (c.ssn,d.type);",,,"SELECT c.country,COUNT(DISTINCT c.ssn)
FROM transactions t 
LEFT OUTER JOIN credit_cards d ON t.number = d.number
LEFT OUTER JOIN merchants m ON m.code = t.code
LEFT OUTER JOIN customers c on c.ssn = d.ssn
WHERE c.country <> m.country
GROUP BY(c.country);",,,"SELECT t.identifier,t.amount
FROM transactions t
WHERE t.amount = ANY(
	SELECT MAX(t.amount)
FROM transactions t LEFT OUTER JOIN credit_cards d ON t.number = d.number
GROUP BY(d.type)
);
SELECT d.type, MAX(t.amount),count(t.identifier)
FROM transactions t LEFT OUTER JOIN credit_cards d ON t.number = d.number
GROUP BY(d.type);",,,"SELECT t.identifier,t.amount
FROM transactions t, credit_cards d
WHERE 
t.number = d.number AND
t.amount >= ALL(
	SELECT t.amount
FROM transactions t LEFT OUTER JOIN credit_cards d2 ON t.number = d2.number
WHERE d.type = d2.type
);",,,"SELECT m.code, m.name
FROM transactions t
LEFT OUTER JOIN credit_cards d ON t.number = d.number
LEFT OUTER JOIN merchants m ON t.code = m.code
WHERE d.type = 'visa' OR d.type = 'diners-club'
GROUP BY (m.code)
HAVING MAX(t.amount) < 888;",,
A0231996R,"select distinct c.ssn 
from customers c, transactions t, credit_cards cc
where c.ssn = cc.ssn
and t.number = cc.number
and cc.type = 'visa'
and t.datetime between '2017-12-25' and '2017-12-26'
order by c.ssn asc;",,,"select c.first_name, c.last_name
from customers c, credit_cards cc, credit_cards ccc
where cc.type = 'visa' 
and ccc.type ='jcb'
and c.country = 'Singapore'
and c.ssn=cc.ssn
and c.ssn=ccc.ssn
group by c.ssn, c.first_name, c.last_name",,,"select c.ssn, count(cc.ssn)
from customers c left outer join credit_cards cc on c.ssn=cc.ssn
group by c.ssn
order by c.ssn asc",,,"select res2.ssn, res2.type, CASE WHEN count IS NULL THEN 0 ELSE count END
from 
(select ssn, type
from customers
cross join (select distinct type from credit_cards) res) res2
left join
(select c.ssn, cc.type, count(cc.number)
from customers c left outer join credit_cards cc on c.ssn=cc.ssn
group by c.ssn, cc.type) res3
on res2.ssn = res3.ssn and res2.type = res3.type",,,"select c.country, count (distinct c.ssn)
from transactions t, merchants m, credit_cards cc, customers c
where t.code = m.code
and t.number = cc.number
and cc.ssn = c.ssn
and m.country <> c.country
group by c.country",,,"select t.identifier, t.amount
from transactions t, credit_cards cc
where t.number=cc.number
and cc.type || t.amount in (select ccc.type || max(tt.amount) 
    from transactions tt, credit_cards ccc
    where tt.number = ccc.number 
    group by ccc.type)",,,"select t.identifier, t.amount
from transactions t, credit_cards cc
where t.number=cc.number
and t.amount >= all(
select tt.amount
from transactions tt, credit_cards ccc
where tt.number=ccc.number
and cc.type = ccc.type)",,,"select m.code, m.name
from merchants m, transactions t, credit_cards cc
where m.code =t.code 
and t.number = cc.number
and cc.type like '%visa%'
group by m.code, m.name
having max(t.amount)<888
intersect
select m.code, m.name
from merchants m, transactions t, credit_cards cc
where m.code =t.code 
and t.number = cc.number
and cc.type like '%diners-club%'
group by m.code, m.name
having max(t.amount)<888","Missing semicolon, CHECK CODE.","Missing semicolon, CHECK CODE."
A0232000L,"SELECT DISTINCT c.ssn
FROM customers c, credit_cards cc, transactions t
WHERE c.ssn = cc.ssn
AND cc.number = t.number
AND cc.type = 'visa'
AND (t.datetime >='2017-12-25' AND t.datetime< '2017-12-26')
ORDER BY c.ssn;",,,"SELECT a.first_name, a.last_name
FROM (
SELECT DISTINCT c1.ssn, c1.first_name, c1.last_name
FROM customers c1, customers c2, credit_cards cc1, credit_cards cc2
WHERE c1. ssn = cc1. ssn
AND c2.ssn = cc2.ssn
AND cc1.type = 'visa' 
AND cc2.type = 'jcb'
AND c1.ssn=c2.ssn)a
ORDER BY a.first_name, a.last_name;",,,"SELECT c.ssn, count(*) as num_of_cards
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn
GROUP BY c.ssn
UNION 
SELECT c.ssn, 0 AS num_of_cards
FROM customers c LEFT OUTER JOIN credit_cards cc
ON c.ssn = cc.ssn
WHERE cc.number ISNULL
ORDER BY num_of_cards;",,,"SELECT a.ssn, a.type, sum(num_of_cards) num_of_cards
FROM(
SELECT cc.ssn, cc.type, count(*)as num_of_cards
FROM credit_cards cc
GROUP BY cc.ssn, cc.type
UNION
SELECT DISTINCT c.ssn, cc.type, 0 as num_of_cards
FROM customers c, credit_cards cc)a
GROUP BY a.ssn, a.type
ORDER BY a.ssn, a.type;",,,"SELECT c.country, count(DISTINCT c.ssn)
FROM customers c, credit_cards cc, merchants m, transactions t
WHERE c.ssn = cc.ssn
AND cc.number = t.number
AND t.code = m.code
AND c.country <> m.country
GROUP BY c.country;",,,"WITH max_amt AS
(
SELECT cc.type as type, MAX(t.amount)as max_number
FROM credit_cards cc, transactions t
WHERE cc.number=t.number
GROUP BY cc.type
)
SELECT cc1.type, t1.identifier
FROM credit_cards cc1, transactions t1, max_amt
WHERE cc1.number=t1.number
AND t1.amount = max_amt.max_number
AND cc1.type= max_amt.type
ORDER BY cc1.type;",,,"SELECT cc.type, t.identifier, t.amount
FROM credit_cards cc, transactions t
WHERE cc.number=t.number
GROUP BY cc.type, t.identifier
HAVING t.amount >= ALL
	(SELECT t1.amount 
	FROM credit_cards cc1, transactions t1 
	WHERE cc1.number=t1.number
	AND cc.type=cc1.type
	GROUP BY t1.identifier);",,,"SELECT DISTINCT m.code, m.name
FROM merchants m, transactions t, credit_cards cc
WHERE m.code = t.code
AND t.number = cc.number
AND t.amount < 888.00
AND (cc.type = 'visa' or cc.type = 'diners-club');",,
A0232004A,"select cu.ssn
from credit_cards cr, transactions tr, customers cu
where cu.ssn = cr.ssn
and cr.number = tr.number
and date(tr.datetime) = '2017-12-25'
and cr.type = 'visa'
group by cu.ssn",,,"select cu2.first_name, cu2.last_name
from	(select cr1.ssn, cu1.first_name, cu1.last_name
		from customers cu1, credit_cards cr1
		where cu1.ssn = cr1.ssn
		and cu1.country = 'Singapore'
		and cr1.type = 'visa'
		group by cr1.ssn, cu1.first_name, cu1.last_name, cr1.type) as vi, customers cu2, credit_cards cr2
where cu2.ssn = cr2.ssn
and cr2.ssn = vi.ssn
and cr2.type = 'jcb'
group by cr2.ssn, cu2.first_name, cu2.last_name",,,"select cu.ssn, count(cr.ssn)
from customers cu
	left join credit_cards cr on cu.ssn = cr.ssn
group by cu.ssn",,,"select cu.ssn, cr.type, count(cr.type)
from customers cu
	left join credit_cards cr on cu.ssn = cr.ssn
group by cu.ssn, cr.type",,,"select co.country, count(*)
from 	(select cu.ssn, cu.country
		from customers cu, credit_cards cr, merchants me, transactions tr
		where cr.number = tr.number
		and cu.ssn = cr.ssn
		and me.code = tr.code
		and cu.country <> me.country
		group by cu.ssn) as co
group by co.country",,,"select tr1.identifier, cr1.type
from transactions tr1, credit_cards cr1, 	(select cr2.type, max(tr2.amount)
											from transactions tr2, credit_cards cr2
											where tr2.number = cr2.number
											group by cr2.type) as trcr
where tr1.number = cr1.number
and trcr.type = cr1.type
and tr1.amount = trcr.max",,,"select tr1.identifier, cr1.type
from transactions tr1, credit_cards cr1
where tr1.number = cr1.number
and tr1.amount >= all	(select tr2.amount
					  	from transactions tr2, credit_cards cr2
					 	where tr2.number = cr2.number
						and cr1.type = cr2.type)",,,"select me2.code,me2.name
from merchants me2
where not exists	(select me.name
					from merchants me, credit_cards cr, transactions tr
					where cr.number = tr.number
					and me.code = tr.code 
					and (cr.type like '%visa%' or cr.type like '%diners-club%')
					and tr.amount >= 888
					and me.name = me2.name)","Missing semicolon, CHECK CODE.","Missing semicolon, CHECK CODE."
A0232007X,"select distinct c.ssn
from customers c
inner join credit_cards cc on c.ssn=cc.ssn
inner join transactions t on t.number=cc.number
where cc.type='visa'
and date(t.datetime)='2017-12-25';",,,"select c.first_name, c.last_name
from customers c
inner join credit_cards cc on c.ssn=cc.ssn
inner join credit_cards cc2 on c.ssn=cc2.ssn
where c.country='Singapore'
and cc.type='jcb'
and cc2.type='visa'
group by c.ssn;",,,"select c.ssn, count(*) as number_of_credit_cards
from customers c
inner join credit_cards cc on c.ssn=cc.ssn
where c.ssn=cc.ssn
group by c.ssn
union
(select c.ssn, 0 as number_of_credit_cards
from customers c
except
select distinct cc.ssn, 0 as number_of_credit_cards
from credit_cards cc)
order by number_of_credit_cards asc;",,,"drop table if exists l1;
drop table if exists l2;
select distinct c.ssn, cc.type into table l1
from customers c, credit_cards cc;
select c.ssn, cc.type, count(*) as number_of_credit_cards into table l2
from customers c
inner join credit_cards cc on c.ssn=cc.ssn
group by c.ssn, cc.type;
select l1.ssn,l1.type,coalesce(l2.number_of_credit_cards,0)
from l1
left join l2
on l1.ssn=l2.ssn and l1.type=l2.type
order by l1.ssn;",,,"select c.country, count(distinct c.ssn)
from customers c
inner join credit_cards cc on cc.ssn=c.ssn
inner join transactions t on cc.number=t.number
inner join merchants m on m.code=t.code
where c.country != m.country
group by c.country;",,,"drop table if exists l3;
drop table if exists l4;
select t.identifier, t.amount, cc.type into table l3
from credit_cards cc
inner join transactions t on cc.number=t.number;
select max(amount),type into table l4
from l3
group by type;
select l3.identifier,l3.amount,l3.type
from l3
inner join l4
on l3.amount=l4.max and l3.type=l4.type;",,,"drop table if exists l5;
select t.identifier, t.amount, cc.type into table l5
from credit_cards cc
inner join transactions t on cc.number=t.number;
select identifier,amount,type
from (select *,
		rank() over(partition by type
		   order by amount desc) as ranking
		from l5) l6
where l6.ranking=1;",,,"select m.code,m.name
from merchants m
except
select m.code,m.name
from merchants m
inner join transactions t on m.code=t.code
inner join credit_cards cc on t.number=cc.number
where t.amount >= 888
and (cc.type like '%visa%' or cc.type like '%diners-club%');",,
A0232009U,"select distinct cc.ssn
from credit_cards cc, transactions t
where cc.type = 'visa' and t.datetime between '2017-12-25' and '2017-12-26';",,,"select distinct c.first_name, c.last_name
from customers c
inner join credit_cards cc on c.ssn= cc.ssn
inner join credit_cards cc1 on c.ssn = cc1.ssn
where c.country = 'Singapore' and cc.type = 'visa' and cc1.type = 'jcb';",,,"select c.ssn, (case when count(*) isnull then 0 else count(*) end) as num_of_cc_owned
from customers c
left outer join credit_cards cc on c.ssn = cc.ssn
group by c.ssn
order by c.ssn;",,,"select cc.ssn, cc.type, (case when count(*) isnull then 0 else count(*) end) as num
from credit_cards cc
group by cc.ssn, cc.type
order by cc.ssn, cc.type;",,,"select c.country, count(distinct c.ssn) as num_of_customers
from customers c
inner join credit_cards cc on c.ssn = cc.ssn
inner join transactions t on cc.number = t.number
inner join merchants m on t.code = m.code
where c.country <> m.country
group by c.country
order by num_of_customers asc;",,,"select t.identifier
from transactions t
inner join credit_cards cc on t.number = cc.number
where t.amount = (
select max(t1.amount)
from transactions t1
inner join credit_cards cc1 on t1.number = cc1.number
where cc1.type = cc.type);",,,"select t.identifier
from transactions t
inner join credit_cards cc on t.number = cc.number
where t.amount >= ALL(
select t1.amount
from transactions t1
inner join credit_cards cc1 on t1.number = cc1.number
where cc1.type = cc.type);",,,"select m.code, m.name
from merchants m
except
select m1.code, m1.name
from transactions t
left outer join merchants m1 on m1.code = t.code
left outer join credit_cards cc on cc.number = t.number
where t.amount >= 888 and (cc.type like '%visa%' or cc.type like '%diners-club%');",,
A0232012E,"\i CCSchema.sql
\i CCCustomers.sql
\i CCCreditCards.sql
\i CCMerchants.sql
\i CCTransactions.sql
SELECT DISTINCT cc.ssn
FROM credit_cards cc, transactions t
WHERE t.number = cc.number
AND cc.type = 'visa'
AND t.datetime > '2017-12-24'
AND t.datetime < '2017-12-26';",,,"SELECT tmp_b.first_name, tmp_b.last_name
FROM(
SELECT DISTINCT c.first_name, c.last_name, c.ssn
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn
AND cc.type = 'visa'
INTERSECT
SELECT DISTINCT c.first_name, c.last_name, c.ssn
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn
AND cc.type = 'jcb') AS tmp_b;",,,"SELECT c.ssn, COUNT(cc.number)
FROM customers c LEFT OUTER JOIN credit_cards cc ON c.ssn = cc.ssn
GROUP BY c.ssn;",,,"SELECT tmp_d.ssn, tmp_d.type, COUNT(tmp_d.type)
FROM(
SELECT c.ssn, cc.number, cc.type
FROM customers c LEFT JOIN credit_cards cc ON c.ssn = cc.ssn
) AS tmp_d
GROUP BY tmp_d.ssn, tmp_d.type
ORDER BY tmp_d.ssn, tmp_d.type;",,,"SELECT c.country as cutomers_country, m.country as merchants_country, COUNT(*)
FROM customers c, credit_cards cc, merchants m, transactions t
WHERE t.number = cc.number
AND cc.ssn = c.ssn
AND m.code = t.code
AND m.country <> c.country
GROUP BY c.country, m.country;",,,"SELECT t.identifier
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
GROUP BY t.identifier, cc.type
HAVING (cc.type, MAX(t.amount)) IN (
SELECT cc1.type, MAX(t1.amount)
FROM transactions t1, credit_cards cc1
WHERE cc1.number = t1.number
GROUP BY cc1.type
);",,,"SELECT t.identifier
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
AND t.amount >= ALL(
SELECT t2.amount
FROM transactions t2, credit_cards cc2
WHERE t2.number = cc2.number
AND cc2.type = cc.type);",,,"SELECT DISTINCT t.code, m.name
FROM transactions t, merchants m, credit_cards cc
WHERE t.number = cc.number
AND t.code = m.code
AND t.code NOT IN(
SELECT DISTINCT t2.code
FROM transactions t2, credit_cards cc2
WHERE t2.amount >= 888
AND cc2.number = t2.number
AND ((cc2.type LIKE '%visa%') OR (cc2.type LIKE '%diners-club%'))
);
\i CCClean.sql",,
A0232013A,"SELECT DISTINCT(d.ssn)
FROM credit_cards d, transactions t
WHERE d.number=t.number
AND EXTRACT(YEAR FROM t.datetime) =  '2017'
AND EXTRACT(MONTH FROM t.datetime) =  '12'
AND EXTRACT(DAY FROM t.datetime) =  '25'
AND d.type = 'visa';",,,"SELECT DISTINCT ON(c.ssn) c.first_name, c.last_name
FROM customers c, credit_cards d, credit_cards d2
WHERE c.ssn=d.ssn AND c.ssn=d2.ssn
AND d.type='jcb' AND d2.type='visa' AND c.country='Singapore';",,,"SELECT c.ssn, COUNT(d.number)
FROM customers c LEFT OUTER JOIN credit_cards d ON c.ssn=d.ssn
GROUP BY c.ssn
ORDER BY c.ssn ASC;",,,"SELECT cd.ssn, cd.type, COUNT(d2.type)
FROM (
     SELECT DISTINCT c.ssn, d.type 
     FROM customers c, credit_cards d ) AS cd 
     LEFT OUTER JOIN credit_cards d2 ON cd.ssn=d2.ssn 
     AND cd.type=d2.type
GROUP BY cd.ssn, cd.type
ORDER BY cd.ssn;",,,"SELECT c.country, COUNT(c.ssn)
FROM merchants m, transactions t, credit_cards d, customers c
WHERE m.code=t.code AND d.number=t.number AND c.ssn=d.ssn
AND c.country <> m.country
GROUP BY c.country;",,,"SELECT t.identifier
FROM transactions t, credit_cards d, (
          SELECT MAX(t2.amount) AS maxvalue, d2.type AS maxcard
          FROM transactions t2, credit_cards d2
          WHERE t2.number=d2.number
          GROUP BY d2.type ) AS a
WHERE t.number=d.number
AND a.maxvalue = t.amount AND a.maxcard=d.type
ORDER BY t.identifier ASC;",,,"SELECT t.identifier
FROM transactions t, credit_cards d
WHERE t.number=d.number 
AND t.amount >= ALL (
	SELECT t2.amount
	FROM transactions t2, credit_cards d2
	WHERE t2.number=d2.number AND d.type=d2.type);",,,"SELECT t.code, m.name
FROM merchants m, transactions t, credit_cards d
WHERE m.code=t.code AND t.number=d.number
EXCEPT
SELECT t.code, m.name
FROM merchants m, transactions t, credit_cards d
WHERE m.code=t.code AND t.number=d.number
AND (d.type LIKE ('%visa%') OR d.type LIKE '%diners-club%')
GROUP BY t.code, m.name
HAVING MAX(t.amount) >= 888;",,
A0232015Y,"select cm.ssn 
from customers cm, credit_cards cc, transactions t
where TO_CHAR(t.datetime,'yyyy-mm-dd')='2017-12-25'
and cc.type='visa'
and t.number=cc.number
and cc.ssn=cm.ssn",,,"select cms.first_name, cms.last_name
from (select distinct(cm.ssn) ,cm.first_name, cm.last_name
	  from customers cm, credit_cards cc1, credit_cards cc2
where cc1.type='jcb'
and cc2.type='visa'
and cm.country='Singapore'
and cc1.ssn=cc2.ssn
and cm.ssn=cc2.ssn) as cms",,,"select cm.ssn, (case when count(cc.*) isnull 
				then 0 else count(cc.*) 
				end) as number_of_cards
from customers cm
left outer join credit_cards cc on cm.ssn=cc.ssn
group by cm.ssn
order by number_of_cards asc",,,"select cm.ssn, t4.type, count(cc.number) as number_of_cards
from customers cm
cross join (select distinct type 
			from credit_cards) as t4
left outer join credit_cards cc 
	on cm.ssn=cc.ssn and cc.type=t4.type
group by cm.ssn,t4.type
order by cm.ssn asc, t4.type asc, number_of_cards asc",,,"select cm.country, count(*)
from customers cm
where cm.ssn in (
	select distinct(cm.ssn)
	from customers cm, merchants m, credit_cards cc, transactions t
	where m.code=t.code
	and t.number=cc.number
	and cc.ssn=cm.ssn
	and cm.country <> m.country)
group by cm.country",,,"select tt.identifier
from (select cc.type, max(t.amount)as max_amount
	from credit_cards cc, transactions t
	where t.number=cc.number
	group by cc.type) as mx
left join (select * 
		   from credit_cards cc, transactions t
	       where t.number=cc.number ) as tt
	on mx.type=tt.type and mx.max_amount=tt.amount",,,"select x1.identifier
from (select *
	 from transactions t1, credit_cards cc1
	 where t1.number=cc1.number) 
	 as x1
where x1.amount>= all (
	select t2.amount
	from credit_cards cc2, transactions t2
	where t2.number=cc2.number
	and x1.type=cc2.type)",,,"select code, name 
from merchants
where code not in (
	select m.code 
	from merchants m,credit_cards cc, transactions t
	where m.code=t.code
	and cc.number=t.number
	and t.amount>=888
	and (cc.type='visa' or cc.type='diners-club')
)","Missing semicolon, CHECK CODE.","Missing semicolon, CHECK CODE."
A0232016X,"SELECT DISTINCT cc.ssn 
FROM credit_cards cc
WHERE cc.number IN (
	SELECT t.number
	FROM transactions t
	WHERE t.datetime >= '2017-12-25 00:00:00'
	AND t.datetime <= '2017-12-25 23:59:59')
AND cc.type = 'visa';",,,"SELECT i.first_name, i.last_name
FROM (
	SELECT c.ssn, c.first_name, c.last_name
	FROM customers c, credit_cards cc
	WHERE c.ssn = cc.ssn
	AND c.country = 'Singapore'
	AND cc.type = 'jcb'
	INTERSECT
	SELECT c.ssn, c.first_name, c.last_name
	FROM customers c, credit_cards cc
	WHERE c.ssn = cc.ssn
	AND c.country = 'Singapore'
	AND cc.type = 'visa'
	) i;",,,"SELECT c.ssn, count(cc.number)
FROM customers c
FULL OUTER JOIN credit_cards cc ON c.ssn = cc.ssn
GROUP BY c.ssn
ORDER BY COUNT(cc.number);",,,"SELECT allcards.ssn, allcards.type, COUNT(cc1.number)
FROM (
	SELECT c.ssn, cc.type
	FROM customers c, (
		SELECT DISTINCT type
		FROM credit_cards
	) cc
) allcards
LEFT JOIN credit_cards cc1 ON (allcards.ssn, allcards.type) = (cc1.ssn, cc1.type)
GROUP BY allcards.ssn, allcards.type
Order BY allcards.ssn, allcards.type;",,,"SELECT DISTINCT c.country, count(*)
FROM customers c
WHERE c.ssn IN(
	SELECT cc.ssn
	FROM (credit_cards cc FULL OUTER JOIN transactions t ON cc.number =  t.number) FULL OUTER JOIN merchants m ON t.code = m.code
	WHERE t.identifier IS NOT NULL
	AND m.country <> c.country)
GROUP BY c.country;",,,"SELECT t1.identifier
FROM transactions t1 FULL OUTER JOIN credit_cards cc1 ON t1.number = cc1.number
WHERE (t1.amount, cc1.type) IN (
	SELECT MAX(t2.amount), cc2.type
	FROM transactions t2 FULL OUTER JOIN credit_cards cc2 ON t2.number = cc2.number
	GROUP BY cc2.type);",,,"SELECT t1.identifier
FROM transactions t1 FULL OUTER JOIN credit_cards cc1 ON t1.number = cc1.number
WHERE t1.amount >= ALL (
	SELECT t2.amount
	FROM transactions t2 FULL OUTER JOIN credit_cards cc2 ON t2.number = cc2.number
	WHERE cc1.type = cc2.type);",,,"SELECT DISTINCT code, name
FROM merchants
WHERE (code, name) NOT IN (
	SELECT DISTINCT m.code, m.name
	FROM merchants m, transactions t, (
		SELECT *
		FROM credit_cards
		WHERE type LIKE '%visa%' OR type LIKE '%diners-club%') cc
	WHERE m.code = t.code
	AND t.number = cc.number
	GROUP BY m.code, cc.type
	HAVING MAX(t.amount) >= 888);",,
A0232022A,"select  a.ssn from (
	select * from credit_cards a
	left join
	transactions b
	on a.number=b.number
	where substr(cast(b.datetime as VARCHAR(32)),1,10) = '2017-12-25'
	and a.type = 'visa') as a
group by ssn;",,,"select first_name, last_name 
from credit_cards a
inner join credit_cards b
on a.ssn = b.ssn
inner join customers c
on c.ssn = b.ssn
where a.type= 'visa'
and b.type = 'jcb'
and c.country='Singapore'
group by c.ssn;",,,"select a.ssn, count(b.number) as num from customers a
left join credit_cards b
on a.ssn=b.ssn
group by a.ssn;",,,"select t2.ssn,t2.type,coalesce(t3.num,'0') as num from 
	(select ssn,t1.type from customers
	cross join 
		(select type from credit_cards
		group by type)t1)t2
left join 
	(select ssn,type, num as num from (
	select a.ssn,b.type, count(b.type) as num
	from customers a
	left join 
		credit_cards b
		on a.ssn = b.ssn
		group by a.ssn,b.type) t1) t3
on t2.ssn = t3.ssn
and t2.type=t3.type;",,,"select x.country, count(1) from (
select  distinct a.ssn,a.country from
customers a 
inner join credit_cards b
on a.ssn=b.ssn
inner join transactions c
on b.number = c.number
inner join merchants d
on c.code = d.code
where a.country <> d.country ) x
group by x.country;",,,"select identifier from 
(select a.type, max(b.amount) as max_amt
from credit_cards a
inner join transactions b 
on a.number=b.number
group by a.type) z
left join 
(select v.type, c.amount, c.identifier
from credit_cards v
inner join transactions c
on v.number=c.number ) x
on z.max_amt = x. amount
and z.type = x.type;",,,"select identifier from (
select identifier,
ROW_NUMBER() OVER(PARTITION BY a.type ORDER BY b.amount) as index
from credit_cards a
inner join transactions b 
on a.number=b.number) g
where g.index = '1';",,,"select  z.code, z.name from 
(select c.code,c.name,b.amount,
ROW_NUMBER() OVER(PARTITION BY b.code,c.name ORDER BY b.amount desc) as index
from credit_cards a
inner join transactions b
on a.number = b. number
inner join merchants c
on b.code = c.code 
where a.type like '%visa%'
or a.type like '%diners-club%')z
where z.index ='1'
and z.amount < '888'
group by  z.code, z.name;",,
A0232060Y,"SELECT distinct cr.ssn FROM credit_cards cr, transactions t 
WHERE (cr.type = 'visa' 
	   and t.datetime BETWEEN '2017-12-24 23:59:59.999999 '
	   AND'2017-12-25 23:59:59.999999')",,,"SELECT distinct cu.first_name,cu.last_name FROM 
customers cu
INNER JOIN credit_cards d ON cu.ssn = d.ssn
INNER JOIN credit_cards d2 ON d.ssn = d2.ssn
WHERE
d.type = 'visa'
and d2.type= 'jcb'
and cu.country = 'Singapore'",,,"SELECT t.ssn, count(*)
from customers c left join credit_cards t on c.ssn = t.ssn
group by t.ssn",,,"SELECT cr.ssn, cr.type, count(*) 
from credit_cards cr, customers c,transactions t
where c.ssn = cr.ssn
and t.number = cr.number
group by cr.ssn, cr.type 
ORDER BY cr.ssn DESC",,,"select q.country,count(distinct q.ssn)
from transactions t
inner join credit_cards cr on t.number = cr.number
inner join customers q on cr.ssn = q.ssn
inner join merchants me on me.code = t.code
where me.country != q.country
group by q.country 
order by count(*) desc",,,"SELECT cr.type, t.identifier, t.amount 
from transactions t
inner join credit_cards cr on t.number = cr.number
where t.amount = (
     select max(tr.amount)
     from transactions tr inner join credit_cards cr1
     on tr.number = cr1.number
     and cr.type = cr1.type)
group by t.identifier, cr.type, t.amount
ORDER BY t.identifier ASC",,,"select cr.type, t.identifier,t.amount
from transactions t
inner join credit_cards cr on t.number = cr.number
where t.amount >= all (
select t1.amount
from transactions t1 inner join 
	credit_cards cr1 on t1.number = cr1.number
where cr1.type = cr.type)",,,"SELECT distinct me.code, me.name
from merchants me 
where me.code not in 
(select distinct me.code 
 from transactions tr 
inner join merchants me on tr.code = me.code
inner join credit_cards cr on cr.number = tr.number
 where tr.amount >= 888
 and (cr.type like '%visa%' or cr.type like '%diners-club%') )","Missing semicolon, CHECK CODE.","Missing semicolon, CHECK CODE."
A0232064R,"select  distinct c.ssn from customers c, transactions t,credit_cards cr
where 
c.ssn=cr.ssn
and t.number=cr.number
and date(t.datetime) = '2017-12-25' 
and cr.type='visa';",,,"select uni.first_name, uni.last_name from (
select c.ssn, c.first_name, c.last_name
from customers c 
join credit_cards cr ON c.ssn = cr.ssn
where cr.type = 'visa' 
and c.country = 'Singapore'
intersect
select c.ssn, c.first_name, c.last_name
from customers c 
join credit_cards cr ON c.ssn = cr.ssn
where cr.type = 'jcb' 
and c.country = 'Singapore'
) as uni;",,,"select c.ssn, count(cr.number) as number_of_cards from customers c 
left join 
credit_cards cr on c.ssn = cr.ssn
group by c.ssn
;",,,"select id.ssn, bank.type, Count(cr.number) as number_of_cards
from (
Select distinct c.ssn
from customers c
	) id
cross join 
	(
select distinct cr.type
from credit_cards cr
	) bank
	left Join credit_cards cr ON id.ssn = cr.ssn 
	                        and bank.type = cr.type
group by id.ssn, 
         bank.type;",,,"select c.country, count(distinct c.ssn)
from transactions t 
join credit_cards cc on t.number = cc.number
join customers c ON cc.ssn = c.ssn
join merchants m ON t.code = m.code
where c.country <> m.country
group by c.country;",,,"select t.identifier from transactions t
                    join credit_cards cr on t.number = cr.number
where (cr.type, t.amount) in
	(
	select cr.type, max(t1.amount) 
 	from transactions t1
 	join credit_cards cr on t1.number = cr.number
 	group by cr.type
 	);",,,"select t.identifier from transactions t 
                    join credit_cards cr on t.number = cr.number
where t.amount >= all(
	select t1.amount from transactions t1
	join credit_cards cre on t1.number = cre.number
	where cr.type = cre.type);",,,"select distinct m.name,m.code
from merchants m
where (m.name, m.code) NOT IN
(
	select m.name,m.code from transactions t 
	join credit_cards cr on t.number = cr.number
	join merchants m on t.code = m.code
	where t.amount >= 888
	and (cr.type like '%visa%' or 
		  cr.type like '%diners-club%')
 );",,
A0232193L,"select distinct c.ssn
from customers c, transactions d, credit_cards e
where c.ssn = e.ssn
and e.number = d.number
and EXTRACT(DAY FROM d.datetime) = 25
and e.type= 'visa';",,,"select a.first_name, a.last_name
from(select distinct c.first_name, c.last_name, c.ssn
from customers c, credit_cards d, credit_cards e
where c.ssn = d.ssn
and d.ssn = e.ssn
and c.country = 'Singapore'
and d.type = 'jcb'
and e.type = 'visa') a;",,,"select c.ssn, count(distinct d.number) as num
from customers c
left join credit_cards d
on c.ssn = d.ssn
group by c.ssn",,,"select c.ssn, d.type, count(distinct d.number) as num_of_credit_cards
from
(select *, 1 as link 
from customers) as c
outer join
(select distinct type, 1 as link
from credit_cards) as d
on c.link = d.link
left join credit_cards e
on c.ssn = e.ssn
and d.type = e.type
group by c.ssn, d.type;",,,"select c.country, count(distinct c.ssn)
from customers c
left join credit_cards d
on c.ssn = d.ssn
left join transactions e
on d.number = e.number
left join merchants f
on e.code = f.code
where c.country <> f.country
group by c.country;",,,"select c.identifier, d.type
from transactions c, credit_cards d
where c.number = d.number
and c.amount >= (
    select max(e.amount)
    from transactions e, credit_cards f
    where e.number = f.number
    and f.type = d.type
    group by f.type
)",,,"SELECT d.type, c.identifier
FROM transactions c, credit_cards d
WHERE c.number = d.number
AND c.amount >= ALL(
    SELECT e.amount 
    FROM transactions e, credit_cards f 
    WHERE e.number = f.number AND f.type=d.type);",,,"select c.code, c.name
from merchants c
left join transactions d
on c.code = d.code
left join credit_cards e
on d.number = e.number
where e.type like '%visa%' or e.type like '%diners-club%'
group by c.code, c.name
having max(d.amount) < 888;",,
A0232194J,"SELECT 
	DISTINCT cc.ssn
FROM 
	credit_cards cc, transactions t
WHERE 
	t.number = cc.number
	AND (t.datetime BETWEEN '2017-12-25 00:00:00' AND '2017-12-25 23:59:59')
	AND cc.type = 'visa';",,,"SELECT 
	r.first_name, r.last_name
FROM (
	SELECT 
		c.first_name, c.last_name, c.ssn
	FROM 
		customers c, credit_cards cc
	WHERE 
		c.ssn = cc.ssn
		AND c.country = 'Singapore'
		AND cc.type = 'jcb' 
	INTERSECT
	SELECT 
		c.first_name, c.last_name, c.ssn 
	FROM 
		customers c, credit_cards cc
	WHERE 
		c.ssn = cc.ssn
		AND c.country = 'Singapore'
		AND cc.type = 'visa'
) r;",,,"SELECT 
	c.ssn, 
	COALESCE(r.count, 0) AS count
FROM
	customers c
LEFT OUTER JOIN
(
	SELECT 
		ssn, COUNT(*) AS count 
	FROM 
		credit_cards
	GROUP BY ssn
) r
ON r.ssn = c.ssn;",,,"SELECT
	a.ssn,
	a.type,
	coalesce(b.count, 0) AS count
FROM
(
	SELECT 
		c.ssn, cc.type
	FROM 
		customers c, credit_cards cc
	GROUP BY c.ssn, cc.type
) a
LEFT OUTER JOIN
(
	SELECT 
		ssn, type, COUNT(*) AS count 
	FROM 
		credit_cards
	GROUP BY ssn, type
) b
ON a.ssn = b.ssn AND a.type = b.type
ORDER BY a.ssn;",,,"SELECT 
	y.cus_country AS country, COUNT(*) AS count
FROM
(
	SELECT DISTINCT x.ssn, x.cus_country
	FROM
	(
		SELECT
			b.ssn, b.country AS cus_country, m.country AS mer_country
		FROM
		(
			SELECT
				t.number, t.code, a.ssn, a.country
			FROM 
				transactions t
			LEFT OUTER JOIN 
			(
				SELECT 
					cc.number, cc.ssn, c.country
				FROM 
					credit_cards cc
				LEFT OUTER JOIN
					customers c
				ON cc.ssn = c.ssn
			) a
			ON t.number = a.number
		) b
		LEFT OUTER JOIN
			merchants m
		ON b.code = m.code
	) x
	WHERE x.cus_country != x.mer_country
) y
GROUP BY y.cus_country;",,,"SELECT
	b.identifier, a.type, a.max_amount
FROM
(
	SELECT
		MAX(x.amount) AS max_amount, x.type
	FROM
	(
		SELECT
			t.identifier, t.amount, cc.type
		FROM
			transactions t
		LEFT OUTER JOIN
			credit_cards cc
		ON t.number = cc.number
	) x
GROUP BY x.type
) a
LEFT OUTER JOIN
(
	SELECT
		t.identifier, t.amount, cc.type
	FROM
		transactions t
	LEFT OUTER JOIN
		credit_cards cc
	ON t.number = cc.number
) b
ON a.max_amount = b.amount AND a.type = b.type;",,,"SELECT 
	y.identifier, y.type, y.amount 
FROM 
(SELECT
		t1.identifier, t1.amount, cc1.type
	FROM
		transactions t1
	LEFT OUTER JOIN
		credit_cards cc1
	ON t1.number = cc1.number
) y
WHERE y.amount >= ALL (
	SELECT x.amount FROM
	(
		SELECT
			t.identifier, t.amount, cc.type
		FROM
			transactions t
		LEFT OUTER JOIN
			credit_cards cc
		ON t.number = cc.number
	) x
	WHERE x.type = y.type);",,,"SELECT
	a.code, m.name
FROM
(
	SELECT
		t.amount, t.code
	FROM
		transactions t
	LEFT OUTER JOIN
		credit_cards cc
	ON t.number = cc.number
	WHERE cc.type IN ('visa', 'diners-club')
) a
LEFT OUTER JOIN
merchants m
ON a.code = m.code
WHERE a.amount < 888;",,
A0232195H,"SELECT c.ssn
FROM customers c, credit_cards e, transactions t
WHERE c.ssn=e.ssn AND e.number=t.number
AND e.type='visa'
AND (t.datetime>='2017-12-25 00:00:00.000000'AND t.datetime<'2017-12-26 00:00:00.000000');",,,"SELECT c.first_name, c.last_name
From customers c, credit_cards e
WHERE c.ssn=e.ssn
AND c.country='Singapore'
AND e.type='jcb'
INTERSECT
SELECT c.first_name, c.last_name
From customers c, credit_cards e
WHERE c.ssn=e.ssn
AND c.country='Singapore'
AND e.type='visa';",,,"Select c.ssn, count (DISTINCT e.number) 
From customers c, credit_cards e
WHERE c.ssn=e.ssn
Group By c.ssn
UNION
SELECT c.ssn, 0
FROM customers c
Where c.ssn NOT IN (
       Select e.ssn
       From credit_cards e);",,,"Select c.ssn,
      (CASE WHEN c.ssn NOT IN (
	  SELECT e.ssn
	  From credit_cards e)
	  Then 'O'
	  ELSE e.type END) As type,
	   (CASE WHEN c.ssn NOT IN (
	  SELECT e.ssn
	  From credit_cards e)
	  Then '0'
	  ELSE count (e.type)END ) As number
From customers c, credit_cards e
WHERE c.ssn=e.ssn
GROUP By c.ssn, e.type
ORDER By c.ssn, e.type;",,,"SELECT c.country, count(distinct c.ssn)
FROM customers c, credit_cards e, transactions t, merchants m
WHERE c.ssn=e.ssn
AND e.number=t.number
AND t.code=m.code
GROUP BY c.country
Except
SELECT c.country, count(distinct c.ssn)
FROM customers c, credit_cards e, transactions t, merchants m
WHERE c.ssn=e.ssn
AND e.number=t.number
AND t.code=m.code
AND c.country =m.country
GROUP BY c.country;",,,"SELECT DISTINCT e.type, t.identifier
FROM transactions t, credit_cards e
WHERE t.number=e.number
GROUP BY e.type, t.identifier
Having t.amount =ANY
         (select  max(t.amount)
		 From transactions t, credit_cards e
		  Where t.number = e.number
		 Group By e.type);",,,"SELECT e.type, t.identifier
FROM transactions t, credit_cards e
WHERE t.number=e.number
AND t.amount>= ALL
 (select t.amount
 From transactions t);",,,"(SELECT DISTINCT m.code, m.name
From merchants m, transactions t, credit_cards e
WHERE e.number=t.number AND t.code=m.code
AND 'visa' in (e.type)
EXCEPT
SELECT DISTINCT m.code, m.name
From merchants m, transactions t, credit_cards e
WHERE e.number=t.number AND t.code=m.code
AND 'visa' in (e.type)
AND t.amount >=888)
UNION
(SELECT DISTINCT m.code, m.name
From merchants m, transactions t, credit_cards e
WHERE e.number=t.number AND t.code=m.code
AND 'diners-club' in (e.type)
EXCEPT
SELECT DISTINCT m.code, m.name
From merchants m, transactions t, credit_cards e
WHERE e.number=t.number AND t.code=m.code
AND 'diners-club' in (e.type)
AND t.amount >=888);",,
A0232196E,"select distinct c.ssn from transactions t join credit_cards c 
on t.number = c.number where date(t.datetime) = '2017-12-25' 
and c.type = 'visa';",,,"select first_name, last_name from customers where ssn in 
(select c.ssn from customers c join credit_cards cc on c.ssn = cc.ssn
where c.country = 'Singapore' and cc.type = 'jcb')
and ssn in 
(select c.ssn from customers c join credit_cards cc on c.ssn = cc.ssn
where c.country = 'Singapore' and cc.type = 'visa')
;",,,"select c.ssn, count(cc.ssn) 
from customers c left join credit_cards cc 
on c.ssn = cc.ssn
group by c.ssn
order by count(cc.ssn) desc;",,,"select a.ssn, a.type, COUNT(cc.type)
from (select distinct c.ssn, cc.type
FROM customers c, credit_cards cc) a
left join credit_cards cc
on a.ssn = cc.ssn
and a.type = cc.type
group by a.ssn, a.type
order by a.ssn;",,,"select c.country, count(distinct c.ssn) from
transactions t join merchants m on t.code = m.code
join credit_cards cc on t.number = cc.number 
join customers c on cc.ssn = c.ssn
where c.country != m.country
group by c.country;",,,"select cc.type, t.amount, t.identifier 
from transactions t
join credit_cards cc on t.number = cc.number
where (cc.type, t.amount) in (select cc.type, max(tt.amount)
from transactions tt join credit_cards cc on tt.number = cc.number
group by cc.type);",,,"SELECT cc.type, t.identifier, t.amount
from credit_cards cc join transactions t
on cc.number = t.number 
and t.amount >= all(
select tt.amount from transactions tt, credit_cards ccc
where tt.number = ccc.number and cc.type = ccc.type);",,,"select distinct m.code, m.name
from merchants m
where m.code not in 
(select m.code from transactions t, credit_cards cc, merchants m
where m.code = t.code and t.number = cc.number
and t.amount >= 888
and (cc.type like 'visa%' or cc.type like 'diners_club%'));",,
A0232321Y,"SELECT DISTINCT cc.ssn
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
AND date(t.datetime) = '2017-12-25'
AND cc.type = 'visa';",,,"SELECT c.first_name, c.last_name
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn
AND cc.type = 'jcb'
AND c.country = 'Singapore'
GROUP BY c.ssn
INTERSECT
SELECT c.first_name, c.last_name
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn
AND cc.type = 'visa'
AND c.country = 'Singapore'
GROUP BY c.ssn;",,,"SELECT c.ssn, COUNT(cc.number)
FROM customers c
LEFT JOIN credit_cards cc ON c.ssn = cc.ssn
GROUP BY c.ssn
ORDER BY c.ssn;",,,"SELECT c.ssn, type.type, COUNT(cc.number)
FROM customers c
CROSS JOIN
(SELECT DISTINCT cc.type FROM credit_cards cc) type
LEFT JOIN credit_cards cc ON c.ssn = cc.ssn AND type.type = cc.type
GROUP BY c.ssn,type.type
ORDER BY c.ssn, type.type;",,,"SELECT c.country, COUNT(DISTINCT c.ssn)
FROM customers c, credit_cards cc, transactions t, merchants m
WHERE c.ssn = cc.ssn
AND cc.number = t.number
AND t.code = m.code
AND c.country != m.country
GROUP BY c.country;",,,"SELECT t.identifier
FROM transactions t, credit_cards cc,
	(SELECT cc1.type AS type, MAX(t1.amount) AS amount
	FROM transactions t1,credit_cards cc1
	WHERE cc1.number = t1.number
	GROUP BY cc1.type) max_amount
WHERE t.number = cc.number
AND t.amount = max_amount.amount
AND cc.type = max_amount.type;",,,"SELECT t.identifier
FROM transactions t, credit_cards cc
WHERE t.amount >= ALL (
		SELECT t1.amount
		FROM transactions t1, credit_cards cc1
		WHERE t1.number = cc1.number
		AND cc1.type = cc.type)
AND cc.number = t.number;",,,"SELECT DISTINCT x.code, x.name
FROM  
	(SELECT m.code AS code, m.name AS name, MAX(t.amount) AS max_amount
	FROM transactions t, merchants m, credit_cards cc
	WHERE t.code = m.code
	AND t.number = cc.number
	AND (cc.type = 'visa' or cc.type = 'diners_club')
	GROUP BY m.code) x
WHERE x.max_amount < 888;",,
A0232322X,"SELECT DISTINCT cc.ssn 
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
AND (t.datetime >= '2017-12-25 00:00:01' AND t.datetime <= '2017-12-25 23:59:59')
AND cc.type = 'visa'
ORDER BY cc.ssn;",,,"SELECT cs.first_name, cs.last_name 
FROM (SELECT c.ssn, c.first_name, c.last_name
	FROM credit_cards cc, customers c
	WHERE cc.type = 'visa'
	AND c.country = 'Singapore' 
	AND cc.ssn = c.ssn
	INTERSECT
	SELECT c.ssn, c.first_name, c.last_name
	FROM credit_cards cc, customers c
	WHERE cc.type = 'jcb'
	AND c.country = 'Singapore' 
	AND cc.ssn = c.ssn) AS cs
ORDER BY cs.first_name, cs.last_name;",,,"SELECT c.ssn, COUNT(cc.number) AS number_of_cc_owned
FROM customers c 
LEFT OUTER JOIN credit_cards cc ON c.ssn= cc.ssn
GROUP BY c.ssn
ORDER BY number_of_cc_owned, c.ssn;",,,"SELECT c.ssn, cc.type, COUNT(credit_cards.number) as number_of_cc_owned
FROM customers c CROSS JOIN(
	SELECT DISTINCT credit_cards.type
	FROM credit_cards) AS cc
LEFT OUTER JOIN credit_cards ON c.ssn = credit_cards.ssn 
AND cc.type = credit_cards.type
GROUP BY c.ssn, cc.type
ORDER BY c.ssn, cc.type;",,,"SELECT c.country, COUNT(DISTINCT c.ssn) AS number_of_customers
FROM customers c, credit_cards cc, merchants m, transactions t
WHERE c.ssn = cc.ssn
AND t.code = m.code
AND t.number = cc.number
AND c.country <> m.country
GROUP BY c.country;",,,"SELECT t.identifier, cc.type, t.amount
FROM transactions t
LEFT OUTER JOIN credit_cards cc ON t.number=cc.number
WHERE (cc.type, t.amount) IN (
	SELECT cc.type, MAX(t1.amount)
	FROM transactions t1
	LEFT OUTER JOIN credit_cards cc ON t1.number = cc.number
	GROUP BY cc.type)
ORDER BY cc.type;",,,"SELECT t.identifier, cc.type, t.amount
FROM credit_cards cc
LEFT OUTER JOIN transactions t ON cc.number = t.number
WHERE (cc.type, t.amount) >= ALL(
	SELECT cc1.type, t1.amount
	FROM credit_cards cc1
	LEFT OUTER JOIN transactions t1 ON cc1.number = t1.number
	WHERE cc.type = cc1.type)
ORDER BY t.identifier, cc.type;",,,"SELECT DISTINCT m.code, m.name
FROM merchants m
WHERE m.code NOT IN (
	SELECT m1.code
	FROM merchants m1
	INNER JOIN transactions t ON t.code = m1.code
	INNER JOIN credit_cards cc ON t.number = cc.number
	WHERE t.amount >= 888
	AND (cc.type LIKE '%visa%' OR cc.type LIKE '%diners-club%'))
ORDER BY m.code;",,
sample,"SELECT DISTINCT cc.ssn
FROM transactions t, credit_cards cc
WHERE cc.number = t.number AND cc.type='visa' AND
t.datetime BETWEEN '2017-12-25 00:00:00' AND '2017-12-26 00:00:00';",,,"SELECT c.first_name, c.last_name
FROM customers c, credit_cards cc1, credit_cards cc2
WHERE c.ssn = cc1.ssn AND c.ssn=cc2.ssn
AND cc1.type = 'jcb'
AND cc2.type = 'visa'
AND c.country = 'Singapore'
GROUP BY c.ssn, c.first_name, c.last_name;",,,"SELECT c.ssn, COUNT(cc.number)
FROM customers c LEFT OUTER JOIN credit_cards cc ON c.ssn = cc.ssn
GROUP BY c.ssn
ORDER BY COUNT(cc.number) ASC;",,,"SELECT c1.ssn , c1.type ,COUNT(cc1.number)
FROM
(SELECT DISTINCT c2.ssn , cc2.type
FROM customers c2, credit_cards cc2) AS c1
LEFT OUTER JOIN credit_cards cc1
ON c1.ssn = cc1.ssn
AND c1.type = cc1.type
GROUP BY c1.ssn, c1.type
ORDER BY c1.ssn;",,,"SELECT c.country, COUNT(DISTINCT c.ssn )
FROM customers c, merchants m, transactions t , credit_cards cc
WHERE c.ssn = cc.ssn
AND cc.number = t.number
AND m.code = t.code
AND c.country <> m.country
GROUP BY c.country;",,,"SELECT t1.identifier
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number AND
(cc1.type , t1.amount) IN
(SELECT cc2.type , MAX(t2.amount)
FROM transactions t2, credit_cards cc2
WHERE t2.number=cc2.number
GROUP BY cc2.type);",,,"SELECT t1.identifier
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number AND t1.amount>=ALL(
	SELECT t2.amount FROM transactions t2, credit_cards cc2
	WHERE t2.number=cc2.number AND cc1.type=cc2.type
);",,,"SELECT m.code, m.name
FROM merchants m
WHERE NOT EXISTS (
	SELECT *
	FROM transactions t, credit_cards cc
	WHERE t.code = m.code
	AND t.number = cc.number
	AND (cc.type LIKE '%visa%'
	OR cc.type LIKE '%diners-club%')
	AND t.amount >= 888);",,
