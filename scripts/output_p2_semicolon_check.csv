student,1.a,comment,1.b,comment,1.c,comment,1.d,comment,1.e,comment,1.f,comment,1.g,comment,1.h,comment
A0105567A,"SELECT DISTINCT cc.ssn 
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
AND cc.type = 'visa'
AND t.datetime Between '2017-12-25' AND '2017-12-26'","Missing semicolon, CHECK CODE.","SELECT first_name, last_name 
FROM(
	SELECT DISTINCT c.first_name, c.last_name, c.ssn
	FROM customers c, credit_cards cc
	WHERE c.ssn = cc.ssn
	AND c.country = 'Singapore'
	AND cc.type = 'jcb'
INTERSECT 
	SELECT DISTINCT c2.first_name, c2.last_name, c2.ssn
	FROM credit_cards cc2, customers c2
	WHERE c2.country = 'Singapore'
	AND c2.ssn = cc2.ssn
	AND cc2.type = 'visa') AS temp","Missing semicolon, CHECK CODE.","SELECT c.ssn, count(number) 
FROM customers c LEFT OUTER JOIN credit_cards cc 
ON c.ssn = cc.ssn
GROUP by c.ssn","Missing semicolon, CHECK CODE.","DROP VIEW IF EXISTS all_cards;
CREATE VIEW all_cards AS
SELECT *
FROM customers c CROSS JOIN (SELECT DISTINCT cc.type 
							FROM credit_cards cc) AS c_type;
SELECT ac.ssn, ac.type, count(number)
FROM all_cards ac LEFT OUTER JOIN credit_cards cc
ON (ac.ssn, ac.type) = (cc.ssn, cc.type)
GROUP BY ac.ssn, ac.type",,"SELECT c.country, count(DISTINCT c.ssn)
FROM customers c, credit_cards cc, merchants m, transactions t
WHERE m.code = t.code
AND c.ssn = cc.ssn
AND cc.number = t.number
AND c.country <> m.country
GROUP by c.country","Missing semicolon, CHECK CODE.","SELECT cc.type, t.identifier
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
AND (cc.type, t.amount) in (
	SELECT cc2.type, MAX(t2.amount)
	FROM credit_cards cc2, transactions t2
	WHERE cc2.number = t2.number
	GROUP BY cc2.type)","Missing semicolon, CHECK CODE.","SELECT cc.type, t.identifier
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
AND (cc.type, t.amount) >=ALL(
	SELECT cc2.type, t2.amount
	FROM credit_cards cc2, transactions t2
	WHERE cc2.number = t2.number
	AND cc.type = cc2.type)","Missing semicolon, CHECK CODE.","SELECT m.name
FROM merchants m
WHERE m.name NOT IN (
	SELECT m2.name
	FROM merchants m2, transactions t2, credit_cards cc2
	WHERE m2.code = t2.code
	AND t2.number = cc2.number
    AND (cc2.type like '%visa%' OR cc2.type like '%diners-club%')
	AND t2.amount >=888)","Missing semicolon, CHECK CODE."
A0113028W,"SELECT DISTINCT cr.ssn
FROM credit_cards cr, transactions t
WHERE cr.number = t.number
AND (SELECT date(t.datetime)) = '2017-12-25'
AND cr.type = 'visa';",,"SELECT DISTINCT cu.first_name, cu.last_name
FROM customers cu, credit_cards cr1, credit_cards cr2
WHERE cu.ssn = cr1.ssn
AND cu.ssn = cr2.ssn
AND cu.country = 'Singapore'
AND cr1.type = 'jcb'
AND cr2.type = 'visa';",,"SELECT cu.ssn, COUNT(cr.number) AS no_of_cc_owned
FROM customers cu LEFT JOIN credit_cards cr ON cu.ssn = cr.ssn
GROUP BY cu.ssn;",,"SELECT cu.ssn, (CASE WHEN cr.type IS NULL THEN '0' ELSE cr.type END), COUNT(cr.type) AS no_of_cctype_owned
FROM customers cu LEFT JOIN credit_cards cr ON cu.ssn = cr.ssn
GROUP BY cu.ssn, cr.type;",,"SELECT cu.country, count(DISTINCT cu.ssn) AS no_of_customer
FROM customers cu, credit_cards cr, transactions t, merchants m
WHERE cu.ssn = cr.ssn
AND cr.number = t.number
AND t.code = m.code
AND m.country <> cu.country
GROUP BY cu.country;",,"SELECT t1.identifier
FROM transactions t1, credit_cards cr1
WHERE t1.number = cr1.number
AND (cr1.type, t1.amount) IN (
		SELECT cr2.type, MAX(t2.amount)
		FROM transactions t2, credit_cards cr2
		WHERE cr2.number = t2.number
		GROUP BY cr2.type);",,"SELECT t1.identifier
FROM transactions t1, credit_cards cr1
WHERE t1.number = cr1.number
AND t1.amount >= ALL (
		SELECT t2.amount
		FROM transactions t2, credit_cards cr2
		WHERE cr2.number = t2.number
		AND cr1.type = cr2.type);",,"SELECT DISTINCT m1.code, m1.name
FROM merchants m1
WHERE m1.name IN (
	SELECT m2.name
	FROM merchants m2, transactions t, credit_cards cr
	WHERE t.code = m2.code
	AND cr.number = t.number
	AND cr.type LIKE '%diners-club%'
	GROUP BY m2.name
	HAVING MAX(t.amount) < 888
	UNION
	SELECT m3.name
	FROM merchants m3, transactions t, credit_cards cr
	WHERE t.code = m3.code
	AND cr.number = t.number
	AND cr.type LIKE '%visa%'
	GROUP BY m3.name
	HAVING MAX(t.amount) < 888)","Missing semicolon, CHECK CODE."
A0113951L,"select c.ssn
from customers c, credit_cards cc, transactions t
where c.ssn = cc.ssn
and t.number = cc.number
and cc.type = 'visa'
and date(t.datetime::date) = '2017-12-25'","Missing semicolon, CHECK CODE.","select c.first_name, c.last_name
from customers c, credit_cards cc, credit_cards cc1
where c.ssn = cc.ssn
and c.ssn = cc1.ssn
and (cc.type = 'visa' and cc1.type = 'jcb')
order by c.ssn","Missing semicolon, CHECK CODE.","select c.ssn, count(*)
from customers c left join credit_cards cc
on c.ssn = cc.ssn
group by c.ssn","Missing semicolon, CHECK CODE.","select c.ssn, cc.type, sum(
	case
	when c.ssn = cc.ssn then 1
	else 0
	end)
from customers c, credit_cards cc
group by c.ssn, cc.type
order by c.ssn","Missing semicolon, CHECK CODE.","select c.country, count(*)
from customers c, credit_cards cc, merchants m, transactions t
where c.ssn = cc.ssn
and cc.number = t.number
and m.code = t.code
and c.country <> m.country
group by c.country","Missing semicolon, CHECK CODE.","create view all_transactions as 
select cc.type, t.identifier, t.amount
from credit_cards cc, transactions t
where cc.number = t.number
select at.type, at.identifier
from all_transactions as at
inner join (
	select type, max(amount)
	from all_transactions 
	group by type) as b
on at.type = b.type and 
at.amount = b.max","Missing semicolon, CHECK CODE.","select cc.type, t.identifier
from transactions t, credit_cards cc
where t.number = cc.number
and t.amount >= all (
		select t2.amount
		from transactions t2, credit_cards cc2
		where t2.number = cc2.number 
		and cc.type = cc2.type)","Missing semicolon, CHECK CODE.","select m.code
from merchants m
where not exists(
	select * 
	from transactions t
	where m.code = t.code and t.amount >= 888
	and exists(
		select * 
		from credit_cards cc
		where t.number = cc.number
		and (cc.type like 'visa%' or
			 cc.type like 'diners-club%')))","Missing semicolon, CHECK CODE."
A0142279B,"SELECT DISTINCT cc.ssn
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
AND cc.type='visa'
AND t.datetime::date = '2017-12-25';",,"SELECT c.first_name, c.last_name
FROM customers c
WHERE c.country = 'Singapore'
AND c.ssn IN (
	SELECT DISTINCT c.ssn
	FROM customers c, credit_cards cc
	WHERE c.ssn=cc.ssn 
	AND cc.type='visa'
	INTERSECT 
	SELECT DISTINCT c.ssn
	FROM customers c, credit_cards cc
	WHERE c.ssn=cc.ssn 
	AND cc.type='jcb');",,"SELECT c.ssn, COUNT(cc.number) AS number_of_card
FROM customers c LEFT OUTER JOIN credit_cards cc ON c.ssn = cc.ssn
GROUP BY c.ssn;",,"SELECT to_fill.ssn, to_fill.type, COUNT(number) AS number_of_card
FROM (SELECT c.ssn, cc_type.type
	  FROM customers c, (SELECT DISTINCT cc.type FROM credit_cards cc) AS cc_type) AS to_fill
	  LEFT JOIN credit_cards cc1 ON cc1.ssn = to_fill.ssn AND cc1.type = to_fill.type
GROUP BY to_fill.ssn, to_fill.type;",,"SELECT diff_cty.country, COUNT(DISTINCT diff_cty.ssn)
FROM (SELECT c.country, c.ssn
	  FROM customers c, credit_cards cc, transactions t, merchants m
	  WHERE c.ssn = cc.ssn
	  AND cc.number = t.number
	  AND t.code = m.code
	  AND c.country <> m.country) AS diff_cty
GROUP BY diff_cty.country;",,"SELECT DISTINCT t.identifier
FROM transactions t, credit_cards cc,
	(SELECT cc1.type, MAX(t1.amount)
	  FROM credit_cards cc1, transactions t1
	  WHERE cc1.number = t1.number
	  GROUP BY cc1.type) AS max_trans  
WHERE t.amount = max_trans.max
AND cc.number = t.number
AND cc.type = max_trans.type;",,"SELECT DISTINCT t.identifier
FROM credit_cards cc, transactions t 
WHERE cc.number = t.number
AND t.amount >= ALL(SELECT t1.amount 
				   FROM credit_cards cc1, transactions t1
				   WHERE cc1.number = t1.number
				   AND cc.type = cc1.type);",,"SELECT m1.code, m1.name
FROM merchants m1
WHERE m1.code NOT IN (
	SELECT m.code
	FROM merchants m, credit_cards cc, transactions t
	WHERE cc.number = t.number
	AND t.code = m.code
	AND t.amount >= 888
	AND (cc.type LIKE 'visa%' OR cc.type LIKE 'diners-club%'))","Missing semicolon, CHECK CODE."
A0154734A,"select 
  distinct cc.ssn 
from 
  credit_cards cc, 
  transactions t 
where 
  cc.number = t.number 
  and cc.type = 'visa' 
  and extract(
    year 
    from 
      t.datetime
  ) = 2017 
  and extract(
    month 
    from 
      t.datetime
  ) = 12 
  and extract(
    day 
    from 
      t.datetime
  ) = 25 
order by 
  cc.ssn","Missing semicolon, CHECK CODE.","select 
  list.first_name, 
  list.last_name 
from 
  (
    select 
      distinct visa.ssn, 
      visa.first_name, 
      visa.last_name 
    from 
      (
        select 
          c.ssn, 
          c.first_name, 
          c.last_name 
        from 
          customers c, 
          credit_cards cc 
        where 
          c.country = 'Singapore' 
          and cc.type = 'visa' 
          and c.ssn = cc.ssn
      ) as visa, 
      (
        select 
          c.ssn, 
          c.first_name, 
          c.last_name 
        from 
          customers c, 
          credit_cards cc 
        where 
          c.country = 'Singapore' 
          and cc.type = 'jcb' 
          and c.ssn = cc.ssn
      ) as jcb 
    where 
      visa.ssn = jcb.ssn
  ) as list 
order by 
  list.first_name","Missing semicolon, CHECK CODE.","select 
  distinct (c.ssn), 
  Coalesce(
    count(cc.ssn), 
    0
  ) 
from 
  customers c 
  left outer join credit_cards cc on c.ssn = cc.ssn 
group by 
  c.ssn, 
  cc.ssn 
order by 
  c.ssn","Missing semicolon, CHECK CODE.","select 
  z.ssn, 
  z.type, 
  sum(z.count_label) as count 
from 
  (
    select 
      c.ssn, 
      cc.type, 
      cc.ssn as label, 
      (
        case when c.ssn = cc.ssn then 1 else 0 end
      ) as count_label 
    from 
      customers c, 
      credit_cards cc 
    group by 
      c.ssn, 
      cc.type, 
      cc.ssn 
    order by 
      c.ssn, 
      cc.type
  ) as z 
group by 
  z.ssn, 
  z.type 
order by 
  z.ssn, 
  z.type","Missing semicolon, CHECK CODE.","select 
  c.country, 
  count(c.country) 
from 
  customers c, 
  credit_cards cc, 
  merchants m, 
  transactions t 
where 
  c.ssn = cc.ssn 
  and cc.number = t.number 
  and t.code = m.code 
  and c.country != m.country 
group by 
  c.country 
order by 
  c.country","Missing semicolon, CHECK CODE.","select 
  final.identifier 
from 
  (
    select 
      t.identifier, 
      max_amt.max as amt, 
      max_amt.type 
    from 
      (
        select 
          cc.type, 
          max(t.amount) 
        from 
          credit_cards cc, 
          transactions t 
        where 
          cc.number = t.number 
        group by 
          cc.type
      ) as max_amt, 
      transactions t 
    where 
      t.amount = max_amt.max 
    order by 
      max_amt.type
  ) as final","Missing semicolon, CHECK CODE.","select 
  final.identifier 
from 
  (
    select 
      distinct m2.identifier, 
      m2.amount, 
      m2.type 
    from 
      (
        SELECT 
          z.identifier, 
          z.amount, 
          z.type 
        FROM 
          (
            SELECT 
              cc.type, 
              t.identifier, 
              t.amount, 
              ROW_NUMBER() OVER(
                PARTITION BY cc.type 
                ORDER BY 
                  t.amount DESC
              ) rowNumber 
            FROM 
              transactions t, 
              credit_cards cc 
            where 
              t.number = cc.number
          ) as z 
        WHERE 
          z.rowNumber = 1 
        order by 
          z.type
      ) as m1, 
      (
        select 
          t.identifier, 
          t.amount, 
          cc.type 
        from 
          transactions t, 
          credit_cards cc
      ) as m2 
    where 
      m1.amount = m2.amount 
      and m1.type = m2.type 
    order by 
      m2.identifier
  ) as final","Missing semicolon, CHECK CODE.","select 
  m.code, 
  m.name 
from 
  merchants m, 
  credit_cards cc, 
  transactions t 
where 
  m.code = t.code 
  and cc.number = t.number 
except 
select 
  m.code, 
  m.name 
from 
  merchants m, 
  credit_cards cc, 
  transactions t 
where 
  m.code = t.code 
  and cc.number = t.number 
  and t.amount >= 888 
  and (
    cc.type like '%visa%' 
    or cc.type like '%diners-club%'
  )","Missing semicolon, CHECK CODE."
A0218820J,"SELECT DISTINCT c.ssn
FROM customers c,credit_cards cc,transactions t
WHERE c.ssn=cc.ssn
AND t.number=cc.number
AND Date(t.datetime)='2017-12-25'
And cc.type='visa'
ORDER BY c.ssn;",,"SELECT n.first_name, n.last_name
FROM (SELECT DISTINCT c.ssn, c.first_name, c.last_name
FROM customers c,credit_cards cc
WHERE c.ssn=cc.ssn
AND cc.type='jcb'
AND c.country='Singapore'
INTERSECT
SELECT DISTINCT c.ssn, c.first_name, c.last_name
FROM customers c,credit_cards cc
WHERE c.ssn=cc.ssn
AND cc.type='visa'
AND c.country='Singapore') AS n
ORDER BY first_name,last_name;",,"SELECT c.ssn, COUNT(cc.number)
FROM customers c LEFT JOIN credit_cards cc ON c.ssn=cc.ssn
GROUP BY c.ssn
ORDER BY c.ssn;",,"SELECT cr_ty.ssn,cr_ty.type, COUNT(cc.number)
FROM (SELECT DISTINCT credit_cards.type,customers.ssn
FROM credit_cards, customers) AS cr_ty LEFT JOIN credit_cards cc
ON (cr_ty.ssn=cc.ssn AND cr_ty.type= cc.type)
GROUP BY cr_ty.ssn,cr_ty.type
ORDER BY cr_ty.ssn,cr_ty.type;",,"SELECT c.country,COUNT(c.ssn)
FROM customers c, merchants m,transactions t,credit_cards cc
WHERE m.code=t.code
AND t.number=cc.number
AND cc.ssn=c.ssn
AND c.country !=m.country
GROUP BY c.country;",,"SELECT t.identifier
FROM credit_cards c,transactions t
WHERE c.number=t.number
AND (c.type,t.amount) IN (SELECT c.type,MAX(t.amount) FROM credit_cards c,transactions t
WHERE c.number=t.number GROUP BY c.type);",,"SELECT t1.identifier
FROM credit_cards c1,transactions t1
WHERE c1.number=t1.number
AND NOT EXISTS(
SELECT *
FROM transactions t2, credit_cards c2
WHERE t2.number = c2.number
AND c1.type = c2.type
AND t1.amount < t2.amount);",,"SELECT DISTINCT m.code, m.name
FROM merchants m,transactions t,credit_cards cc
WHERE m.code=t.code
AND t.number=cc.number
EXCEPT
SELECT DISTINCT m.code, m.name
FROM merchants m,transactions t,credit_cards cc
WHERE m.code=t.code
AND t.number=cc.number
AND t.amount>=888
AND (cc.type LIKE 'visa%' OR cc.type LIKE 'diners-club%')","Missing semicolon, CHECK CODE."
A0231850M,"SELECT DISTINCT cc.ssn
FROM credit_cards cc, transactions t
WHERE t.datetime >= '2017-12-25'
AND t.datetime < '2017-12-26'
AND t.number = cc.number
AND cc.type = 'visa';",,"SELECT c.first_name, c.last_name
FROM customers c
WHERE c.ssn IN (SELECT DISTINCT(c1.ssn)
				FROM credit_cards c1, credit_cards c2
				WHERE c1.type = 'visa'
				AND c2.type = 'jcb'
				AND c1.ssn = c2.ssn);",,"(SELECT c.ssn, COUNT(*) AS count
 FROM customers c, credit_cards cc
 WHERE c.ssn = cc.ssn
 GROUP BY c.ssn)
UNION
(SELECT c.ssn, 0 AS count
FROM customers c LEFT JOIN credit_cards cc
ON c.ssn = cc.ssn
WHERE cc.ssn ISNULL);",,"SELECT cc.ssn, types.type, COUNT(*) as count
FROM credit_cards cc,
	 (SELECT DISTINCT cc.type
	 FROM credit_cards cc) AS types
WHERE cc.type = types.type
GROUP BY cc.ssn, types.type
ORDER BY ssn, type;",,"SELECT c.country, COUNT(*)
FROM customers c, merchants m
WHERE c.country != m.country
GROUP BY c.country;",,"SELECT t.identifier
FROM transactions t,(
	SELECT cc.type, MAX(t.amount)
	FROM transactions t, credit_cards cc
	WHERE t.number = cc.number
	GROUP BY cc.type) as temp
WHERE t.amount = temp.max;",,"SELECT t1.identifier
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number
AND t1.amount >= ALL(SELECT t2.amount
					 FROM transactions t2, credit_cards cc2
					 WHERE t2.number = cc2.number
					 AND cc1.type = cc2.type)","Missing semicolon, CHECK CODE.","SELECT m.code, m.name
FROM","Missing semicolon, CHECK CODE."
A0231868W,"SELECT c.ssn
FROM customers c, credit_cards cc, transactions t
WHERE c.ssn = cc.ssn
AND t.number = cc.number
AND (SELECT EXTRACT(DAY FROM t.datetime ))= '25'
AND (SELECT EXTRACT(MONTH FROM t.datetime ))= '12'
AND cc.type = 'visa';",,"SELECT first_name, last_name
FROM (SELECT DISTINCT ssn, first_name, last_name
	  FROM customers
	  WHERE country = 'Singapore'
	  AND ssn IN
	  (SELECT ssn
	   FROM credit_cards
       WHERE type ='visa'
	  )
	  AND ssn IN
	  (SELECT ssn
	   FROM credit_cards
       WHERE type ='jcb'
	  )
	 ) d;",,"SELECT c.ssn, count(cc.number) AS number_of_cards
FROM customers c LEFT JOIN credit_cards cc
ON c.ssn = cc.ssn
GROUP BY c.ssn;",,"SELECT r.ssn, g.type, COUNT(d.type) num
FROM (SELECT DISTINCT type FROM credit_cards) g CROSS JOIN
     (SELECT DISTINCT ssn FROM customers) r LEFT JOIN
     (SELECT c.ssn, cc.type FROM customers c LEFT JOIN credit_cards cc
			ON c.ssn = cc.ssn) d
      ON d.ssn = r.ssn AND d.type = g.type
GROUP BY r.ssn, g.type
ORDER BY r.ssn;",,"SELECT c.country, count( distinct c.ssn ) as num
FROM customers c, merchants m, transactions t, credit_cards cc
WHERE c.ssn = cc.ssn
AND cc.number = t.number
AND t.code = m.code
AND c.country <> m.country
GROUP BY c.country","Missing semicolon, CHECK CODE.","SELECT n.identifier, s.type, s.largest
FROM (SELECT cc.type, t.identifier, t.amount
	    FROM transactions t, credit_cards cc
      WHERE t.number = cc.number) n,
     (SELECT cc.type, max(t.amount) largest
      FROM transactions t, credit_cards cc
      WHERE t.number = cc.number
      GROUP BY cc.type) s
WHERE n.amount = s.largest
AND n.type = s.type
ORDER BY type","Missing semicolon, CHECK CODE.","SELECT t.identifier, cc1.type, t.amount
FROM transactions t, credit_cards cc1
WHERE cc1.number = t.number
AND t.amount >=
ALL (SELECT t1.amount
	   FROM transactions t1, credit_cards cc2
	   WHERE cc2.number = t1.number
	   AND cc1.type = cc2.type
	  )
ORDER BY type","Missing semicolon, CHECK CODE.","SELECT code, name
FROM merchants
EXCEPT
SELECT DISTINCT m.code, m.name
FROM merchants m, transactions t, credit_cards cc
WHERE m.code = t.code
AND cc.number = t.number
AND t.amount >=888
AND (cc.type = 'visa'
OR cc.type = 'diners-club')","Missing semicolon, CHECK CODE."
A0231869U,"SELECT DISTINCT c.ssn
FROM customers c, credit_cards cc, transactions t
WHERE c.ssn = cc.ssn
AND cc.number = t.number
AND t.datetime BETWEEN '2017-12-25 00:00:00' AND '2017-12-26 00:00:00'
AND cc.type = 'visa';",,"SELECT c1.first_name, c1.last_name
FROM customers c1
WHERE c1.country = 'Singapore'
AND c1.ssn IN (
	SELECT cc1.ssn
	FROM credit_cards cc1, credit_cards cc2
	WHERE cc1.ssn = cc2.ssn
	AND cc1.type = 'jcb'
	AND cc2.type = 'visa');",,"SELECT c.ssn, count(DISTINCT cc.number) AS number_of_credit_cards
FROM customers c FULL OUTER JOIN credit_cards cc ON c.ssn = cc.ssn
GROUP BY c.ssn
ORDER BY number_of_credit_cards ASC;",,"SELECT c.ssn, cdtype.type, count(DISTINCT cc.number) AS number_of_credit_cards
FROM (SELECT *, 1 AS a FROM customers) AS c
JOIN (SELECT DISTINCT type, 1 AS a FROM credit_cards) AS cdtype 
	ON c.a = cdtype.a
LEFT JOIN credit_cards AS cc ON c.ssn = cc.ssn
	AND cdtype.type = cc.type
GROUP BY c.ssn, cdtype.type
ORDER BY c.ssn;",,"SELECT c.country, count(DISTINCT c.ssn)
FROM customers c LEFT JOIN credit_cards cc ON c.ssn = cc.ssn
LEFT JOIN transactions t ON cc.number = t.number
LEFT JOIN merchants m ON t.code = m.code
WHERE m.country <> c.country
GROUP BY c.country;",,"SELECT DISTINCT cc1.type, t1.identifier
FROM transactions t1, credit_cards cc1
WHERE t1.number = cc1.number
AND cc1.type || t1.amount in
 (SELECT cc.type || MAX(t.amount) FROM transactions t, credit_cards cc
 WHERE t.number = cc.number
 GROUP BY cc.type);",,"SELECT cc.type, t.identifier
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
AND t.amount >= ALL(
	SELECT t2.amount FROM transactions t2, credit_cards cc2 
	WHERE t2.number = cc2.number AND cc2.type=cc.type);",,"SELECT DISTINCT m.code, m.name
FROM merchants m LEFT JOIN transactions t ON m.code = t.code 
LEFT JOIN credit_cards cc ON t.number =cc.number
WHERE cc.type LIKE 'visa%'
OR cc.type LIKE 'diners-club%'
GROUP BY m.code, m.name
HAVING max(t.amount) < 888","Missing semicolon, CHECK CODE."
A0231887U,"select cc.ssn
from credit_cards as cc  
inner join transactions as t on cc.number = t.number
where 1=1
  and cc.type = 'visa' 
  and t.datetime >= '2017-12-25 00:00:00.000000' 
  and t.datetime < '2017-12-26 00:00:00.000000' 
group by 1
;",,"select j.first_name, j.last_name
from (
	 select c.ssn, c.first_name, c.last_name
	 from customers c
	 inner join credit_cards cc on c.ssn = cc.ssn
	 where 1=1 
	   and c.country = 'Singapore'
	   and cc.type = 'jcb'
	 group by 1,2,3
) as j
inner join (
	 select c.ssn, c.first_name, c.last_name
	 from customers c
	 inner join credit_cards cc on c.ssn = cc.ssn
	 where 1=1
	   and c.country = 'Singapore'
	   and cc.type = 'visa'
	 group by 1,2,3
) as v
on (j.ssn = v.ssn and j.first_name = v.first_name and j.last_name = v.last_name)","Missing semicolon, CHECK CODE.","select c.ssn as ssn, count(*) as cnt
from customers c  
left join credit_cards cc on c.ssn = cc.ssn  
where 1=1  
  and cc.ssn is not null
group by 1
union
select c.ssn as ssn, 0 as cnt
from customers c  
left join credit_cards cc on c.ssn = cc.ssn  
where 1=1  
  and cc.ssn is null
group by 1
;",,"select c.ssn, cc.type, count(*) as cnt
from customers as c
left join credit_cards cc on c.ssn = cc.ssn
where 1=1
  and cc.ssn is not null
group by 1,2
union
select c.ssn, cc.type, 0 as cnt
from customers as c
left join credit_cards cc on c.ssn = cc.ssn
where 1=1
  and cc.ssn is null
group by 1,2
;",,"select c.country as cntr_c
	 , count(distinct c.ssn) as cnt
from transactions t
inner join credit_cards cc on cc.number = t.number
inner join merchants m on m.code = t.code
inner join customers c on c.ssn = cc.ssn
where 1=1
  and c.country != m.country
group by 1
order by 1
;",,"select cc.type, count(distinct t.identifier) as cnt
from transactions as t
inner join credit_cards as cc on cc.number = t.number 
group by 1
limit 1","Missing semicolon, CHECK CODE.","select t.identifier 
from (
	select cc.type, t.identifier
	from transactions as t
	inner join credit_cards as cc on cc.number = t.number 
	order by 1
	limit 1
) t","Missing semicolon, CHECK CODE.","select m.code, m.name
from transactions t 
inner join merchants m on m.code = t.code
inner join credit_cards cc on cc.number = t.number
where 1=1
  and (cc.type like '%visa%' or cc.type like '%diners-club%')
group by 1,2
having max(t.amount) < 888
;",
A0231891A,"select 
  distinct cc.ssn 
from 
  credit_cards cc, 
  transactions t 
where 
  cc.number = t.number 
  and t.datetime BETWEEN TIMESTAMP '2017-12-25 00:00:00' 
  AND TIMESTAMP '2017-12-25 23:59:59' 
  and cc.type = 'visa';",,"select a.first_name, a.last_name
from
	(select cc.ssn, c.first_name, c.last_name
	from customers c, credit_cards cc
	where c.ssn = cc.ssn
	and c.country = 'Singapore'
	and cc.type = 'jcb'
	group by cc.ssn, c.first_name, c.last_name
	intersect 
	select cc.ssn, c.first_name, c.last_name
	from customers c, credit_cards cc
	where c.ssn = cc.ssn
	and c.country = 'Singapore'
	and cc.type = 'visa'
	group by cc.ssn, c.first_name, c.last_name) a;",,"select c.ssn, count(cc.number)
from customers c 
left outer join credit_cards cc 
on cc.ssn = c.ssn
group by c.ssn
order by c.ssn Asc, count Asc;",,"select c.ssn, c.type, count(cc.number)
from( 
	(select ssn
	from customers) a
	cross join
	(select distinct type 
	from credit_cards) b
	) c
left join credit_cards cc 
on (cc.type, cc.ssn) =  (c.type, c.ssn)
group by c.ssn, c.type
order by c.ssn Asc, c.type Asc;",,"select c.country, count(distinct c.ssn)
from customers c, merchants m, credit_cards cc, transactions t
where c.ssn = cc.ssn 
and cc.number = t.number
and t.code = m.code
and c.country <>m.country
group by c.country","Missing semicolon, CHECK CODE.","SELECT cc1.type, t1.identifier
from transactions t1, credit_cards cc1
where cc1.number = t1.number
and (cc1.type, t1.amount) in
	(SELECT cc2.type, max(t2.amount)
	from transactions t2, credit_cards cc2
	where  cc2.number = t2.number
	group by cc2.type)
order by cc1.type ASC, t1.identifier ASC;",,"SELECT distinct cc1.type, t1.identifier
from credit_cards cc1, transactions t1
where cc1.number = t1.number
and t1.amount >= all(
	select t2.amount
	from credit_cards cc2, transactions t2
	where cc2.number = t2.number
	and cc1.type = cc2.type)
order by cc1.type ASC, t1.identifier ASC;",,"select m.code, m.name
from merchants m 
except
select m.code, m.name
from transactions t, credit_cards cc, merchants m
where t.number = cc.number
and m.code = t.code 
and (cc.type like '%visa%' or cc.type like '%diners-club%')
and t.amount >= 888","Missing semicolon, CHECK CODE."
A0231907H,"SELECT DISTINCT c.ssn
FROM customers c, credit_cards cd, transactions t
WHERE EXTRACT(YEAR FROM t.datetime) = '2017'
AND EXTRACT(MONTH FROM t.datetime) = '12'
AND EXTRACT(DAY FROM t.datetime) = '25'
AND cd.number = t.number
AND c.ssn = cd.ssn
AND cd.type = 'visa'","Missing semicolon, CHECK CODE.","SELECT c.first_name, c.last_name
FROM (SELECT c1.ssn, c1.first_name, c1.last_name
      FROM  customers c1 
	  LEFT JOIN credit_cards cd1 ON c1.ssn = cd1.ssn
      WHERE c1.country = 'Singapore'
      AND cd1.type = 'jcb'
      INTERSECT
      SELECT c2.ssn, c2.first_name, c2.last_name
      FROM customers c2 
	  LEFT JOIN credit_cards cd2 ON c2.ssn = cd2.ssn
      WHERE c2.country = 'Singapore'
      AND cd2.type = 'visa') AS c
ORDER BY c.first_name","Missing semicolon, CHECK CODE.","SELECT c.ssn, count(*)
FROM customers c
LEFT JOIN  credit_cards cd ON c.ssn = cd.ssn
GROUP BY c.ssn
ORDER BY c.ssn","Missing semicolon, CHECK CODE.","SELECT c.ssn,cd.type,count(cd2.number) as num_of_cards
FROM (SELECT DISTINCT c1.ssn FROM customers c1) AS c
      CROSS JOIN 
      (SELECT DISTINCT cd1.type FROM credit_cards cd1) AS cd
      LEFT JOIN credit_cards cd2 
	  ON cd2.ssn = c.ssn AND cd2.type = cd.type
GROUP BY c.ssn, cd.type","Missing semicolon, CHECK CODE.","SELECT c.country, count(DISTINCT c.ssn) AS num
FROM customers c
LEFT JOIN credit_cards cd ON c.ssn = cd.ssn
LEFT JOIN transactions t ON cd.number = t.number
LEFT JOIN merchants m ON t.code = m.code
WHERE c.country <> m.country
GROUP BY c.country","Missing semicolon, CHECK CODE.","SELECT t1.identifier, cd1.type
FROM transactions t1, credit_cards cd1
WHERE t1.number = cd1.number
AND t1.amount = ALL (
  SELECT MAX(t2.amount)
  FROM transactions t2, credit_cards cd2
  WHERE t2.number = cd2.number
  AND cd1.type = cd2.type)","Missing semicolon, CHECK CODE.","SELECT t1.identifier, cd1.type
FROM transactions t1, credit_cards cd1
WHERE t1.number = cd1.number
AND t1.amount >= ALL (
  SELECT t2.amount
  FROM transactions t2, credit_cards cd2
  WHERE t2.number = cd2.number
  AND cd1.type = cd2.type)","Missing semicolon, CHECK CODE.","SELECT m.code, m.name
FROM merchants m 
WHERE m.code NOT IN
  (SELECT m1.code
   FROM merchants m1, transactions t1, credit_cards cd1
   WHERE t1.code = m1.code
   AND t1.number = cd1.number
   AND t1.amount >= 888
   AND cd1.type like '%visa%')
INTERSECT
SELECT m.code, m.name
FROM merchants m 
WHERE m.code NOT IN
   (SELECT m2.code
   FROM merchants m2, transactions t2, credit_cards cd2
   WHERE t2.code = m2.code
   AND t2.number = cd2.number
   AND t2.amount >= 888
   AND cd2.type like '%diners-club%')
*
SELECT DISTINCT cd.type FROM credit_cards cd
WHERE cd.type like '&diners-club%'
OR cd.type like '%visa%'
OUTPUT: visa visa-electron
*/","Missing semicolon, CHECK CODE."
A0231912N,"SELECT DISTINCT cc.ssn
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
AND t.datetime >= '2017-12-25 00:00:00.000000' AND t.datetime <'2017-12-26 00:00:00.000000'
AND cc.type LIKE '%visa%';",,"SELECT subtable.first_name, subtable.last_name
FROM
(SELECT DISTINCT cc.ssn, c.last_name, c.first_name
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn
AND cc.type LIKE '%visa%' 
INTERSECT
SELECT DISTINCT c.ssn,c.last_name, c.first_name
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn
AND cc.type LIKE '%jcb%') as subtable
ORDER BY subtable.first_name;",,"SELECT c.ssn,coalesce(m.count,0) AS number
FROM
(SELECT cc.ssn,COUNT(*) 
FROM credit_cards cc
GROUP BY cc.ssn  )AS m 
RIGHT JOIN customers c
ON m.ssn =c.ssn
ORDER BY COUNT desc
*SELECT c.ssn 
FROM customers c
WHERE c.ssn NOT IN(
	SELECT cc.ssn
	FROM credit_cards cc)	
*/","Missing semicolon, CHECK CODE.","SELECT DISTINCT atp.ssn,atp.type,coalesce(tp.count,0)
FROM
(SELECT DISTINCT cc.ssn,cc.type, COUNT(cc.type)
FROM credit_cards cc
GROUP BY cc.ssn, cc.type) as tp
RIGHT JOIN
(SELECT DISTINCT c.ssn,cc.type
FROM customers c,credit_cards cc
ORDER BY c.ssn) AS atp
ON tp.ssn = atp.ssn AND tp.type = atp.type
ORDER BY atp.ssn,atp.type;",,"SELECT tb.c1, count(*)
FROM 
(select c.ssn,c.country as c1,m.country as c2 ,t.identifier
FROM customers c, credit_cards cc, transactions t, merchants m
WHERE c.ssn=cc.ssn
AND cc.number =t.number
AND t.code=m.code) as tb
WHERE tb.c1!=tb.c2
GROUP BY tb.c1;",,"SELECT t2.identifier
FROM transactions t2, credit_cards cc2,
(SELECT cc.type, MAX(t.amount)
FROM transactions t, credit_cards cc
WHERE t.number = cc.number
GROUP BY cc.type) AS maxtable
WHERE maxtable.max = t2.amount
AND maxtable.type = cc2.type
AND t2.number = cc2.number","Missing semicolon, CHECK CODE.","SELECT t2.identifier
FROM transactions t2, credit_cards cc2,
(SELECT DISTINCT ON(gt.TYPE) *
FROM
(SELECT cc.type, t.amount
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
ORDER BY cc.type,t.amount desc)AS gt ) AS gt2
WHERE gt2.amount = t2.amount
AND gt2.type = cc2.type
AND t2.number = cc2.number","Missing semicolon, CHECK CODE.","SELECT m.code,m.name
FROM 
(SELECT *
FROM credit_cards
WHERE type LIKE '%visa' OR type LIKE '%diners-club%') AS cc, 
merchants m,
(SELECT *
FROM transactions  
WHERE amount<=888) AS t 
WHERE 
cc.number = t.number
AND m.code =t.code","Missing semicolon, CHECK CODE."
A0231917E,"SELECT DISTINCT c.ssn
FROM credit_cards c, transactions t
WHERE c.number = t.number
AND c.type = 'visa'
AND t.datetime BETWEEN '2017-12-25 00:00:00' AND '2017-12-25 23:59:59'","Missing semicolon, CHECK CODE.","SELECT DISTINCT a.first_name, a.last_name, a.ssn
FROM customers a, credit_cards c
WHERE a.ssn = c.ssn
AND a.country = 'Singapore'
AND c.type = 'jcb'
INTERSECT
SELECT DISTINCT a.first_name, a.last_name, a.ssn
FROM customers a, credit_cards c
WHERE a.ssn = c.ssn
AND a.country = 'Singapore'
AND c.type = 'visa'","Missing semicolon, CHECK CODE.","SELECT DISTINCT a.ssn, 
(CASE WHEN c.ssn IS NULL THEN '0' ELSE COUNT(*) END) AS cardnumber
FROM customers a LEFT OUTER JOIN credit_cards c ON a.ssn = c.ssn
GROUP BY a.ssn,c.ssn
ORDER BY a.ssn","Missing semicolon, CHECK CODE.","SELECT ak.ssn, ak.type,
(CASE WHEN c3.type IS NULL THEN '0' ELSE COUNT(*) END) AS cardnumber
FROM	(SELECT c2.type, c2.ssn
		FROM (SELECT DISTINCT c.type
	 		FROM credit_cards c) AS c1 
	 		LEFT OUTER JOIN 
	 		(SELECT DISTINCT a.ssn, c.type
	 		FROM customers a, credit_cards c) AS c2
		 	ON c1.type = c2.type) AS ak 
		LEFT OUTER JOIN credit_cards c3
		ON ak.ssn = c3.ssn AND ak.type = c3.type
GROUP BY ak.ssn, ak.type,c3.type","Missing semicolon, CHECK CODE.","SELECT DISTINCT am.country, COUNT(*)
FROM (
	SELECT DISTINCT a.ssn, a.country
	FROM customers a, credit_cards c, merchants m, transactions t
	WHERE a.ssn = c.ssn AND c.number = t.number AND t.code = m.code
	AND m.country <> a.country
	GROUP BY a.ssn, a.country, m.country) AS am
GROUP BY am.country","Missing semicolon, CHECK CODE.","SELECT DISTINCT t2.identifier 
FROM (
	SELECT DISTINCT c1.type, MAX(t1.amount)
	FROM credit_cards c1 JOIN transactions t1 ON c1.number = t1.number
	GROUP BY c1.type) AS c1t1, transactions t2, credit_cards c2
WHERE c1t1.max = t2.amount
AND c1t1.type = c2.type
AND t2.number = c2.number","Missing semicolon, CHECK CODE.","SELECT t2.identifier
FROM (
	(SELECT t.identifier,
	MAX(t.amount) OVER (partition by c.type) AS maxi
	FROM transactions t JOIN credit_cards c ON t.number = c.number) AS t1
	JOIN transactions t2 ON t1.maxi = t2.amount AND t1.identifier = t2.identifier)","Missing semicolon, CHECK CODE.","SELECT DISTINCT m.code, m.name
FROM merchants m
EXCEPT
SELECT DISTINCT vd.code, vd.name
FROM (
	SELECT t.amount, c.type, m.name, m.code
	FROM merchants m, transactions t, credit_cards c
	WHERE m.code = t.code
	AND t.number = c.number
	AND t.amount >= 888
	AND c.type LIKE 'visa%'
	UNION
	SELECT t.amount, c.type, m.name, m.code
	FROM merchants m, transactions t, credit_cards c
	WHERE m.code = t.code
	AND t.number = c.number
	AND t.amount >= 888
	AND c.type LIKE '%diners-club%') AS vd","Missing semicolon, CHECK CODE."
A0231929Y,"SELECT c.ssn
FROM customers c, transactions t, credit_cards cc
WHERE c.ssn = cc.ssn
AND t.number = cc.number
AND t.datetime >= '2017-12-25'
AND t.datetime < '2017-12-26'
AND cc.type = 'visa';",,"SELECT DISTINCT c.first_name, c.last_name 
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn
AND cc.type = 'visa'
AND c.country = 'Singapore'
UNION
SELECT DISTINCT c.first_name, c.last_name 
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn
AND cc.type = 'jcb'
AND c.country = 'Singapore';",,"SELECT cc.ssn, COUNT(cc.number) AS count
FROM credit_cards cc, customers c
WHERE c.ssn = cc.ssn
GROUP BY cc.ssn
UNION
SELECT cc.ssn, 0 AS count
FROM credit_cards cc LEFT OUTER JOIN customers c
ON c.ssn = cc.ssn
WHERE cc.number ISNULL;",,"SELECT cc.ssn, cc.type, COUNT(cc.type) AS count
FROM credit_cards cc, customers c
WHERE c.ssn = cc.ssn
GROUP BY cc.ssn,cc.type
UNION
SELECT cc.ssn, cc.type, 0 AS count
FROM credit_cards cc LEFT OUTER JOIN customers c
ON c.ssn = cc.ssn
WHERE cc.number ISNULL;",,"SELECT c.country, COALESCE(COUNT(c.ssn),0) AS count
FROM customers c, merchants m, credit_cards cc, transactions t
WHERE c.country <> m.country
AND t.number = cc.number
AND t.code = m.code
AND cc.ssn = c.ssn
GROUP BY c.country;",,"SELECT t1.identifier, t1.amount
FROM credit_cards cc, transactions t1
WHERE cc.number = t1.number
AND t1.amount = (SELECT MAX(amount) 
                FROM credit_cards cc2, transactions t2
                WHERE cc2.number = t2.number
                AND cc2.type = cc.type
                );",,"SELECT t1.identifier, t1.amount
FROM credit_cards cc, transactions t1
WHERE cc.number = t1.number
AND t1.amount = (SELECT t2.amount
                FROM credit_cards cc2, transactions t2
                WHERE cc2.number = t2.number
                AND cc2.type = cc.type
				ORDER BY t2.amount DESC
				LIMIT 1);",,"SELECT DISTINCT m.code, m.name
FROM merchants m
WHERE (m.code, m.name) NOT IN (
	SELECT DISTINCT m.code, m.name
	FROM merchants m, transactions t, (
  		SELECT *
  		FROM credit_cards
  		WHERE type LIKE 'visa%'
  		OR type LIKE 'diners-club%') cc
	WHERE t.number = cc.number
	AND m.code = t.code
	AND t.amount >= 888)","Missing semicolon, CHECK CODE."
A0231936A,"SELECT DISTINCT c.ssn
FROM customers c, credit_cards cc, transactions t
WHERE c.ssn = cc.ssn
AND cc.number = t.number
AND cc.type = 'visa'
AND date(t.datetime) = '2017-12-25';",,"SELECT jv.first_name, jv.last_name
FROM (SELECT c.first_name, c.last_name, c.ssn
	  FROM customers c, credit_cards cc
	  WHERE c.ssn = cc.ssn
	  AND cc.type = 'jcb'
	  AND c.country = 'Singapore'
	  INTERSECT
	  SELECT c.first_name, c.last_name, c.ssn
	  FROM customers c, credit_cards cc
	  WHERE c.ssn = cc.ssn
	  AND cc.type = 'visa'
	  AND c.country = 'Singapore') AS jv
ORDER BY jv.first_name;",,"SELECT c.ssn, COUNT(cc.number) AS number_of_cards
FROM customers c LEFT JOIN credit_cards cc
ON c.ssn = cc.ssn
GROUP BY c.ssn;",,"CREATE VIEW card_type AS
SELECT DISTINCT c.ssn, cc.type
FROM customers c, credit_cards cc;
SELECT ct.ssn, ct.type, COUNT(cc.type) AS number_of_cards
FROM card_type ct
LEFT JOIN credit_cards cc
ON ct.ssn = cc.ssn
AND ct.type = cc.type
GROUP BY ct.ssn, ct.type
ORDER BY ct.ssn;",,"SELECT c.country, COUNT(DISTINCT c.ssn)
FROM customers c, credit_cards cc, transactions t, merchants m
WHERE c.ssn = cc.ssn
AND cc.number = t.number
AND t.code = m.code
AND c.country != m.country
GROUP BY c.country;",,"SELECT t.identifier
FROM credit_cards cc,
	 transactions t,
	 (SELECT cc2.type AS type, MAX(t2.amount) AS max
	  FROM transactions t, transactions t2, credit_cards cc2
	  WHERE t2.number = cc2.number
	  AND t.identifier = t2.identifier
	  GROUP BY cc2.type) AS m
WHERE cc.number = t.number
AND t.amount = m.max
AND cc.type = m.type;",,"SELECT t.identifier
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
AND t.amount >= ALL(SELECT t2.amount
					FROM transactions t2, credit_cards cc2
					WHERE t2.number = cc2.number
				    AND cc.type = cc2.type);",,"SELECT DISTINCT m.code, m.name
FROM merchants m
WHERE m.code NOT IN (SELECT m.code
					FROM merchants m, transactions t, credit_cards cc
					WHERE m.code = t.code
					AND t.number = cc.number
					AND t.amount >= 888
					AND (cc.type LIKE '%visa%' OR cc.type LIKE '%diners-club%'))","Missing semicolon, CHECK CODE."
A0231957X,"SELECT cc.ssn,EXTRACT(day FROM T.datetime) AS DAY, EXTRACT(month FROM T.datetime) AS MONTH
FROM credit_cards cc, transactions t
WHERE cc.type='visa' 
AND cc.number=t.number
AND EXTRACT(day FROM T.datetime)=25
AND EXTRACT(month FROM T.datetime)=12
AND EXTRACT(year FROM T.datetime)=2017;",,"SELECT cu.first_name, cu.last_name,  cu.ssn
FROM customers cu, credit_cards cc
WHERE cu.ssn=cc.ssn
AND cc.type='JCB' OR cc.type='visa'
GROUP BY cu.ssn, cu.first_name, cu.last_name;",,"SELECT cu.ssn, count(cc.number)
FROM customers cu full outer join credit_cards cc on cu.ssn=cc.ssn
group by cu.ssn;",,,"Missing semicolon, CHECK CODE.","select cu.country, count(cu.ssn)
from customers cu
where cu.ssn in(
select cu.ssn
from customers cu, credit_cards cc,transactions t,merchants m
where cu.ssn=cc.ssn
and cc.number=t.number
and t.code=m.code
and m.country<>cu.country)
group by cu.country;",,"select frm.maz,frm.tp
from (select max(t.amount) as maz,cc.type as tp
	  from credit_cards cc, transactions t
	  where cc.number=t.number
	  group by cc.type) as frm;",,"select cc.type,t.identifier
from credit_cards cc, transactions t
where t.amount>=ALL(select t.amount
					from credit_cards cc, transactions t
					where cc.number=t.number 
					GROUP BY cc.type,t.amount) 
					and cc.number=t.number
					group by cc.type,t.identifier;",,"select m.code,m.name
from merchants m
where m.code not in
(select m.code
from merchants m, transactions t,credit_cards cc
where t.code=m.code
and cc.number=t.number
and t.amount>=888
and cc.type='visa' or cc.type='diners-club');",
A0231979N,"SELECT c.ssn
FROM customers c, credit_cards cc, transactions t
WHERE c.ssn = cc.ssn AND cc.number = t.number
AND cc.type= 'visa' AND t.datetime::date ='2017-12-25'","Missing semicolon, CHECK CODE.","SELECT  c.first_name, c.last_name
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn  AND c.country= 'Singapore' AND cc.type = 'jcb'
INTERSECT 
SELECT  c.first_name, c.last_name
FROM customers c, credit_cards cc
WHERE c.ssn = cc.ssn  AND c.country= 'Singapore' AND cc.type = 'visa'","Missing semicolon, CHECK CODE.","SELECT  c.ssn,COUNT(cc.number) as result
FROM customers c LEFT JOIN credit_cards cc ON c.ssn= cc.ssn
GROUP BY c.ssn
ORDER BY result","Missing semicolon, CHECK CODE.","SELECT sub.ssn, sub.type,COUNT(cc.number)
FROM  (SELECT DISTINCT c.ssn,cc.type FROM customers c,credit_cards cc) as sub
LEFT JOIN credit_cards cc ON sub.ssn = cc.ssn AND sub.type = cc.type
GROUP BY sub.ssn, sub.type
ORDER BY sub.ssn","Missing semicolon, CHECK CODE.","SELECT c.country, COUNT(*)
FROM customers c, credit_cards cc, transactions t, merchants m
WHERE c.ssn = cc.ssn AND t.number = cc.number AND t.code = m.code AND c.country != m.country
GROUP BY c.country","Missing semicolon, CHECK CODE.","SELECT cc.type,t.identifier
FROM credit_cards cc, transactions t 
WHERE cc.number = t.number
AND (cc.type,t.amount) IN (SELECT cc.type,MAX(t.amount) FROM  credit_cards cc, transactions t WHERE cc.number = t.number GROUP BY cc.type)
ORDER BY cc.type","Missing semicolon, CHECK CODE.","SELECT cc.type,t.identifier
FROM credit_cards cc, transactions t
WHERE cc.number = t.number
AND NOT EXISTS ( SELECT t2.identifier FROM credit_cards cc2, transactions t2 WHERE cc2.number=t2.number AND cc2.type = cc.type AND t2.amount>t.amount)
ORDER BY cc.type","Missing semicolon, CHECK CODE.","* Write your answer in SQL below: 
		*/
SELECT DISTINCT m.code, m.name
FROM credit_cards cc, transactions t, merchants m
WHERE t.number = cc.number AND t.code = m.code 
AND NOT EXISTS (SELECT *
			FROM credit_cards cc, transactions t, merchants m2
			WHERE t.number = cc.number AND t.code = m2.code AND m2.code = m.code
			AND t.amount >= 888 and (cc.type = 'visa' or cc.type='diners-club'))
ORDER BY m.code, m.name","Missing semicolon, CHECK CODE."
A0231993X,"SELECT c.ssn
FROM credit_cards c, transactions t
WHERE c.type = 'visa' AND t.number = c.number AND DATE(datetime) = '2017-12-25';
* can check that it is correct by using 
 SELECT c.ssn, t.number, c.number, c.type, DATE(t.datetime) */",,"SELECT cust.first_name, cust.last_name
FROM customers cust, credit_cards c
WHERE cust.country = 'Singapore' AND c.ssn = cust.ssn  AND (c.type = 'visa' or c.type ='jcb')","Missing semicolon, CHECK CODE.","SELECT cust.ssn, COUNT(c.ssn)
FROM customers cust, credit_cards c
WHERE cust.ssn = c.ssn
GROUP BY cust.ssn
UNION
SELECT cust.ssn, COUNT(cust.ssn)-1 
FROM customers cust
WHERE cust.ssn NOT IN (SELECT c.ssn FROM credit_cards c)
GROUP BY cust.ssn
ORDER BY COUNT;",,"select cust.ssn, c.type, count(*) as count
from customers as cust, credit_cards as c
where cust.ssn = c.ssn 
union
select distinct (tempA.ssn), tempA.type, 0 as count
from (select cust.ssn, subquery.type, count(*) 
	from customers cust, credit_cards c, (select distinct c.type from credit_cards as c) as subquery
	where cust.ssn = c.ssn and c.type <> subquery.type
	group by cust.ssn, subquery.type
	order by cust.ssn
		(select cust.ssn, c.type
			from customers as cust, credit_cards as c
			where cust.ssn = c.ssn 
			group by cust.ssn, c.type
			order by cust.ssn) as temporaryB
	on tempA.ssn = temporaryB.ssn and (tempA.type = temporaryB.type  )
order by ssn;",,"select aact.cust_country, sum(aact.count) as number_of_overseas_purchase
from (SELECT m.country as m_country, cust.country as cust_country, COUNT(*)
from transactions t, merchants m, customers cust, credit_cards c
where t.code = m.code AND t.number = c.number AND c.ssn = cust.ssn AND m.country = cust.country
left join (SELECT m.country as m_country, cust.country as cust_country, COUNT(*)
from transactions t, merchants m, customers cust, credit_cards c
where t.code = m.code AND t.number = c.number AND c.ssn = cust.ssn 
on sct.m_country = aact.m_country and sct.cust_country <> aact.cust_country
group by aact.cust_country; 
*
SELECT m.country, COUNT(*)
from transactions t, merchants m
where t.code = m.code 
GROUP BY m.country; 
*/
*
SELECT m.country, cust.country, COUNT(*)
from transactions t, merchants m, customers cust, credit_cards c
where t.code = m.code AND t.number = c.number AND c.ssn = cust.ssn AND m.country = cust.country
GROUP BY m.country, cust.country; */
* this solution is my working but because i use INTO, i just rewrite again without 
SELECT m.country, cust.country, COUNT(*)
from transactions t, merchants m, customers cust, credit_cards c
where t.code = m.code AND t.number = c.number AND c.ssn = cust.ssn 
GROUP BY m.country, cust.country
SELECT m.country as m_country, cust.country as cust_country, COUNT(*)
into sct
from transactions t, merchants m, customers cust, credit_cards c
where t.code = m.code AND t.number = c.number AND c.ssn = cust.ssn AND m.country = cust.country
GROUP BY m.country, cust.country;
SELECT m.country as m_country, cust.country as cust_country, COUNT(*)
into aact
from transactions t, merchants m, customers cust, credit_cards c
where t.code = m.code AND t.number = c.number AND c.ssn = cust.ssn 
GROUP BY m.country, cust.country;
select * from sct;
select * from aact;
select aact.cust_country, sum(aact.count)
from sct 
left join aact
on sct.m_country = aact.m_country and sct.cust_country <> aact.cust_country
group by aact.cust_country
*/",,"from transactions as t, credit_cards as c
FROM transactions t, credit_cards c
WHERE t.number = c.number 
GROUP BY c.type ) 
order by t.identifier;
*SELECT *
FROM transactions t, credit_cards c
WHERE t.number = c.number and c.type = 'visa-electron'  and t.amount = '1000.34'",,"select t.identifier, t.amount
from transactions as t, credit_cards as c
where c.number = t.number and t.amount >= ALL(
	SELECT t1.amount 
	from transactions as t1, credit_cards as c1
	where t1.number = c1.number and c.type =c1.type)
order by t.identifier;",,"select m.code, m.name
from merchants as m
from merchants as m
select distinct right_table.name
from
from transactions as t, merchants as m, credit_cards as c
where t.amount >= 888 and t.number = c.number and t.code = m.code and ( c.type like 'visa%' or c.type like 'diners-club%')
group by t.amount, t.number, c.number, t.code, m.code, c.type
) as innerjoin
on m.name = innerjoin.name
order by innerjoin.name;",
A0231996R,"select distinct c.ssn 
from customers c, transactions t, credit_cards cc
where c.ssn = cc.ssn
and t.number = cc.number
and cc.type = 'visa'
and t.datetime between '2017-12-25' and '2017-12-26'
order by c.ssn asc;",,"select c.first_name, c.last_name
from customers c, credit_cards cc, credit_cards ccc
where cc.type = 'visa' 
and ccc.type ='jcb'
and c.country = 'Singapore'
and c.ssn=cc.ssn
and c.ssn=ccc.ssn
group by c.ssn, c.first_name, c.last_name","Missing semicolon, CHECK CODE.","select c.ssn, count(cc.ssn)
from customers c left outer join credit_cards cc on c.ssn=cc.ssn
group by c.ssn
order by c.ssn asc","Missing semicolon, CHECK CODE.","select res2.ssn, res2.type, CASE WHEN count IS NULL THEN 0 ELSE count END
from 
(select ssn, type
from customers
cross join (select distinct type from credit_cards) res) res2
left join
(select c.ssn, cc.type, count(cc.number)
from customers c left outer join credit_cards cc on c.ssn=cc.ssn
group by c.ssn, cc.type) res3
on res2.ssn = res3.ssn and res2.type = res3.type","Missing semicolon, CHECK CODE.","select c.country, count (distinct c.ssn)
from transactions t, merchants m, credit_cards cc, customers c
where t.code = m.code
and t.number = cc.number
and cc.ssn = c.ssn
and m.country <> c.country
group by c.country","Missing semicolon, CHECK CODE.","select t.identifier, t.amount
from transactions t, credit_cards cc
where t.number=cc.number
and cc.type || t.amount in (select ccc.type || max(tt.amount) 
    from transactions tt, credit_cards ccc
    where tt.number = ccc.number 
    group by ccc.type)","Missing semicolon, CHECK CODE.","select t.identifier, t.amount
from transactions t, credit_cards cc
where t.number=cc.number
and t.amount >= all(
select tt.amount
from transactions tt, credit_cards ccc
where tt.number=ccc.number
and cc.type = ccc.type)","Missing semicolon, CHECK CODE.","select m.code, m.name
from merchants m, transactions t, credit_cards cc
where m.code =t.code 
and t.number = cc.number
and cc.type like '%visa%'
group by m.code, m.name
having max(t.amount)<888
intersect
select m.code, m.name
from merchants m, transactions t, credit_cards cc
where m.code =t.code 
and t.number = cc.number
and cc.type like '%diners-club%'
group by m.code, m.name
having max(t.amount)<888","Missing semicolon, CHECK CODE."
A0232004A,"select cu.ssn
from credit_cards cr, transactions tr, customers cu
where cu.ssn = cr.ssn
and cr.number = tr.number
and date(tr.datetime) = '2017-12-25'
and cr.type = 'visa'
group by cu.ssn","Missing semicolon, CHECK CODE.","select cu2.first_name, cu2.last_name
from	(select cr1.ssn, cu1.first_name, cu1.last_name
		from customers cu1, credit_cards cr1
		where cu1.ssn = cr1.ssn
		and cu1.country = 'Singapore'
		and cr1.type = 'visa'
		group by cr1.ssn, cu1.first_name, cu1.last_name, cr1.type) as vi, customers cu2, credit_cards cr2
where cu2.ssn = cr2.ssn
and cr2.ssn = vi.ssn
and cr2.type = 'jcb'
group by cr2.ssn, cu2.first_name, cu2.last_name","Missing semicolon, CHECK CODE.","select cu.ssn, count(cr.ssn)
from customers cu
	left join credit_cards cr on cu.ssn = cr.ssn
group by cu.ssn","Missing semicolon, CHECK CODE.","select cu.ssn, cr.type, count(cr.type)
from customers cu
	left join credit_cards cr on cu.ssn = cr.ssn
group by cu.ssn, cr.type","Missing semicolon, CHECK CODE.","select co.country, count(*)
from 	(select cu.ssn, cu.country
		from customers cu, credit_cards cr, merchants me, transactions tr
		where cr.number = tr.number
		and cu.ssn = cr.ssn
		and me.code = tr.code
		and cu.country <> me.country
		group by cu.ssn) as co
group by co.country","Missing semicolon, CHECK CODE.","select tr1.identifier, cr1.type
from transactions tr1, credit_cards cr1, 	(select cr2.type, max(tr2.amount)
											from transactions tr2, credit_cards cr2
											where tr2.number = cr2.number
											group by cr2.type) as trcr
where tr1.number = cr1.number
and trcr.type = cr1.type
and tr1.amount = trcr.max","Missing semicolon, CHECK CODE.","select tr1.identifier, cr1.type
from transactions tr1, credit_cards cr1
where tr1.number = cr1.number
and tr1.amount >= all	(select tr2.amount
					  	from transactions tr2, credit_cards cr2
					 	where tr2.number = cr2.number
						and cr1.type = cr2.type)","Missing semicolon, CHECK CODE.","select me2.code,me2.name
from merchants me2
where not exists	(select me.name
					from merchants me, credit_cards cr, transactions tr
					where cr.number = tr.number
					and me.code = tr.code 
					and (cr.type like '%visa%' or cr.type like '%diners-club%')
					and tr.amount >= 888
					and me.name = me2.name)","Missing semicolon, CHECK CODE."
A0232015Y,"select cm.ssn 
from customers cm, credit_cards cc, transactions t
where TO_CHAR(t.datetime,'yyyy-mm-dd')='2017-12-25'
and cc.type='visa'
and t.number=cc.number
and cc.ssn=cm.ssn","Missing semicolon, CHECK CODE.","select cms.first_name, cms.last_name
from (select distinct(cm.ssn) ,cm.first_name, cm.last_name
	  from customers cm, credit_cards cc1, credit_cards cc2
where cc1.type='jcb'
and cc2.type='visa'
and cm.country='Singapore'
and cc1.ssn=cc2.ssn
and cm.ssn=cc2.ssn) as cms","Missing semicolon, CHECK CODE.","select cm.ssn, (case when count(cc.*) isnull 
				then 0 else count(cc.*) 
				end) as number_of_cards
from customers cm
left outer join credit_cards cc on cm.ssn=cc.ssn
group by cm.ssn
order by number_of_cards asc","Missing semicolon, CHECK CODE.","select cm.ssn, t4.type, count(cc.number) as number_of_cards
from customers cm
cross join (select distinct type 
			from credit_cards) as t4
left outer join credit_cards cc 
	on cm.ssn=cc.ssn and cc.type=t4.type
group by cm.ssn,t4.type
order by cm.ssn asc, t4.type asc, number_of_cards asc","Missing semicolon, CHECK CODE.","select cm.country, count(*)
from customers cm
where cm.ssn in (
	select distinct(cm.ssn)
	from customers cm, merchants m, credit_cards cc, transactions t
	where m.code=t.code
	and t.number=cc.number
	and cc.ssn=cm.ssn
	and cm.country <> m.country)
group by cm.country","Missing semicolon, CHECK CODE.","select tt.identifier
from (select cc.type, max(t.amount)as max_amount
	from credit_cards cc, transactions t
	where t.number=cc.number
	group by cc.type) as mx
left join (select * 
		   from credit_cards cc, transactions t
	       where t.number=cc.number ) as tt
	on mx.type=tt.type and mx.max_amount=tt.amount","Missing semicolon, CHECK CODE.","select x1.identifier
from (select *
	 from transactions t1, credit_cards cc1
	 where t1.number=cc1.number) 
	 as x1
where x1.amount>= all (
	select t2.amount
	from credit_cards cc2, transactions t2
	where t2.number=cc2.number
	and x1.type=cc2.type)","Missing semicolon, CHECK CODE.","select code, name 
from merchants
where code not in (
	select m.code 
	from merchants m,credit_cards cc, transactions t
	where m.code=t.code
	and cc.number=t.number
	and t.amount>=888
	and (cc.type='visa' or cc.type='diners-club')
)","Missing semicolon, CHECK CODE."
A0232060Y,"SELECT distinct cr.ssn FROM credit_cards cr, transactions t 
WHERE (cr.type = 'visa' 
	   and t.datetime BETWEEN '2017-12-24 23:59:59.999999 '
	   AND'2017-12-25 23:59:59.999999')","Missing semicolon, CHECK CODE.","SELECT distinct cu.first_name,cu.last_name FROM 
customers cu
INNER JOIN credit_cards d ON cu.ssn = d.ssn
INNER JOIN credit_cards d2 ON d.ssn = d2.ssn
WHERE
d.type = 'visa'
and d2.type= 'jcb'
and cu.country = 'Singapore'","Missing semicolon, CHECK CODE.","SELECT t.ssn, count(*)
from customers c left join credit_cards t on c.ssn = t.ssn
group by t.ssn","Missing semicolon, CHECK CODE.","SELECT cr.ssn, cr.type, count(*) 
from credit_cards cr, customers c,transactions t
where c.ssn = cr.ssn
and t.number = cr.number
group by cr.ssn, cr.type 
ORDER BY cr.ssn DESC","Missing semicolon, CHECK CODE.","select q.country,count(distinct q.ssn)
from transactions t
inner join credit_cards cr on t.number = cr.number
inner join customers q on cr.ssn = q.ssn
inner join merchants me on me.code = t.code
where me.country != q.country
group by q.country 
order by count(*) desc","Missing semicolon, CHECK CODE.","SELECT cr.type, t.identifier, t.amount 
from transactions t
inner join credit_cards cr on t.number = cr.number
where t.amount = (
     select max(tr.amount)
     from transactions tr inner join credit_cards cr1
     on tr.number = cr1.number
     and cr.type = cr1.type)
group by t.identifier, cr.type, t.amount
ORDER BY t.identifier ASC","Missing semicolon, CHECK CODE.","select cr.type, t.identifier,t.amount
from transactions t
inner join credit_cards cr on t.number = cr.number
where t.amount >= all (
select t1.amount
from transactions t1 inner join 
	credit_cards cr1 on t1.number = cr1.number
where cr1.type = cr.type)","Missing semicolon, CHECK CODE.","SELECT distinct me.code, me.name
from merchants me 
where me.code not in 
(select distinct me.code 
 from transactions tr 
inner join merchants me on tr.code = me.code
inner join credit_cards cr on cr.number = tr.number
 where tr.amount >= 888
 and (cr.type like '%visa%' or cr.type like '%diners-club%') )","Missing semicolon, CHECK CODE."
A0232193L,"select distinct c.ssn
from customers c, transactions d, credit_cards e
where c.ssn = e.ssn
and e.number = d.number
and EXTRACT(DAY FROM d.datetime) = 25
and e.type= 'visa';",,"select a.first_name, a.last_name
from(select distinct c.first_name, c.last_name, c.ssn
from customers c, credit_cards d, credit_cards e
where c.ssn = d.ssn
and d.ssn = e.ssn
and c.country = 'Singapore'
and d.type = 'jcb'
and e.type = 'visa') a;",,"select c.ssn, count(distinct d.number) as num
from customers c
left join credit_cards d
on c.ssn = d.ssn
group by c.ssn","Missing semicolon, CHECK CODE.","select c.ssn, d.type, count(distinct d.number) as num_of_credit_cards
from
(select *, 1 as link 
from customers) as c
outer join
(select distinct type, 1 as link
from credit_cards) as d
on c.link = d.link
left join credit_cards e
on c.ssn = e.ssn
and d.type = e.type
group by c.ssn, d.type;",,"select c.country, count(distinct c.ssn)
from customers c
left join credit_cards d
on c.ssn = d.ssn
left join transactions e
on d.number = e.number
left join merchants f
on e.code = f.code
where c.country <> f.country
group by c.country;",,"select c.identifier, d.type
from transactions c, credit_cards d
where c.number = d.number
and c.amount >= (
    select max(e.amount)
    from transactions e, credit_cards f
    where e.number = f.number
    and f.type = d.type
    group by f.type
)","Missing semicolon, CHECK CODE.","SELECT d.type, c.identifier
FROM transactions c, credit_cards d
WHERE c.number = d.number
AND c.amount >= ALL(
    SELECT e.amount 
    FROM transactions e, credit_cards f 
    WHERE e.number = f.number AND f.type=d.type);",,"select c.code, c.name
from merchants c
left join transactions d
on c.code = d.code
left join credit_cards e
on d.number = e.number
where e.type like '%visa%' or e.type like '%diners-club%'
group by c.code, c.name
having max(d.amount) < 888;",
